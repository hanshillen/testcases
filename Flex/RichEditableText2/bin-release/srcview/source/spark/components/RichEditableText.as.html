<!-- saved from url=(0014)about:internet -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>RichEditableText.as</title>
<link rel="stylesheet" type="text/css" href="../../../SourceStyles.css"/>
</head>

<body><pre><span class="ActionScriptComment">////////////////////////////////////////////////////////////////////////////////
</span><span class="ActionScriptComment">//
</span><span class="ActionScriptComment">//  ADOBE SYSTEMS INCORPORATED
</span><span class="ActionScriptComment">//  Copyright 2008 Adobe Systems Incorporated
</span><span class="ActionScriptComment">//  All Rights Reserved.
</span><span class="ActionScriptComment">//
</span><span class="ActionScriptComment">//  NOTICE: Adobe permits you to use, modify, and distribute this file
</span><span class="ActionScriptComment">//  in accordance with the terms of the license agreement accompanying it.
</span><span class="ActionScriptComment">//
</span><span class="ActionScriptComment">////////////////////////////////////////////////////////////////////////////////
</span>
<span class="ActionScriptpackage">package</span> <span class="ActionScriptDefault_Text">spark</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">components</span>
<span class="ActionScriptBracket/Brace">{</span>
    
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">flash</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">display</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">DisplayObject</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">flash</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">display</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">DisplayObjectContainer</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">flash</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">events</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Event</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">flash</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">events</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">FocusEvent</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">flash</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">events</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">KeyboardEvent</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">flash</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">events</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">MouseEvent</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">flash</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">geom</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Rectangle</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">flash</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">system</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">IME</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">flash</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">system</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">IMEConversionMode</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">flash</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">text</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">engine</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">ElementFormat</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">flash</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">text</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">engine</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">FontDescription</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">flash</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">text</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">engine</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">FontLookup</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">flash</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">text</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">engine</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">TextBlock</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">flash</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">text</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">engine</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">TextElement</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">flash</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">text</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">engine</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">TextLine</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">flash</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">ui</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Keyboard</span>;
    
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">flashx</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">textLayout</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">compose</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">ISWFContext</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">flashx</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">textLayout</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">container</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">TextContainerManager</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">flashx</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">textLayout</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">conversion</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">ConversionType</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">flashx</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">textLayout</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">conversion</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">ITextExporter</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">flashx</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">textLayout</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">conversion</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">ITextImporter</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">flashx</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">textLayout</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">conversion</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">TextConverter</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">flashx</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">textLayout</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">edit</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">EditManager</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">flashx</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">textLayout</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">edit</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">EditingMode</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">flashx</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">textLayout</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">edit</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">IEditManager</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">flashx</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">textLayout</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">edit</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">ISelectionManager</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">flashx</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">textLayout</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">edit</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">SelectionState</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">flashx</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">textLayout</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">elements</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Configuration</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">flashx</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">textLayout</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">elements</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">GlobalSettings</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">flashx</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">textLayout</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">elements</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">InlineGraphicElement</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">flashx</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">textLayout</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">elements</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">InlineGraphicElementStatus</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">flashx</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">textLayout</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">elements</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">TextFlow</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">flashx</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">textLayout</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">events</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">CompositionCompleteEvent</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">flashx</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">textLayout</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">events</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">DamageEvent</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">flashx</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">textLayout</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">events</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">FlowOperationEvent</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">flashx</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">textLayout</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">events</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">SelectionEvent</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">flashx</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">textLayout</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">events</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">StatusChangeEvent</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">flashx</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">textLayout</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">factory</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">StringTextLineFactory</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">flashx</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">textLayout</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">factory</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">TextFlowTextLineFactory</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">flashx</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">textLayout</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">formats</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">BlockProgression</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">flashx</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">textLayout</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">formats</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Category</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">flashx</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">textLayout</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">formats</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">ITextLayoutFormat</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">flashx</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">textLayout</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">formats</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">TextLayoutFormat</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">flashx</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">textLayout</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">operations</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">CopyOperation</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">flashx</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">textLayout</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">operations</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">CutOperation</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">flashx</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">textLayout</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">operations</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">DeleteTextOperation</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">flashx</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">textLayout</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">operations</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">FlowOperation</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">flashx</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">textLayout</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">operations</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">FlowTextOperation</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">flashx</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">textLayout</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">operations</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">InsertTextOperation</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">flashx</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">textLayout</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">operations</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">PasteOperation</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">flashx</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">textLayout</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">tlf_internal</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">flashx</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">undo</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">IUndoManager</span>;
    
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">mx</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">core</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">IFlexModuleFactory</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">mx</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">core</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">IIMESupport</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">mx</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">core</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">ISystemCursorClient</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">mx</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">core</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">UIComponent</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">mx</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">core</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">mx_internal</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">mx</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">events</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">FlexEvent</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">mx</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">managers</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">IFocusManager</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">mx</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">managers</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">IFocusManagerComponent</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">mx</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">resources</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">ResourceManager</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">mx</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">utils</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">StringUtil</span>;
    
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">spark</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">components</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">supportClasses</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">RichEditableTextContainerManager</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">spark</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">core</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">CSSTextLayoutFormat</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">spark</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">core</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">IEditableText</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">spark</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">core</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">IViewport</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">spark</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">core</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">NavigationUnit</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">spark</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">events</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">TextOperationEvent</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">spark</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">utils</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">TextUtil</span>;
    
    <span class="ActionScriptReserved">use</span> <span class="ActionScriptReserved">namespace</span> <span class="ActionScriptDefault_Text">mx_internal</span>;
    <span class="ActionScriptReserved">use</span> <span class="ActionScriptReserved">namespace</span> <span class="ActionScriptDefault_Text">tlf_internal</span>;
    
    <span class="ActionScriptComment">//--------------------------------------
</span>    <span class="ActionScriptComment">//  Events
</span>    <span class="ActionScriptComment">//--------------------------------------
</span>    
    <span class="ActionScriptASDoc">/**
     *  Dispached after the &lt;code&gt;selectionAnchorPosition&lt;/code&gt; and/or
     *  &lt;code&gt;selectionActivePosition&lt;/code&gt; properties have changed
     *  for any reason.
     *
     *  @eventType mx.events.FlexEvent.SELECTION_CHANGE
     *  
     *  @langversion 3.0
     *  @playerversion Flash 10
     *  @playerversion AIR 1.5
     *  @productversion Flex 4
     */</span>
    <span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptMetadata">Event</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"selectionChange"</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">type</span><span class="ActionScriptOperator">=</span><span class="ActionScriptString">"mx.events.FlexEvent"</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">]</span>
    
    <span class="ActionScriptASDoc">/**
     *  Dispatched before a user editing operation occurs.
     *  You can alter the operation, or cancel the event
     *  to prevent the operation from being processed.
     *
     *  @eventType spark.events.TextOperationEvent.CHANGING
     *  
     *  @langversion 3.0
     *  @playerversion Flash 10
     *  @playerversion AIR 1.5
     *  @productversion Flex 4
     */</span>
    <span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptMetadata">Event</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"changing"</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">type</span><span class="ActionScriptOperator">=</span><span class="ActionScriptString">"spark.events.TextOperationEvent"</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">]</span>
    
    <span class="ActionScriptASDoc">/**
     *  Dispatched after a user editing operation is complete.
     *
     *  @eventType spark.events.TextOperationEvent.CHANGE
     *  
     *  @langversion 3.0
     *  @playerversion Flash 10
     *  @playerversion AIR 1.5
     *  @productversion Flex 4
     */</span>
    <span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptMetadata">Event</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"change"</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">type</span><span class="ActionScriptOperator">=</span><span class="ActionScriptString">"spark.events.TextOperationEvent"</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">]</span>
    
    <span class="ActionScriptASDoc">/**
     *  Dispatched when the user presses the Enter key,
     *  if the &lt;code&gt;multiline&lt;/code&gt; property is false.
     *
     *  @eventType mx.events.FlexEvent.ENTER
     *  
     *  @langversion 3.0
     *  @playerversion Flash 10
     *  @playerversion AIR 1.5
     *  @productversion Flex 4
     */</span>
    <span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptMetadata">Event</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"enter"</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">type</span><span class="ActionScriptOperator">=</span><span class="ActionScriptString">"mx.events.FlexEvent"</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">]</span>
    
    <span class="ActionScriptComment">//--------------------------------------
</span>    <span class="ActionScriptComment">//  Styles
</span>    <span class="ActionScriptComment">//--------------------------------------
</span>    
    <span class="ActionScriptReserved">include</span> <span class="ActionScriptString">"../styles/metadata/BasicInheritingTextStyles.as"</span>
    <span class="ActionScriptReserved">include</span> <span class="ActionScriptString">"../styles/metadata/BasicNonInheritingTextStyles.as"</span>
    <span class="ActionScriptReserved">include</span> <span class="ActionScriptString">"../styles/metadata/AdvancedInheritingTextStyles.as"</span>
    <span class="ActionScriptReserved">include</span> <span class="ActionScriptString">"../styles/metadata/AdvancedNonInheritingTextStyles.as"</span>
    <span class="ActionScriptReserved">include</span> <span class="ActionScriptString">"../styles/metadata/SelectionFormatTextStyles.as"</span>
    
    <span class="ActionScriptASDoc">/**
     *  The alpha level of the color defined by
     *  the &lt;code&gt;backgroundColor&lt;/code&gt; style.
     *  Valid values range from 0.0 to 1.0.
     * 
     *  @default 1.0
     *
     *  @langversion 3.0
     *  @playerversion Flash 10
     *  @playerversion AIR 1.5
     *  @productversion Flex 4
     */</span>
    <span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptMetadata">Style</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"backgroundAlpha"</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">type</span><span class="ActionScriptOperator">=</span><span class="ActionScriptString">"Number"</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">inherit</span><span class="ActionScriptOperator">=</span><span class="ActionScriptString">"no"</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">]</span>
    
    <span class="ActionScriptASDoc">/**
     *  The color of the background of the entire
     *  bounding rectangle of this component.
     *  If this style is &lt;code&gt;undefined&lt;/code&gt;,
     *  no background is drawn.
     *  Otherwise, this RGB color is drawn with an alpha level
     *  determined by the &lt;code&gt;backgroundAlpha&lt;/code&gt; style.
     * 
     *  @default undefined
     *
     *  @langversion 3.0
     *  @playerversion Flash 10
     *  @playerversion AIR 1.5
     *  @productversion Flex 4
     */</span>
    <span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptMetadata">Style</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"backgroundColor"</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">type</span><span class="ActionScriptOperator">=</span><span class="ActionScriptString">"uint"</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">format</span><span class="ActionScriptOperator">=</span><span class="ActionScriptString">"Color"</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">inherit</span><span class="ActionScriptOperator">=</span><span class="ActionScriptString">"no"</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">]</span>
    
    <span class="ActionScriptComment">//--------------------------------------
</span>    <span class="ActionScriptComment">//  Excluded APIs
</span>    <span class="ActionScriptComment">//--------------------------------------
</span>    
    <span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptMetadata">Exclude</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"chromeColor"</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">kind</span><span class="ActionScriptOperator">=</span><span class="ActionScriptString">"style"</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">]</span>
    
    <span class="ActionScriptComment">//--------------------------------------
</span>    <span class="ActionScriptComment">//  Other metadata
</span>    <span class="ActionScriptComment">//--------------------------------------
</span>    
    <span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptMetadata">AccessibilityClass</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"spark.accessibility.RichEditableTextAccImpl"</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">]</span>
    
    <span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptMetadata">DefaultProperty</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"content"</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">]</span>
    
    <span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptMetadata">IconFile</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"RichEditableText.png"</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">]</span>
    
    <span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptMetadata">DefaultTriggerEvent</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"change"</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">]</span>
    
    <span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptMetadata">DiscouragedForProfile</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"mobileDevice"</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">]</span>
    
    <span class="ActionScriptASDoc">/**
     *  RichEditableText is a low-level UIComponent for displaying,
     *  scrolling, selecting, and editing richly-formatted text.
     *
     *  &lt;p&gt;The rich text can contain clickable hyperlinks and inline graphics
     *  that are either embedded or loaded from URLs.&lt;/p&gt;
     *
     *  &lt;p&gt;RichEditableText does not have scrollbars, but it implements
     *  the IViewport interface for programmatic scrolling so that it
     *  can be controlled by a Scroller, which does provide scrollbars.
     *  It also supports vertical scrolling with the mouse wheel.&lt;/p&gt;
     *
     *  &lt;p&gt;It does not include any user interface for changing
     *  the formatting of the text.
     *  But it offers APIs which can do this programmatically;
     *  these make it possible, for example, for you to create 
     *  a Bold button that makes the selected text bold.&lt;/p&gt;
     *
     *  &lt;p&gt;This class is used in the skins of the Spark versions
     *  of TextInput and TextArea.
     *  (TextInput does not expose its ability to handle rich text,
     *  but TextArea does.)
     *  By default, RichEditableText has a transparent background,
     *  and it does not support drawing a border.&lt;/p&gt;
     *
     *  &lt;p&gt;RichEditableText uses the Text Layout Framework (TLF) library,
     *  which in turn builds on the new Flash Text Engine (FTE)
     *  in Flash Player 10. In combination, these layers provide text editing with
     *  high-quality international typography and layout.&lt;/p&gt;
     *
     *  &lt;p&gt;The Spark architecture provides three text "primitives" -- 
     *  Label, RichText, and RichEditableText.
     *  Label is the fastest and most lightweight
     *  because it uses only FTE, not TLF,
     *  but it is limited in its capabilities: no rich text,
     *  no scrolling, no selection, and no editing.
     *  RichText adds the ability to display rich text
     *  with complex layout, but is still completely non-interactive.
     *  RichEditableText is the heaviest-weight,
     *  but offers most of what TLF can do.
     *  In general, use the fastest text primitive that meets your needs.&lt;/p&gt;
     *
     *  &lt;p&gt;RichEditableText is similar to the UITextField class
     *  used in MX components. This class did not use FTE or TLF
     *  but rather extended the older TextField class.&lt;/p&gt;
     *
     *  &lt;p&gt;The most important differences between UITextField and RichEditableText are:
     *  &lt;ul&gt;
     *    &lt;li&gt;RichEditableText offers better typography, better support
     *        for international languages, and better text layout.&lt;/li&gt;
     *    &lt;li&gt;RichEditableText has an object-oriented model of rich text,
     *        while UITextField does not.&lt;/li&gt;
     *    &lt;li&gt;RichEditableText has better support for displaying
     *        large amounts of text.&lt;/li&gt;
     *    &lt;li&gt;RichEditableText requires that fonts be embedded
     *        differently than UITextField.
     *        Consult the documentation regarding how to use the
     *        &lt;code&gt;embedAsCFF&lt;/code&gt; attribute when you embed a font.&lt;/li&gt;
     *  &lt;/ul&gt;&lt;/p&gt;
     *
     *  &lt;p&gt;RichEditableText uses TLF's object-oriented model of rich text,
     *  in which text layout elements such as divisions, paragraphs, spans,
     *  hyperlinks, and images are represented at runtime by ActionScript
     *  objects which can be programmatically accessed and manipulated.
     *  The central object in TLF for representing rich text is a
     *  TextFlow, so you specify rich text for a RichEditableText control to display
     *  by setting its &lt;code&gt;textFlow&lt;/code&gt; property to a TextFlow instance.
     *  See the description of the &lt;code&gt;textFlow&lt;/code&gt;
     *  property for information about how to create one,
     *  such as by importing TLF markup.
     *  If you don't need to display text that has multiple formats,
     *  you can use the &lt;code&gt;text&lt;/code&gt; property to set a "plain text" String.
     *  See the description of the &lt;code&gt;text&lt;/code&gt; and &lt;code&gt;textFlow&lt;/code&gt;
     *  properties for information about how they interact;
     *  for example, you can set one and get the other.&lt;/p&gt;
     *
     *  &lt;p&gt;At compile time, you can put TLF markup tags inside
     *  the RichEditableText tag, as the following example shows:
     *  &lt;pre&gt;
     *  &amp;lt;s:RichEditableText&amp;gt;Hello &amp;lt;s:span fontWeight="bold"&amp;gt;World!&amp;lt;/s:span&amp;gt;&amp;lt;/s:RichEditableText&amp;gt;
     *  &lt;/pre&gt;
     *  In this case, the MXML compiler sets the &lt;code&gt;content&lt;/code&gt;
     *  property, causing a TextFlow to be automatically created
     *  from the FlowElements that you specify.&lt;/p&gt;
     *
     *  &lt;p&gt;The default text formatting is determined by CSS styles
     *  such as &lt;code&gt;fontFamily&lt;/code&gt;, &lt;code&gt;fontSize&lt;/code&gt;.
     *  Any formatting information in the TextFlow overrides
     *  the default formatting provided by the CSS styles.&lt;/p&gt;
     *
     *  &lt;p&gt;You can control the spacing between lines with the
     *  &lt;code&gt;lineHeight&lt;/code&gt; style and the spacing between
     *  paragraphs with the &lt;code&gt;paragraphSpaceBefore&lt;/code&gt;
     *  and &lt;code&gt;paragraphSpaceAfter&lt;/code&gt; styles.
     *  You can align or justify the text using the &lt;code&gt;textAlign&lt;/code&gt;
     *  and &lt;code&gt;textAlignLast&lt;/code&gt; styles.
     *  You can inset the text from the component's edges using the
     *  &lt;code&gt;paddingLeft&lt;/code&gt;, &lt;code&gt;paddingTop&lt;/code&gt;, 
     *  &lt;code&gt;paddingRight&lt;/code&gt;, and &lt;code&gt;paddingBottom&lt;/code&gt; styles.&lt;/p&gt;
     *
     *  &lt;p&gt;By default, a RichEditableText "autosizes": it starts out very
     *  small if it has no text, and grows in width up to
     *  &lt;code&gt;maxWidth&lt;/code&gt; as you type. It grows in height when you 
     *  press the Enter key to start a new line.&lt;/p&gt;
     *
     *  &lt;p&gt;The &lt;code&gt;widthInChars&lt;/code&gt; and &lt;code&gt;heightInLines&lt;/code&gt;
     *  properties provide a convenient way to specify the width and height
     *  in a way that scales with the font size.
     *  You can use the &lt;code&gt;typicalText&lt;/code&gt; property as well.
     *  Note that if you use &lt;code&gt;typicalText&lt;/code&gt;, the
     *  &lt;code&gt;widthInChars&lt;/code&gt; and &lt;code&gt;heightInLines&lt;/code&gt;
     *  are ignored.
     *  You can also specify an explicit width or height in pixels,
     *  or use a percent width and height, or use constraints such as
     *  &lt;code&gt;left&lt;/code&gt; and &lt;code&gt;right&lt;/code&gt;
     *  or &lt;code&gt;top&lt;/code&gt; and &lt;code&gt;bottom&lt;/code&gt;.&lt;/p&gt;
     *
     *  &lt;p&gt;When you specify some kind of width -- whether an explicit or
     *  percent width, a &lt;code&gt;maxWidth&lt;/code&gt; or &lt;code&gt;left&lt;/code&gt;
     *  and &lt;code&gt;right&lt;/code&gt; constraints -- the text wraps at the right
     *  edge of the component and the text becomes vertically scrollable
     *  when there is more text than fits.
     *  If you set the &lt;code&gt;lineBreak&lt;/code&gt; style to &lt;code&gt;explicit&lt;/code&gt;,
     *  new lines will start only at explicit lines breaks, such as
     *  if you use CR (&lt;code&gt;\r&lt;/code&gt;), LF (&lt;code&gt;\n&lt;/code&gt;),
     *  or CR+LF (&lt;code&gt;\r\n&lt;/code&gt;) in &lt;code&gt;text&lt;/code&gt;
     *  or if you use &lt;code&gt;&amp;lt;p&amp;gt;&lt;/code&gt; and &lt;code&gt;&amp;lt;br/&amp;gt;&lt;/code&gt;
     *  in TLF markup.
     *  In that case, the text becomes horizontally scrollable
     *  if any lines are wider than the control.&lt;/p&gt;
     *
     *  &lt;p&gt;You can use the &lt;code&gt;maxChars&lt;/code&gt; property to limit the number
     *  of character that the user can enter, and the &lt;code&gt;restrict&lt;/code&gt;
     *  to limit which characters the user can enter.&lt;/p&gt;
     *
     *  &lt;p&gt;The &lt;code&gt;multiline&lt;/code&gt; property determines what happens
     *  when you press the Enter key.
     *  If it is &lt;code&gt;true&lt;/code&gt;, the Enter key starts a new paragraph.
     *  If it is &lt;code&gt;false&lt;/code&gt;, it causes a &lt;code&gt;FlexEvent.ENTER&lt;/code&gt;
     *  event to be dispatched.&lt;/p&gt;
     *
     *  &lt;p&gt;If you don't want the text to be editable,
     *  set the &lt;code&gt;editable&lt;/code&gt; property to &lt;code&gt;false&lt;/code&gt;.
     *  If you don't even want the text to be selectable,
     *  set the &lt;code&gt;selectable&lt;/code&gt; property to &lt;code&gt;false&lt;/code&gt;.&lt;/p&gt;
     *
     *  &lt;p&gt;Because RichEditableText uses TLF,
     *  it supports displaying left-to-right (LTR) text such as French,
     *  right-to-left (RTL) text such as Arabic, and bidirectional text
     *  such as a French phrase inside of an Arabic one.
     *  If the predominant text direction is right-to-left,
     *  set the &lt;code&gt;direction&lt;/code&gt; style to &lt;code&gt;rtl&lt;/code&gt;.
     *  The &lt;code&gt;textAlign&lt;/code&gt; style defaults to &lt;code&gt;"start"&lt;/code&gt;,
     *  which makes the text left-aligned when &lt;code&gt;direction&lt;/code&gt;
     *  is &lt;code&gt;ltr&lt;/code&gt; and right-aligned when &lt;code&gt;direction&lt;/code&gt;
     *  is &lt;code&gt;rtl&lt;/code&gt;.
     *  To get the opposite alignment, set &lt;code&gt;textAlign&lt;/code&gt; to &lt;code&gt;end&lt;/code&gt;.&lt;/p&gt;
     *
     *  &lt;p&gt;As a result of using TLF, the RichEditableText supports
     *  unlimited undo/redo within one editing session.
     *  An editing session starts when the component gets keyboard focus
     *  and ends when it loses focus.&lt;/p&gt;
     *
     *  &lt;p&gt;RichEditableText uses TLF's TextContainerManager class
     *  to handle its text display, scrolling, selection, editing and context menu.&lt;/p&gt;
     *
     *  &lt;p&gt;To use this component in a list-based component, such as a List or DataGrid, 
     *  create an item renderer.
     *  For information about creating an item renderer, see 
     *  &lt;a href="http://help.adobe.com/en_US/flex/using/WS4bebcd66a74275c3-fc6548e124e49b51c4-8000.html"&gt;
     *  Custom Spark item renderers&lt;/a&gt;. &lt;/p&gt;
     *
     *  @mxml
     *
     *  &lt;p&gt;The &lt;code&gt;&amp;lt;s:RichEditableText&amp;gt;&lt;/code&gt; tag inherits all of the tag 
     *  attributes of its superclass and adds the following tag attributes:&lt;/p&gt;
     *
     *  &lt;pre&gt;
     *  &amp;lt;s:RichEditableText
     *    &lt;strong&gt;Properties&lt;/strong&gt;
     *    clipAndEnableScrolling="false|true"
     *    contentHeight="&lt;i&gt;Calculated default&lt;/i&gt;"
     *    contentWidth="&lt;i&gt;Calculated default&lt;/i&gt;"
     *    displayAsPassword="false"
     *    editable="true"
     *    heightInLines="NaN"
     *    horizontalScrollPosition="0"
     *    imeMode="null"
     *    maxChars="0"
     *    multiline="true"
     *    restrict="null"
     *    selectable="true"
     *    selectionActivePosition="-1"
     *    selectionAnchorPosition="-1"
     *    selectionHighlighting="TextSelectionHighlighting.WHEN_FOCUSED"
     *    text=""
     *    textFlow="&lt;i&gt;TextFlow&lt;/i&gt;"
     *    typicalText=null
     *    verticalScrollPosition="0"
     *    widthInChars="NaN"
     *  
     *    &lt;strong&gt;Events&lt;/strong&gt;
     *    change="&lt;i&gt;No default&lt;/i&gt;"
     *    changing="&lt;i&gt;No default&lt;/i&gt;"
     *    enter="&lt;i&gt;No default&lt;/i&gt;"
     *    selectionChange="&lt;i&gt;No default&lt;/i&gt;"
     *  /&amp;gt;
     *  &lt;/pre&gt;
     *  
     *  @includeExample examples/RichEditableTextExample.mxml
     *  @includeExample examples/externalTextFlow.xml -noswf
     *  
     *  @langversion 3.0
     *  @playerversion Flash 10
     *  @playerversion AIR 1.5
     *  @productversion Flex 4
     *
     *  @see spark.components.Label
     *  @see spark.components.RichText
     *  @see spark.utils.TextFlowUtil
     *  @see flashx.textLayout.container.TextContainerManager
     */</span>
    <span class="ActionScriptReserved">public</span> <span class="ActionScriptclass">class</span> <span class="ActionScriptDefault_Text">RichEditableText</span> <span class="ActionScriptReserved">extends</span> <span class="ActionScriptDefault_Text">UIComponent</span>
        <span class="ActionScriptReserved">implements</span> <span class="ActionScriptDefault_Text">IFocusManagerComponent</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">IIMESupport</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">ISystemCursorClient</span><span class="ActionScriptOperator">,</span> 
                   <span class="ActionScriptDefault_Text">IViewport</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">IEditableText</span>
    <span class="ActionScriptBracket/Brace">{</span>
        <span class="ActionScriptReserved">include</span> <span class="ActionScriptString">"../core/Version.as"</span>;
        
        <span class="ActionScriptComment">//--------------------------------------------------------------------------
</span>        <span class="ActionScriptComment">//
</span>        <span class="ActionScriptComment">//  Class mixins
</span>        <span class="ActionScriptComment">//
</span>        <span class="ActionScriptComment">//--------------------------------------------------------------------------
</span>        
        <span class="ActionScriptASDoc">/**
         *  @private
         *  Placeholder for mixin by RichEditableTextAccImpl.
         */</span>
        <span class="ActionScriptDefault_Text">mx_internal</span> <span class="ActionScriptReserved">static</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">createAccessibilityImplementation</span>:<span class="ActionScriptDefault_Text">Function</span>;
        
        <span class="ActionScriptComment">//--------------------------------------------------------------------------
</span>        <span class="ActionScriptComment">//
</span>        <span class="ActionScriptComment">//  Class initialization
</span>        <span class="ActionScriptComment">//
</span>        <span class="ActionScriptComment">//--------------------------------------------------------------------------
</span>        
        <span class="ActionScriptASDoc">/**
         *  @private
         *  This method initializes the static vars of this class.
         *  Rather than calling it at static initialization time,
         *  we call it in the constructor to do the class initialization
         *  when the first instance is created.
         *  (It does an immediate return if it has already run.)
         *  By doing so, we avoid any static initialization issues
         *  related to whether this class or the TLF classes
         *  that it uses are initialized first.
         */</span>
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptReserved">static</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">initClass</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">classInitialized</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptReserved">return</span>;
            
            <span class="ActionScriptComment">// Set the TLF hook used for localizing runtime error messages.
</span>            <span class="ActionScriptComment">// TLF itself has English-only messages,
</span>            <span class="ActionScriptComment">// but higher layers like Flex can provide localized versions.
</span>            <span class="ActionScriptDefault_Text">GlobalSettings</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">resourceStringFunction</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">TextUtil</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">getResourceString</span>;
            
            <span class="ActionScriptComment">// Set the TLF hook used to specify the callback used for changing 
</span>            <span class="ActionScriptComment">// the FontLookup based on SWFContext.  
</span>            <span class="ActionScriptDefault_Text">GlobalSettings</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">resolveFontLookupFunction</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">TextUtil</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">resolveFontLookup</span>;
            
            <span class="ActionScriptComment">// Pre-FP10.1, set default tab stops in TLF.  Without this, if there
</span>            <span class="ActionScriptComment">// is a tab and TLF is measuring width, the tab will
</span>            <span class="ActionScriptComment">// measure as the rest of the remaining width up to 10000.
</span>            <span class="ActionScriptDefault_Text">GlobalSettings</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">enableDefaultTabStops</span> <span class="ActionScriptOperator">=</span> 
                <span class="ActionScriptOperator">!</span><span class="ActionScriptDefault_Text">Configuration</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">playerEnablesArgoFeatures</span>;
            
            <span class="ActionScriptDefault_Text">staticPlainTextImporter</span> <span class="ActionScriptOperator">=</span>
                <span class="ActionScriptDefault_Text">TextConverter</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">getImporter</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">TextConverter</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">PLAIN_TEXT_FORMAT</span><span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptComment">// Throw import errors rather than return a null textFlow.
</span>            <span class="ActionScriptComment">// Alternatively, the error strings are in the Vector, importer.errors.
</span>            <span class="ActionScriptDefault_Text">staticPlainTextImporter</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">throwOnError</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">true</span>;
            
            <span class="ActionScriptDefault_Text">staticPlainTextExporter</span> <span class="ActionScriptOperator">=</span>
                <span class="ActionScriptDefault_Text">TextConverter</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">getExporter</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">TextConverter</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">PLAIN_TEXT_FORMAT</span><span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptDefault_Text">classInitialized</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">true</span>;
        <span class="ActionScriptBracket/Brace">}</span> 
        
        <span class="ActionScriptComment">//--------------------------------------------------------------------------
</span>        <span class="ActionScriptComment">//
</span>        <span class="ActionScriptComment">//  Class variables
</span>        <span class="ActionScriptComment">//
</span>        <span class="ActionScriptComment">//--------------------------------------------------------------------------
</span>        
        <span class="ActionScriptASDoc">/**
         *  @private
         */</span>
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptReserved">static</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">classInitialized</span>:<span class="ActionScriptDefault_Text">Boolean</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">false</span>;
                
        <span class="ActionScriptASDoc">/**
         *  @private
         *  This TLF object composes TextLines from a text String.
         *  We use it when the 'typicalText' property is set to a String
         *  that doesn't contain linebreaks.
         */</span>
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptReserved">static</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">staticStringFactory</span>:<span class="ActionScriptDefault_Text">StringTextLineFactory</span>;
        
        <span class="ActionScriptASDoc">/**
         *  @private
         *  This TLF object composes TextLines from a TextFlow.
         *  We use it when the 'typicalText is set to a String
         *  that contains linebreaks (and therefore is interpreted
         *  as multiple paragraphs).
         */</span>
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptReserved">static</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">staticTextFlowFactory</span>:<span class="ActionScriptDefault_Text">TextFlowTextLineFactory</span>;
        
        <span class="ActionScriptASDoc">/**
         *  @private
         *  This TLF object is used to import a 'text' String
         *  containing linebreaks to create a multiparagraph TextFlow.
         */</span>
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptReserved">static</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">staticPlainTextImporter</span>:<span class="ActionScriptDefault_Text">ITextImporter</span>;
        
        <span class="ActionScriptASDoc">/**
         *  @private
         *  This TLF object is used to export a TextFlow as plain 'text',
         *  by walking the leaf FlowElements in the TextFlow.
         */</span>
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptReserved">static</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">staticPlainTextExporter</span>:<span class="ActionScriptDefault_Text">ITextExporter</span>;
        
        <span class="ActionScriptASDoc">/**
         *  @private
         *  Regular expression which matches all newlines in the text.  Used
         *  to strip newlines when pasting text when multiline is false.
         */</span>
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptReserved">static</span> <span class="ActionScriptReserved">const</span> <span class="ActionScriptDefault_Text">ALL_NEWLINES_REGEXP</span>:<span class="ActionScriptDefault_Text">RegExp</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptString">/\n/g</span>;
        
        <span class="ActionScriptComment">//--------------------------------------------------------------------------
</span>        <span class="ActionScriptComment">//
</span>        <span class="ActionScriptComment">//  Class methods
</span>        <span class="ActionScriptComment">//
</span>        <span class="ActionScriptComment">//--------------------------------------------------------------------------
</span>        <span class="ActionScriptASDoc">/**
         *  @private
         */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptReserved">static</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">getNumberOrPercentOf</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">value</span>:<span class="ActionScriptDefault_Text">Object</span><span class="ActionScriptOperator">,</span>
                                                    <span class="ActionScriptDefault_Text">n</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">Number</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptComment">// If 'value' is a Number like 10.5, return it.
</span>            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">value</span> <span class="ActionScriptReserved">is</span> <span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">value</span><span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptComment">// If 'value' is a percentage String like "10.5%",
</span>            <span class="ActionScriptComment">// return that percentage of 'n'.
</span>            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">value</span> <span class="ActionScriptReserved">is</span> <span class="ActionScriptDefault_Text">String</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">len</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">String</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">value</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">length</span>;
                <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">len</span> <span class="ActionScriptOperator">&gt;=</span> 1 <span class="ActionScriptOperator">&amp;&amp;</span> <span class="ActionScriptDefault_Text">value</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">charAt</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">len</span> <span class="ActionScriptOperator">-</span> 1<span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptString">"%"</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">percent</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">value</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">substring</span><span class="ActionScriptBracket/Brace">(</span>0<span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">len</span> <span class="ActionScriptOperator">-</span> 1<span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">percent</span> <span class="ActionScriptOperator">/</span> 100 <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">n</span>;
                <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptBracket/Brace">}</span>
            
            <span class="ActionScriptComment">// Otherwise, return NaN.
</span>            <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">NaN</span>;
        <span class="ActionScriptBracket/Brace">}</span>        
        
        <span class="ActionScriptASDoc">/**
         *  @private
         */</span>
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptReserved">static</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">splice</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">str</span>:<span class="ActionScriptDefault_Text">String</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">start</span>:<span class="ActionScriptDefault_Text">int</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">end</span>:<span class="ActionScriptDefault_Text">int</span><span class="ActionScriptOperator">,</span>
                                       <span class="ActionScriptDefault_Text">strToInsert</span>:<span class="ActionScriptDefault_Text">String</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">String</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">str</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">substring</span><span class="ActionScriptBracket/Brace">(</span>0<span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">start</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">+</span>
                <span class="ActionScriptDefault_Text">strToInsert</span> <span class="ActionScriptOperator">+</span>
                <span class="ActionScriptDefault_Text">str</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">substring</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">end</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">str</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">length</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptComment">//--------------------------------------------------------------------------
</span>        <span class="ActionScriptComment">//
</span>        <span class="ActionScriptComment">//  Constructor
</span>        <span class="ActionScriptComment">//
</span>        <span class="ActionScriptComment">//--------------------------------------------------------------------------
</span>        
        <span class="ActionScriptASDoc">/**
         *  Constructor. 
         *  
         *  @langversion 3.0
         *  @playerversion Flash 10
         *  @playerversion AIR 1.5
         *  @productversion Flex 4
         */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">RichEditableText</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">super</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptDefault_Text">initClass</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptComment">// Use the setter.
</span>            <span class="ActionScriptDefault_Text">text</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptString">""</span>;
            
            <span class="ActionScriptComment">// Create the TLF TextContainerManager, using this component
</span>            <span class="ActionScriptComment">// as the DisplayObjectContainer for its TextLines.
</span>            <span class="ActionScriptComment">// This TextContainerManager instance persists for the lifetime
</span>            <span class="ActionScriptComment">// of the component.
</span>            <span class="ActionScriptDefault_Text">_textContainerManager</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">createTextContainerManager</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptComment">// Add event listeners on this component.
</span>            <span class="ActionScriptDefault_Text">addEventListener</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">Event</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">REMOVED_FROM_STAGE</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">removedFromStageHandler</span><span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptComment">// The focusInHandler is called by the TCMContainer focusInHandler.
</span>            <span class="ActionScriptComment">// The focusOutHandler is called by the TCMContainer focusOutHandler.
</span>            <span class="ActionScriptComment">// The keyDownHandler is called by the TCMContainer keyDownHandler.
</span>            
            <span class="ActionScriptComment">// Add event listeners on its TextContainerManager.
</span>            
            <span class="ActionScriptDefault_Text">_textContainerManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">addEventListener</span><span class="ActionScriptBracket/Brace">(</span>
                <span class="ActionScriptDefault_Text">CompositionCompleteEvent</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">COMPOSITION_COMPLETE</span><span class="ActionScriptOperator">,</span>
                <span class="ActionScriptDefault_Text">textContainerManager_compositionCompleteHandler</span><span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptDefault_Text">_textContainerManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">addEventListener</span><span class="ActionScriptBracket/Brace">(</span>
                <span class="ActionScriptDefault_Text">DamageEvent</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">DAMAGE</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">textContainerManager_damageHandler</span><span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptDefault_Text">_textContainerManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">addEventListener</span><span class="ActionScriptBracket/Brace">(</span>
                <span class="ActionScriptDefault_Text">Event</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">SCROLL</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">textContainerManager_scrollHandler</span><span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptDefault_Text">_textContainerManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">addEventListener</span><span class="ActionScriptBracket/Brace">(</span>
                <span class="ActionScriptDefault_Text">SelectionEvent</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">SELECTION_CHANGE</span><span class="ActionScriptOperator">,</span>
                <span class="ActionScriptDefault_Text">textContainerManager_selectionChangeHandler</span><span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptDefault_Text">_textContainerManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">addEventListener</span><span class="ActionScriptBracket/Brace">(</span>
                <span class="ActionScriptDefault_Text">FlowOperationEvent</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">FLOW_OPERATION_BEGIN</span><span class="ActionScriptOperator">,</span>
                <span class="ActionScriptDefault_Text">textContainerManager_flowOperationBeginHandler</span><span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptDefault_Text">_textContainerManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">addEventListener</span><span class="ActionScriptBracket/Brace">(</span>
                <span class="ActionScriptDefault_Text">FlowOperationEvent</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">FLOW_OPERATION_END</span><span class="ActionScriptOperator">,</span>
                <span class="ActionScriptDefault_Text">textContainerManager_flowOperationEndHandler</span><span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptDefault_Text">_textContainerManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">addEventListener</span><span class="ActionScriptBracket/Brace">(</span>
                <span class="ActionScriptDefault_Text">FlowOperationEvent</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">FLOW_OPERATION_COMPLETE</span><span class="ActionScriptOperator">,</span>
                <span class="ActionScriptDefault_Text">textContainerManager_flowOperationCompleteHandler</span><span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptDefault_Text">_textContainerManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">addEventListener</span><span class="ActionScriptBracket/Brace">(</span>
                <span class="ActionScriptDefault_Text">StatusChangeEvent</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">INLINE_GRAPHIC_STATUS_CHANGE</span><span class="ActionScriptOperator">,</span> 
                <span class="ActionScriptDefault_Text">textContainerManager_inlineGraphicStatusChangeHandler</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptComment">//--------------------------------------------------------------------------
</span>        <span class="ActionScriptComment">//
</span>        <span class="ActionScriptComment">//  Variables
</span>        <span class="ActionScriptComment">//
</span>        <span class="ActionScriptComment">//--------------------------------------------------------------------------
</span>        
        <span class="ActionScriptASDoc">/**
         *  @private
         *  The composition bounds used when creating the TextLines.
         */</span>
        <span class="ActionScriptDefault_Text">mx_internal</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">unbounded</span>:<span class="ActionScriptDefault_Text">Rectangle</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Rectangle</span><span class="ActionScriptBracket/Brace">(</span>0<span class="ActionScriptOperator">,</span> 0<span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">NaN</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">NaN</span><span class="ActionScriptBracket/Brace">)</span>;
        
        <span class="ActionScriptASDoc">/**
         *  @private
         *  The hostFormat object in the _textContainerManager determines the 
         *  default text formatting used by this component, based on its CSS styles. 
         *  This flag is used by updateStylesIfChanged() determine when the object 
         *  must be reinitialized.  It is set in stylesInitialized() and 
         *  styleChanged(), and cleared in commitProperties().  After 
         *  initialization, the hostFormat object should never be null.
         */</span>
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">hostFormatChanged</span>:<span class="ActionScriptDefault_Text">Boolean</span>;
        
        <span class="ActionScriptASDoc">/**
         *  @private
         *  It is set to NaN by stylesInitialized() and styleChanged(),
         *  and recreated whenever necessary in calculateFontMetrics().
         */</span>
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">ascent</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">NaN</span>;
        
        <span class="ActionScriptASDoc">/**
         *  @private
         *  It is set to NaN by stylesInitialized() and styleChanged(),
         *  and recreated whenever necessary in calculateFontMetrics().
         */</span>
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">descent</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">NaN</span>;
        
        <span class="ActionScriptASDoc">/**
         *  @private
         *  Source of text: one of "text", "textFlow" or "content".
         */</span>
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">source</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptString">"text"</span>;
        
        <span class="ActionScriptASDoc">/**
         *  @private
         *  Holds the last recorded value of the textFlow generation.  Used to
         *  determine whether to return immediately from damage event if there 
         *  have been no changes.
         */</span>
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">lastGeneration</span>:<span class="ActionScriptDefault_Text">uint</span> <span class="ActionScriptOperator">=</span> 0;    <span class="ActionScriptComment">// 0 means not set
</span>        
        <span class="ActionScriptASDoc">/**
         *  @private
         *  The generation of the text flow that last reported its content
         *  bounds. 
         */</span>
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">lastContentBoundsGeneration</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> 0;  <span class="ActionScriptComment">// 0 means not set
</span>        
        <span class="ActionScriptASDoc">/**
         *  @private
         *  True if TextOperationEvent.CHANGING and TextOperationEvent.CHANGE 
         *  events should be dispatched.
         */</span>
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">dispatchChangeAndChangingEvents</span>:<span class="ActionScriptDefault_Text">Boolean</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">true</span>;
        
        <span class="ActionScriptASDoc">/**
         *  @private
         */</span>
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">inMeasureMethod</span>:<span class="ActionScriptDefault_Text">Boolean</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">false</span>;
        
        <span class="ActionScriptASDoc">/**
         *  @private
         */</span>
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">inUpdateDLMethod</span>:<span class="ActionScriptDefault_Text">Boolean</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">false</span>;
        
        <span class="ActionScriptASDoc">/**
         *  @private
         */</span>
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">remeasuringText</span>:<span class="ActionScriptDefault_Text">Boolean</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">false</span>;

        <span class="ActionScriptASDoc">/**
         *  @private
         */</span>
        <span class="ActionScriptDefault_Text">mx_internal</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">passwordChar</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptString">"*"</span>;
        
        <span class="ActionScriptASDoc">/**
         *  @private
         */</span>
        <span class="ActionScriptDefault_Text">mx_internal</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">undoManager</span>:<span class="ActionScriptDefault_Text">IUndoManager</span>;
        
        <span class="ActionScriptASDoc">/**
         *  @private
         */</span>
        <span class="ActionScriptDefault_Text">mx_internal</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">clearUndoOnFocusOut</span>:<span class="ActionScriptDefault_Text">Boolean</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">true</span>;
        
        <span class="ActionScriptASDoc">/**
         *  @private
         *  Holds the last recorded value of the module factory used to create the 
         *  font.
         */</span>
        <span class="ActionScriptDefault_Text">mx_internal</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">embeddedFontContext</span>:<span class="ActionScriptDefault_Text">IFlexModuleFactory</span>;
        
        <span class="ActionScriptASDoc">/**
         *  @private
         *  The TLF edit manager will batch all inserted text until the next
         *  enter frame event.  This includes text inserted via the GUI as well
         *  as api calls to EditManager.insertText().  Set this to false if you
         *  want every keystroke to be inserted into the text immediately which will
         *  result in a TextOperationEvent.CHANGE event for each character.  One
         *  place this is needed is for the type-ahead feature of the editable combo
         *  box.
         */</span>
        <span class="ActionScriptDefault_Text">mx_internal</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">batchTextInput</span>:<span class="ActionScriptDefault_Text">Boolean</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">true</span>;
        
        <span class="ActionScriptASDoc">/**
         *  @private
         *  True if we've seen a MOUSE_DOWN event and haven't seen the 
         *  corresponding MOUSE_UP event.
         */</span>
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">mouseDown</span>:<span class="ActionScriptDefault_Text">Boolean</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">false</span>;
        
        <span class="ActionScriptASDoc">/**
         *  @private
         *  Hold the previous editingMode while using a specific instance manager
         *  so that the editingMode can be restored when the instance manager is
         *  released.
         */</span>
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">priorEditingMode</span>:<span class="ActionScriptDefault_Text">String</span>;
        
        <span class="ActionScriptASDoc">/**
         *  @private
         *  Cache the width constraint as set by the layout in setLayoutBoundsSize()
         *  so that text reflow can be calculated during a subsequent measure pass.
         */</span>
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">widthConstraint</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">NaN</span>;
        
        <span class="ActionScriptASDoc">/**
         *  @private
         *  Cache the height constraint as set by the layout in setLayoutBoundsSize()
         *  so that text reflow can be calculated during a subsequent measure pass.
         */</span>
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">heightConstraint</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">NaN</span>;
        
        <span class="ActionScriptASDoc">/**
         *  @private
         *  If the selection was via the selectRange() or selectAll() api, remember
         *  that until the next selection is set, either interactively or via the
         *  API.
         */</span>
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">hasProgrammaticSelectionRange</span>:<span class="ActionScriptDefault_Text">Boolean</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">false</span>;
        
        <span class="ActionScriptASDoc">/**
         *  @private
         *  True if this component sizes itself based on its actual
         *  contents.
         */</span>
        <span class="ActionScriptDefault_Text">mx_internal</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">autoSize</span>:<span class="ActionScriptDefault_Text">Boolean</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">false</span>;
        
        <span class="ActionScriptASDoc">/**
         *  @private
         */</span>
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">lastMeasuredWidth</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">NaN</span>;
        
        <span class="ActionScriptASDoc">/**
         *  @private
         */</span>
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">lastMeasuredHeight</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">NaN</span>;
        
        <span class="ActionScriptASDoc">/**
         *  @private
         */</span>
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">lastUnscaledWidth</span>:<span class="ActionScriptDefault_Text">Number</span>;
        <span class="ActionScriptASDoc">/**
         *  @private
         */</span>
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">lastUnscaledHeight</span>:<span class="ActionScriptDefault_Text">Number</span>;
        
        <span class="ActionScriptComment">//--------------------------------------------------------------------------
</span>        <span class="ActionScriptComment">//
</span>        <span class="ActionScriptComment">//  Overridden properties: UIComponent
</span>        <span class="ActionScriptComment">//
</span>        <span class="ActionScriptComment">//--------------------------------------------------------------------------
</span>        
        <span class="ActionScriptComment">//----------------------------------
</span>        <span class="ActionScriptComment">//  baselinePosition
</span>        <span class="ActionScriptComment">//----------------------------------
</span>        
        <span class="ActionScriptASDoc">/**
         *  @private
         */</span>
        <span class="ActionScriptReserved">override</span> <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptReserved">get</span> <span class="ActionScriptDefault_Text">baselinePosition</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">Number</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">getStyle</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"paddingTop"</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">ascent</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptComment">//----------------------------------
</span>        <span class="ActionScriptComment">//  enabled
</span>        <span class="ActionScriptComment">//----------------------------------
</span>        
        <span class="ActionScriptASDoc">/**
         *  @private
         */</span>
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">enabledChanged</span>:<span class="ActionScriptDefault_Text">Boolean</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">false</span>;
        
        <span class="ActionScriptASDoc">/**
         *  @private
         */</span>
        <span class="ActionScriptReserved">override</span> <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptReserved">set</span> <span class="ActionScriptDefault_Text">enabled</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">value</span>:<span class="ActionScriptDefault_Text">Boolean</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">value</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptReserved">super</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">enabled</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptReserved">return</span>;
            
            <span class="ActionScriptReserved">super</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">enabled</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">value</span>;
            <span class="ActionScriptDefault_Text">enabledChanged</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">true</span>;
            
            <span class="ActionScriptDefault_Text">invalidateProperties</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">invalidateDisplayList</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptComment">//----------------------------------
</span>        <span class="ActionScriptComment">// explicitHeight
</span>        <span class="ActionScriptComment">//----------------------------------
</span>        
        <span class="ActionScriptASDoc">/**
         *  @private
         */</span>
        <span class="ActionScriptReserved">override</span> <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptReserved">set</span> <span class="ActionScriptDefault_Text">explicitHeight</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">value</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">super</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">explicitHeight</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">value</span>;
            
            <span class="ActionScriptDefault_Text">heightConstraint</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">NaN</span>;
            
            <span class="ActionScriptComment">// Because of autoSizing, the size and display might be impacted.
</span>            <span class="ActionScriptDefault_Text">invalidateSize</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">invalidateDisplayList</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptComment">//----------------------------------
</span>        <span class="ActionScriptComment">// explicitWidth
</span>        <span class="ActionScriptComment">//----------------------------------
</span>        
        <span class="ActionScriptASDoc">/**
         *  @private
         */</span>
        <span class="ActionScriptReserved">override</span> <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptReserved">set</span> <span class="ActionScriptDefault_Text">explicitWidth</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">value</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">super</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">explicitWidth</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">value</span>;
            
            <span class="ActionScriptDefault_Text">widthConstraint</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">NaN</span>;
            
            <span class="ActionScriptComment">// Because of autoSizing, the size and display might be impacted.
</span>            <span class="ActionScriptDefault_Text">invalidateSize</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">invalidateDisplayList</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptComment">//----------------------------------
</span>        <span class="ActionScriptComment">// isTruncated
</span>        <span class="ActionScriptComment">//----------------------------------
</span>        
        <span class="ActionScriptASDoc">/**
         *  @private
         */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptReserved">get</span> <span class="ActionScriptDefault_Text">isTruncated</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">Boolean</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptComment">// This class does not support truncation
</span>            <span class="ActionScriptReserved">return</span> <span class="ActionScriptReserved">false</span>;
        <span class="ActionScriptBracket/Brace">}</span>
               
        <span class="ActionScriptComment">//----------------------------------
</span>        <span class="ActionScriptComment">// percentHeight
</span>        <span class="ActionScriptComment">//----------------------------------
</span>        
        <span class="ActionScriptASDoc">/**
         *  @private
         */</span>
        <span class="ActionScriptReserved">override</span> <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptReserved">set</span> <span class="ActionScriptDefault_Text">percentHeight</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">value</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">super</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">percentHeight</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">value</span>;
            
            <span class="ActionScriptDefault_Text">heightConstraint</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">NaN</span>;
            
            <span class="ActionScriptComment">// If we were autoSizing and now we are not we need to remeasure.
</span>            <span class="ActionScriptDefault_Text">invalidateSize</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">invalidateDisplayList</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptComment">//----------------------------------
</span>        <span class="ActionScriptComment">// percentWidth
</span>        <span class="ActionScriptComment">//----------------------------------
</span>        
        <span class="ActionScriptASDoc">/**
         *  @private
         */</span>
        <span class="ActionScriptReserved">override</span> <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptReserved">set</span> <span class="ActionScriptDefault_Text">percentWidth</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">value</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">super</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">percentWidth</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">value</span>;
            
            <span class="ActionScriptDefault_Text">widthConstraint</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">NaN</span>;
            
            <span class="ActionScriptComment">// If we were autoSizing and now we are not we need to remeasure.
</span>            <span class="ActionScriptDefault_Text">invalidateSize</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">invalidateDisplayList</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptComment">//--------------------------------------------------------------------------
</span>        <span class="ActionScriptComment">//
</span>        <span class="ActionScriptComment">//  Properties: ISystemCursorClient
</span>        <span class="ActionScriptComment">//
</span>        <span class="ActionScriptComment">//--------------------------------------------------------------------------
</span>        
        <span class="ActionScriptASDoc">/**
         *  True if the system cursor should always be shown when the mouse 
         *  moves over the component.  If false, the custom cursor will be shown.
         *  
         *  @langversion 3.0
         *  @playerversion Flash 10
         *  @playerversion AIR 1.5
         *  @productversion Flex 4
         */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptReserved">get</span> <span class="ActionScriptDefault_Text">showSystemCursor</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">Boolean</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">editable</span>;        
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptComment">//--------------------------------------------------------------------------
</span>        <span class="ActionScriptComment">//
</span>        <span class="ActionScriptComment">//  Properties: IViewport
</span>        <span class="ActionScriptComment">//
</span>        <span class="ActionScriptComment">//--------------------------------------------------------------------------
</span>        
        <span class="ActionScriptComment">//----------------------------------
</span>        <span class="ActionScriptComment">//  clipAndEnableScrolling
</span>        <span class="ActionScriptComment">//----------------------------------
</span>        
        <span class="ActionScriptASDoc">/**
         *  @private
         */</span>
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">_clipAndEnableScrolling</span>:<span class="ActionScriptDefault_Text">Boolean</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">false</span>;
        
        <span class="ActionScriptASDoc">/**
         *  @private
         */</span>
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">clipAndEnableScrollingChanged</span>:<span class="ActionScriptDefault_Text">Boolean</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">false</span>;
        
        <span class="ActionScriptASDoc">/**
         *  @copy spark.core.IViewport#clipAndEnableScrolling
         *
         *  @default false
         *  
         *  @langversion 3.0
         *  @playerversion Flash 10
         *  @playerversion AIR 1.5
         *  @productversion Flex 4
         */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptReserved">get</span> <span class="ActionScriptDefault_Text">clipAndEnableScrolling</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">Boolean</span> 
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">_clipAndEnableScrolling</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptASDoc">/**
         *  @private
         *  Set to true by a scroller when it installs this as a viewport.
         *  Set to false by a scroller when it uninstalls this as a viewport.
         */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptReserved">set</span> <span class="ActionScriptDefault_Text">clipAndEnableScrolling</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">value</span>:<span class="ActionScriptDefault_Text">Boolean</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span> 
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">value</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptDefault_Text">_clipAndEnableScrolling</span><span class="ActionScriptBracket/Brace">)</span> 
                <span class="ActionScriptReserved">return</span>;
            
            <span class="ActionScriptDefault_Text">_clipAndEnableScrolling</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">value</span>;
            <span class="ActionScriptDefault_Text">clipAndEnableScrollingChanged</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">true</span>;
            
            <span class="ActionScriptDefault_Text">invalidateProperties</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptComment">//----------------------------------
</span>        <span class="ActionScriptComment">//  contentHeight
</span>        <span class="ActionScriptComment">//----------------------------------
</span>        
        <span class="ActionScriptASDoc">/**
         *  @private
         */</span>
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">_contentHeight</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> 0;
        
        <span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptMetadata">Bindable</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"propertyChange"</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">]</span>
        
        <span class="ActionScriptASDoc">/**
         *  The height of the text.
         *
         *  &lt;p&gt;Due to the fact that the Text Layout Framework
         *  virtualizes TextLines for performance,
         *  this height will initially be an estimate
         *  if the component cannot display all of the text.
         *  If you scroll to the end of the text,
         *  all the TextLines will get composed
         *  and the &lt;code&gt;contentHeight&lt;/code&gt; will be exact.&lt;/p&gt;
         *
         *  &lt;p&gt;To scroll over the text vertically, vary the 
         *  &lt;code&gt;verticalScrollPosition&lt;/code&gt; between 0 and
         *  &lt;code&gt;contentHeight - height&lt;/code&gt;.&lt;/p&gt;
         *  
         *  @langversion 3.0
         *  @playerversion Flash 10
         *  @playerversion AIR 1.5
         *  @productversion Flex 4
         */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptReserved">get</span> <span class="ActionScriptDefault_Text">contentHeight</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">Number</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">_contentHeight</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptComment">//----------------------------------
</span>        <span class="ActionScriptComment">//  contentWidth
</span>        <span class="ActionScriptComment">//----------------------------------
</span>        
        <span class="ActionScriptASDoc">/**
         *  @private
         */</span>
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">_contentWidth</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> 0;
        
        <span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptMetadata">Bindable</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"propertyChange"</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">]</span>
        
        <span class="ActionScriptASDoc">/**
         *  The width of the text.
         *
         *  &lt;p&gt;Due to the fact that the Text Layout Framework
         *  virtualizes TextLines for performance,
         *  this width will initially be an estimate
         *  if the component cannot display all of the text.
         *  If you scroll to the end of the text,
         *  all the TextLines will get composed
         *  and the &lt;code&gt;contentWidth&lt;/code&gt; will be exact.&lt;/p&gt;
         *
         *  &lt;p&gt;To scroll over the text horizontally, vary the 
         *  &lt;code&gt;horizontalScrollPosition&lt;/code&gt; between 0 and
         *  &lt;code&gt;contentWidth - width&lt;/code&gt;.&lt;/p&gt;  
         *  
         *  @langversion 3.0
         *  @playerversion Flash 10
         *  @playerversion AIR 1.5
         *  @productversion Flex 4
         */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptReserved">get</span> <span class="ActionScriptDefault_Text">contentWidth</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">Number</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">_contentWidth</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptComment">//----------------------------------
</span>        <span class="ActionScriptComment">//  horizontalScrollPosition
</span>        <span class="ActionScriptComment">//----------------------------------
</span>
        <span class="ActionScriptASDoc">/**
         *  @private
         */</span>
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">_horizontalScrollPosition</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> 0;
        
        <span class="ActionScriptASDoc">/**
         *  @private
         */</span>
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">horizontalScrollPositionChanged</span>:<span class="ActionScriptDefault_Text">Boolean</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">false</span>;
        
        <span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptMetadata">Bindable</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"propertyChange"</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">]</span>
        <span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptMetadata">Inspectable</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"0"</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">minValue</span><span class="ActionScriptOperator">=</span><span class="ActionScriptString">"0.0"</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">]</span>
                
        <span class="ActionScriptASDoc">/**
         *  The number of pixels by which the text is scrolled horizontally.
         *
         *  &lt;p&gt;To scroll over the text horizontally, vary the 
         *  &lt;code&gt;horizontalScrollPosition&lt;/code&gt; between 0 and
         *  &lt;code&gt;contentWidth - width&lt;/code&gt;.&lt;/p&gt;
         *
         *  @default 0
         *  
         *  @langversion 3.0
         *  @playerversion Flash 10
         *  @playerversion AIR 1.5
         *  @productversion Flex 4
         */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptReserved">get</span> <span class="ActionScriptDefault_Text">horizontalScrollPosition</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">Number</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">_horizontalScrollPosition</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptASDoc">/**
         *  @private
         */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptReserved">set</span> <span class="ActionScriptDefault_Text">horizontalScrollPosition</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">value</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptComment">// Convert NaN to 0 to keep TCM happy.
</span>            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">isNaN</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">value</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptDefault_Text">value</span> <span class="ActionScriptOperator">=</span> 0;
            
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">value</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptDefault_Text">_horizontalScrollPosition</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptReserved">return</span>;
            
            <span class="ActionScriptDefault_Text">_horizontalScrollPosition</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">value</span>;
            <span class="ActionScriptDefault_Text">horizontalScrollPositionChanged</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">true</span>;
            
            <span class="ActionScriptDefault_Text">invalidateProperties</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptComment">// Note:  TLF takes care of updating the container when the scroll
</span>            <span class="ActionScriptComment">// position is set so there is no need for us to invalidate the 
</span>            <span class="ActionScriptComment">// display list.
</span>        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptComment">//----------------------------------
</span>        <span class="ActionScriptComment">//  verticalScrollPosition
</span>        <span class="ActionScriptComment">//----------------------------------
</span>        
        <span class="ActionScriptASDoc">/**
         *  @private
         */</span>
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">_verticalScrollPosition</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> 0;
        
        <span class="ActionScriptASDoc">/**
         *  @private
         */</span>
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">verticalScrollPositionChanged</span>:<span class="ActionScriptDefault_Text">Boolean</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">false</span>;
        
        <span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptMetadata">Bindable</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"propertyChange"</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">]</span>
        <span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptMetadata">Inspectable</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"0"</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">minValue</span><span class="ActionScriptOperator">=</span><span class="ActionScriptString">"0.0"</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">]</span>
                
        <span class="ActionScriptASDoc">/**
         *  The number of pixels by which the text is scrolled vertically.
         *
         *  &lt;p&gt;To scroll over the text vertically, vary the 
         *  &lt;code&gt;verticalScrollPosition&lt;/code&gt; between 0 and
         *  &lt;code&gt;contentHeight - height&lt;/code&gt;.&lt;/p&gt;
         *
         *  @default 0
         *  
         *  @langversion 3.0
         *  @playerversion Flash 10
         *  @playerversion AIR 1.5
         *  @productversion Flex 4
         */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptReserved">get</span> <span class="ActionScriptDefault_Text">verticalScrollPosition</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">Number</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">_verticalScrollPosition</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptASDoc">/**
         *  @private
         */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptReserved">set</span> <span class="ActionScriptDefault_Text">verticalScrollPosition</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">value</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptComment">// Convert NaN to 0 to keep TCM happy.
</span>            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">isNaN</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">value</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptDefault_Text">value</span> <span class="ActionScriptOperator">=</span> 0;
            
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">value</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptDefault_Text">_verticalScrollPosition</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptReserved">return</span>;
            
            <span class="ActionScriptDefault_Text">_verticalScrollPosition</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">value</span>;
            <span class="ActionScriptDefault_Text">verticalScrollPositionChanged</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">true</span>;
            
            <span class="ActionScriptDefault_Text">invalidateProperties</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptComment">// Note:  TLF takes care of updating the container when the scroll
</span>            <span class="ActionScriptComment">// position is set so there is no need for us to invalidate the 
</span>            <span class="ActionScriptComment">// display list.
</span>        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptComment">//--------------------------------------------------------------------------
</span>        <span class="ActionScriptComment">//
</span>        <span class="ActionScriptComment">//  Properties
</span>        <span class="ActionScriptComment">//
</span>        <span class="ActionScriptComment">//--------------------------------------------------------------------------
</span>        
        <span class="ActionScriptComment">//----------------------------------
</span>        <span class="ActionScriptComment">//  content
</span>        <span class="ActionScriptComment">//----------------------------------
</span>        
        <span class="ActionScriptASDoc">/**
         *  @private
         */</span>
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">_content</span>:<span class="ActionScriptDefault_Text">Object</span>;
        
        <span class="ActionScriptASDoc">/**
         *  @private
         */</span>
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">contentChanged</span>:<span class="ActionScriptDefault_Text">Boolean</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">false</span>;
        
        <span class="ActionScriptASDoc">/**
         *  @private
         *  This metadata tells the MXML compiler to disable some of its default
         *  interpretation of the value specified for the 'content' property.
         *  Normally, for properties of type Object, it assumes that things
         *  looking like numbers are numbers and things looking like arrays
         *  are arrays. But &lt;content&gt;1&lt;/content&gt; should generate code to set the
         *  content to  the String "1", not the int 1, and &lt;content&gt;[1]&lt;/content&gt;
         *  should set it to the String "[1]", not the Array [ 1 ].
         *  However, {...} continues to be interpreted as a databinding
         *  expression, and @Resource(...), @Embed(...), etc.
         *  as compiler directives.
         *  Similar metadata on TLF classes causes the same rules to apply
         *  within &lt;p&gt;, &lt;span&gt;, etc.
         */</span>
        <span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptMetadata">RichTextContent</span><span class="ActionScriptBracket/Brace">]</span>
                
        <span class="ActionScriptASDoc">/**
         *  This property is intended for use in MXML at compile time;
         *  to get or set rich text content at runtime,
         *  please use the &lt;code&gt;textFlow&lt;/code&gt; property instead.
         *
         *  &lt;p&gt;The &lt;code&gt;content&lt;/code&gt; property is the default property
         *  for RichEditableText, so that you can write MXML such as
         *  &lt;pre&gt;
         *  &amp;lt;s:RichEditableText&amp;gt;Hello &amp;lt;s:span fontWeight="bold"/&amp;gt;World&amp;lt;/s:span&amp;gt;&amp;lt;/s:RichEditableText&amp;gt;
         *  &lt;/pre&gt;
         *  and have the String and SpanElement that you specify
         *  as the content be used to create a TextFlow.&lt;/p&gt;
         *
         *  &lt;p&gt;This property is typed as Object because you can set it to
         *  to a String, a FlowElement, or an Array of Strings and FlowElements.
         *  In the example above, you are specifying the content
         *  to be a 2-element Array whose first element is the String
         *  "Hello" and whose second element is a SpanElement with the text
         *  "World" in boldface.&lt;/p&gt;
         * 
         *  &lt;p&gt;No matter how you specify the content, it gets converted
         *  into a TextFlow, and when you get this property, you will get
         *  the resulting TextFlow.&lt;/p&gt;
         * 
         *  &lt;p&gt;Adobe recommends using &lt;code&gt;textFlow&lt;/code&gt; property
         *  to get and set rich text content at runtime,
         *  because it is strongly typed as a TextFlow
         *  rather than as an Object.
         *  A TextFlow is the canonical representation
         *  for rich text content in the Text Layout Framework.&lt;/p&gt;
         * 
         *  @langversion 3.0
         *  @playerversion Flash 10
         *  @playerversion AIR 1.5
         *  @productversion Flex 4
         */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptReserved">get</span> <span class="ActionScriptDefault_Text">content</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">Object</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">textFlow</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptASDoc">/**
         *  @private
         */</span>   
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptReserved">set</span> <span class="ActionScriptDefault_Text">content</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">value</span>:<span class="ActionScriptDefault_Text">Object</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptComment">// Treat setting the 'content' to null
</span>            <span class="ActionScriptComment">// as if 'text' were being set to the empty String
</span>            <span class="ActionScriptComment">// (which is the default state).
</span>            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">value</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptReserved">null</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">text</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptString">""</span>;
                <span class="ActionScriptReserved">return</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">value</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptDefault_Text">_content</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptReserved">return</span>;
            
            <span class="ActionScriptDefault_Text">_content</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">value</span>;
            <span class="ActionScriptDefault_Text">contentChanged</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">true</span>;
            <span class="ActionScriptDefault_Text">source</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptString">"content"</span>;
            
            <span class="ActionScriptComment">// Of 'text', 'textFlow', and 'content', the last one set wins.
</span>            <span class="ActionScriptDefault_Text">textChanged</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">false</span>;
            <span class="ActionScriptDefault_Text">textFlowChanged</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">false</span>;
            
            <span class="ActionScriptComment">// The other two are now invalid and must be recalculated when needed.
</span>            <span class="ActionScriptDefault_Text">_text</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">null</span>;
            <span class="ActionScriptDefault_Text">_textFlow</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">null</span>;
            
            <span class="ActionScriptDefault_Text">invalidateProperties</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">invalidateSize</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">invalidateDisplayList</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptDefault_Text">dispatchEvent</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">FlexEvent</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">FlexEvent</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">VALUE_COMMIT</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>;                                   
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptComment">//----------------------------------
</span>        <span class="ActionScriptComment">//  displayAsPassword
</span>        <span class="ActionScriptComment">//----------------------------------
</span>        
        <span class="ActionScriptASDoc">/**
         *  @private
         */</span>
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">_displayAsPassword</span>:<span class="ActionScriptDefault_Text">Boolean</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">false</span>;
        
        <span class="ActionScriptASDoc">/**
         *  @private
         */</span>
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">displayAsPasswordChanged</span>:<span class="ActionScriptDefault_Text">Boolean</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">false</span>;
        
        <span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptMetadata">Inspectable</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"General"</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">defaultValue</span><span class="ActionScriptOperator">=</span><span class="ActionScriptString">"false"</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">]</span>
        
        <span class="ActionScriptASDoc">/**
         *  @copy flash.text.TextField#displayAsPassword
         *
         *  @langversion 3.0
         *  @playerversion Flash 10
         *  @playerversion AIR 1.5
         *  @productversion Flex 4
         */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptReserved">get</span> <span class="ActionScriptDefault_Text">displayAsPassword</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">Boolean</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">_displayAsPassword</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptASDoc">/**
         *  @private
         */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptReserved">set</span> <span class="ActionScriptDefault_Text">displayAsPassword</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">value</span>:<span class="ActionScriptDefault_Text">Boolean</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">value</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptDefault_Text">_displayAsPassword</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptReserved">return</span>;
            
            <span class="ActionScriptDefault_Text">_displayAsPassword</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">value</span>;
            <span class="ActionScriptDefault_Text">displayAsPasswordChanged</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">true</span>;
            
            <span class="ActionScriptDefault_Text">invalidateProperties</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">invalidateSize</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">invalidateDisplayList</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptComment">//----------------------------------
</span>        <span class="ActionScriptComment">//  editable
</span>        <span class="ActionScriptComment">//----------------------------------
</span>        
        <span class="ActionScriptASDoc">/**
         *  @private
         */</span>
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">_editable</span>:<span class="ActionScriptDefault_Text">Boolean</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">true</span>;
        
        <span class="ActionScriptASDoc">/**
         *  @private
         */</span>
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">editableChanged</span>:<span class="ActionScriptDefault_Text">Boolean</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">false</span>;
        
        <span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptMetadata">Inspectable</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"General"</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">defaultValue</span><span class="ActionScriptOperator">=</span><span class="ActionScriptString">"true"</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">]</span>
        
        <span class="ActionScriptASDoc">/**
         *  A flag indicating whether the user is allowed
         *  to edit the text in this control.
         *
         *  &lt;p&gt;If &lt;code&gt;true&lt;/code&gt;, the mouse cursor will change to an i-beam
         *  when over the bounds of this control.
         *  If &lt;code&gt;false&lt;/code&gt;, the mouse cursor will remain an arrow.&lt;/p&gt;
         *
         *  &lt;p&gt;If this property is &lt;code&gt;true&lt;/code&gt;,
         *  the &lt;code&gt;selectable&lt;/code&gt; property is ignored.&lt;/p&gt;
         *
         *  @default true
         *
         *  @see spark.components.RichEditableText#selectable
         *  
         *  @langversion 3.0
         *  @playerversion Flash 10
         *  @playerversion AIR 1.5
         *  @productversion Flex 4
         */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptReserved">get</span> <span class="ActionScriptDefault_Text">editable</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">Boolean</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">_editable</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptASDoc">/**
         *  @private
         */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptReserved">set</span> <span class="ActionScriptDefault_Text">editable</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">value</span>:<span class="ActionScriptDefault_Text">Boolean</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">value</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptDefault_Text">_editable</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptReserved">return</span>;
            
            <span class="ActionScriptDefault_Text">_editable</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">value</span>;
            <span class="ActionScriptDefault_Text">editableChanged</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">true</span>;
            
            <span class="ActionScriptDefault_Text">invalidateProperties</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">invalidateDisplayList</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptComment">//----------------------------------
</span>        <span class="ActionScriptComment">//  editingMode
</span>        <span class="ActionScriptComment">//----------------------------------
</span>        
        <span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptMetadata">Inspectable</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"General"</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">defaultValue</span><span class="ActionScriptOperator">=</span><span class="ActionScriptString">"readWrite"</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">enumeration</span><span class="ActionScriptOperator">=</span><span class="ActionScriptString">"readOnly,readWrite,readSelect"</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">]</span>

        <span class="ActionScriptASDoc">/**
         *  @private
         *  The editingMode of this component's TextContainerManager.
         *  Note that this is not a public property
         *  and does not use the invalidation mechanism.
         */</span>
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptReserved">get</span> <span class="ActionScriptDefault_Text">editingMode</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">String</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptComment">// Note: this could be called before all properties are committed.
</span>            
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">enabledChanged</span> <span class="ActionScriptOperator">||</span> <span class="ActionScriptDefault_Text">editableChanged</span> <span class="ActionScriptOperator">||</span> <span class="ActionScriptDefault_Text">selectableChanged</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">updateEditingMode</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
                
                <span class="ActionScriptDefault_Text">enabledChanged</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">false</span>;
                <span class="ActionScriptDefault_Text">editableChanged</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">false</span>;
                <span class="ActionScriptDefault_Text">selectableChanged</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">false</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            
            <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">_textContainerManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">editingMode</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptASDoc">/**
         *  @private
         */</span>
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptReserved">set</span> <span class="ActionScriptDefault_Text">editingMode</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">value</span>:<span class="ActionScriptDefault_Text">String</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">lastEditingMode</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">_textContainerManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">editingMode</span>;
            
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">lastEditingMode</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptDefault_Text">value</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptReserved">return</span>;
            
            <span class="ActionScriptDefault_Text">_textContainerManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">editingMode</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">value</span>;
            
            <span class="ActionScriptComment">// Make sure the selection manager selection is in sync with the
</span>            <span class="ActionScriptComment">// current selection.
</span>            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">value</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptDefault_Text">EditingMode</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">READ_ONLY</span> <span class="ActionScriptOperator">&amp;&amp;</span> 
                <span class="ActionScriptDefault_Text">_selectionAnchorPosition</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptOperator">-</span>1 <span class="ActionScriptOperator">&amp;&amp;</span> <span class="ActionScriptDefault_Text">_selectionActivePosition</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptOperator">-</span>1<span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">selectionManager</span>:<span class="ActionScriptDefault_Text">ISelectionManager</span> <span class="ActionScriptOperator">=</span> 
                    <span class="ActionScriptDefault_Text">_textContainerManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">beginInteraction</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
                
                <span class="ActionScriptDefault_Text">selectionManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">selectRange</span><span class="ActionScriptBracket/Brace">(</span>
                    <span class="ActionScriptDefault_Text">_selectionAnchorPosition</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">_selectionActivePosition</span><span class="ActionScriptBracket/Brace">)</span>;
                
                <span class="ActionScriptDefault_Text">_textContainerManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">endInteraction</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptComment">//----------------------------------
</span>        <span class="ActionScriptComment">//  enableIME
</span>        <span class="ActionScriptComment">//----------------------------------
</span>        
        <span class="ActionScriptASDoc">/**
         *  A flag that indicates whether the IME should
         *  be enabled when the component receives focus.
         *
         *  @langversion 3.0
         *  @playerversion Flash 10
         *  @playerversion AIR 1.5
         *  @productversion Flex 4
         */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptReserved">get</span> <span class="ActionScriptDefault_Text">enableIME</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">Boolean</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">editable</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptComment">//----------------------------------
</span>        <span class="ActionScriptComment">//  heightInLines
</span>        <span class="ActionScriptComment">//----------------------------------
</span>        
        <span class="ActionScriptASDoc">/**
         *  @private
         */</span>
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">_heightInLines</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">NaN</span>;
        
        <span class="ActionScriptASDoc">/**
         *  @private
         */</span>
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">heightInLinesChanged</span>:<span class="ActionScriptDefault_Text">Boolean</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">false</span>;
        
        <span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptMetadata">Inspectable</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"General"</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">minValue</span><span class="ActionScriptOperator">=</span><span class="ActionScriptString">"0.0"</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">]</span>
        
        <span class="ActionScriptASDoc">/**
         *  The default height of the control, measured in lines.
         *
         *  &lt;p&gt;The control's formatting styles, such as &lt;code&gt;fontSize&lt;/code&gt;
         *  and &lt;code&gt;lineHeight&lt;/code&gt;, are used to calculate the line height
         *  in pixels.&lt;/p&gt;
         *
         *  &lt;p&gt;You would, for example, set this property to 5 if you want
         *  the height of the RichEditableText to be sufficient
         *  to display five lines of text.&lt;/p&gt;
         *
         *  &lt;p&gt;If this property is &lt;code&gt;NaN&lt;/code&gt; (the default),
         *  then the component's default height will be determined
         *  from the text to be displayed.&lt;/p&gt;
         *  
         *  &lt;p&gt;This property will be ignored if you specify an explicit height,
         *  a percent height, or both &lt;code&gt;top&lt;/code&gt; and &lt;code&gt;bottom&lt;/code&gt;
         *  constraints.&lt;/p&gt;
         *
         *  &lt;p&gt;This property will also be ignored if the &lt;code&gt;typicalText&lt;/code&gt; 
         *  property is specified.&lt;/p&gt;
         * 
         *  &lt;p&gt;RichEditableText's &lt;code&gt;measure()&lt;/code&gt; method uses
         *  &lt;code&gt;widthInChars&lt;/code&gt; and &lt;code&gt;heightInLines&lt;/code&gt;
         *  to determine the &lt;code&gt;measuredWidth&lt;/code&gt;
         *  and &lt;code&gt;measuredHeight&lt;/code&gt;.
         *  These are similar to the &lt;code&gt;cols&lt;/code&gt; and &lt;code&gt;rows&lt;/code&gt;
         *  of an HTML TextArea.&lt;/p&gt;
         *
         *  &lt;p&gt;Since both &lt;code&gt;widthInChars&lt;/code&gt; and &lt;code&gt;heightInLines&lt;/code&gt;
         *  default to &lt;code&gt;NaN&lt;/code&gt;, RichTextEditable "autosizes" by default:
         *  it starts out very small if it has no text, grows in width as you
         *  type, and grows in height when you press Enter to start a new line.&lt;/p&gt;
         *
         *  @default NaN
         *
         *  @see spark.components.RichEditableText#widthInChars
         *  
         *  @langversion 3.0
         *  @playerversion Flash 10
         *  @playerversion AIR 1.5
         *  @productversion Flex 4
         */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptReserved">get</span> <span class="ActionScriptDefault_Text">heightInLines</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">Number</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">_heightInLines</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptASDoc">/**
         *  @private
         */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptReserved">set</span> <span class="ActionScriptDefault_Text">heightInLines</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">value</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">value</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptDefault_Text">_heightInLines</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptReserved">return</span>;
            
            <span class="ActionScriptDefault_Text">_heightInLines</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">value</span>;
            <span class="ActionScriptDefault_Text">heightInLinesChanged</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">true</span>;
            
            <span class="ActionScriptDefault_Text">heightConstraint</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">NaN</span>;
            
            <span class="ActionScriptDefault_Text">invalidateProperties</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">invalidateSize</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">invalidateDisplayList</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptComment">//----------------------------------
</span>        <span class="ActionScriptComment">//  imeMode
</span>        <span class="ActionScriptComment">//----------------------------------
</span>        
        <span class="ActionScriptASDoc">/**
         *  @private
         */</span>
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">_imeMode</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">null</span>;
        
        <span class="ActionScriptASDoc">/**
         *  Specifies the IME (input method editor) mode.
         *  The IME enables users to enter text in Chinese, Japanese, and Korean.
         *  Flex sets the specified IME mode when the control gets the focus,
         *  and sets it back to the previous value when the control loses the focus.
         *
         *  &lt;p&gt;The flash.system.IMEConversionMode class defines constants for the
         *  valid values for this property.
         *  You can also specify &lt;code&gt;null&lt;/code&gt; to specify no IME.&lt;/p&gt;
         *
         *  @default null
         * 
         *  @see flash.system.IMEConversionMode
         *  
         *  @langversion 3.0
         *  @playerversion Flash 10
         *  @playerversion AIR 1.5
         *  @productversion Flex 4
         */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptReserved">get</span> <span class="ActionScriptDefault_Text">imeMode</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">String</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">_imeMode</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptASDoc">/**
         *  @private
         */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptReserved">set</span> <span class="ActionScriptDefault_Text">imeMode</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">value</span>:<span class="ActionScriptDefault_Text">String</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">_imeMode</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">value</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptComment">//----------------------------------
</span>        <span class="ActionScriptComment">//  lineBreak
</span>        <span class="ActionScriptComment">//----------------------------------
</span>        
        <span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptMetadata">Inspectable</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"none"</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">]</span>

        <span class="ActionScriptASDoc">/**
         *  @private
         * 
         *  This property is only defined to implement the IEditableText
         *  interface. The lineBreak style should be used instead of this
         *  property.
         */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptReserved">get</span> <span class="ActionScriptDefault_Text">lineBreak</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">String</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">getStyle</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"lineBreak"</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptASDoc">/**
         *  @private
         */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptReserved">set</span> <span class="ActionScriptDefault_Text">lineBreak</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">value</span>:<span class="ActionScriptDefault_Text">String</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">setStyle</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"lineBreak"</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">value</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptComment">//----------------------------------
</span>        <span class="ActionScriptComment">//  maxChars
</span>        <span class="ActionScriptComment">//----------------------------------
</span>        
        <span class="ActionScriptASDoc">/**
         *  @private
         */</span>
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">_maxChars</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> 0;
        
        <span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptMetadata">Inspectable</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"General"</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">defaultValue</span><span class="ActionScriptOperator">=</span><span class="ActionScriptString">"0"</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">]</span>
        
        <span class="ActionScriptASDoc">/**
         *  @copy flash.text.TextField#maxChars
         * 
         *  @default 0
         *  
         *  @langversion 3.0
         *  @playerversion Flash 10
         *  @playerversion AIR 1.5
         *  @productversion Flex 4
         */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptReserved">get</span> <span class="ActionScriptDefault_Text">maxChars</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">int</span> 
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">_maxChars</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptASDoc">/**
         *  @private
         */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptReserved">set</span> <span class="ActionScriptDefault_Text">maxChars</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">value</span>:<span class="ActionScriptDefault_Text">int</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">_maxChars</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">value</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptComment">//----------------------------------
</span>        <span class="ActionScriptComment">//  multiline
</span>        <span class="ActionScriptComment">//----------------------------------
</span>        
        <span class="ActionScriptASDoc">/**
         *  @private
         */</span>
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">_multiline</span>:<span class="ActionScriptDefault_Text">Boolean</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">true</span>;
        
        <span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptMetadata">Inspectable</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"General"</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">defaultValue</span><span class="ActionScriptOperator">=</span><span class="ActionScriptString">"true"</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">]</span>
        
        <span class="ActionScriptASDoc">/**
         *  Determines whether the user can enter multiline text.
         *
         *  &lt;p&gt;If &lt;code&gt;true&lt;/code&gt;, the Enter key starts a new paragraph.
         *  If &lt;code&gt;false&lt;/code&gt;, the Enter key doesn't affect the text
         *  but causes the RichEditableText to dispatch an &lt;code&gt;"enter"&lt;/code&gt; 
         *  event.  If you paste text into the RichEditableText with a multiline 
         *  value of &lt;code&gt;false&lt;/code&gt;, newlines are stripped out of the text. &lt;/p&gt;  
         * 
         *  @default true
         *  
         *  @langversion 3.0
         *  @playerversion Flash 10
         *  @playerversion AIR 1.5
         *  @productversion Flex 4
         */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptReserved">get</span> <span class="ActionScriptDefault_Text">multiline</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">Boolean</span> 
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">_multiline</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptASDoc">/**
         *  @private
         */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptReserved">set</span> <span class="ActionScriptDefault_Text">multiline</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">value</span>:<span class="ActionScriptDefault_Text">Boolean</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">_multiline</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">value</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptComment">//----------------------------------
</span>        <span class="ActionScriptComment">//  restrict
</span>        <span class="ActionScriptComment">//----------------------------------
</span>        
        <span class="ActionScriptASDoc">/**
         *  @private
         */</span>
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">_restrict</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">null</span>;
        
        <span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptMetadata">Inspectable</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"General"</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">defaultValue</span><span class="ActionScriptOperator">=</span><span class="ActionScriptString">"null"</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">]</span>
        
        <span class="ActionScriptASDoc">/**
         *  @copy flash.text.TextField#restrict
         * 
         *  @default null
         *  
         *  @langversion 3.0
         *  @playerversion Flash 10
         *  @playerversion AIR 1.5
         *  @productversion Flex 4
         */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptReserved">get</span> <span class="ActionScriptDefault_Text">restrict</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">String</span> 
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">_restrict</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptASDoc">/**
         *  @private
         */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptReserved">set</span> <span class="ActionScriptDefault_Text">restrict</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">value</span>:<span class="ActionScriptDefault_Text">String</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">_restrict</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">value</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptComment">//----------------------------------
</span>        <span class="ActionScriptComment">//  selectable
</span>        <span class="ActionScriptComment">//----------------------------------
</span>        
        <span class="ActionScriptASDoc">/**
         *  @private
         */</span>
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">_selectable</span>:<span class="ActionScriptDefault_Text">Boolean</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">true</span>;
        
        <span class="ActionScriptASDoc">/**
         *  @private
         */</span>
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">selectableChanged</span>:<span class="ActionScriptDefault_Text">Boolean</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">false</span>;
        
        <span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptMetadata">Inspectable</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"General"</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">defaultValue</span><span class="ActionScriptOperator">=</span><span class="ActionScriptString">"true"</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">]</span>
        
        <span class="ActionScriptASDoc">/**
         *  A flag indicating whether the content is selectable
         *  with the mouse, or with the keyboard when the control
         *  has the keyboard focus.
         *
         *  &lt;p&gt;Making the text selectable lets you copy text from the control.&lt;/p&gt;
         *
         *  &lt;p&gt;This property is ignored if the &lt;code&gt;editable&lt;/code&gt;
         *  property is &lt;code&gt;true&lt;/code&gt;.&lt;/p&gt;
         *
         *  @default true
         *  
         *  @langversion 3.0
         *  @playerversion Flash 10
         *  @playerversion AIR 1.5
         *  @productversion Flex 4
         */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptReserved">get</span> <span class="ActionScriptDefault_Text">selectable</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">Boolean</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">_selectable</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptASDoc">/**
         *  @private
         */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptReserved">set</span> <span class="ActionScriptDefault_Text">selectable</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">value</span>:<span class="ActionScriptDefault_Text">Boolean</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">value</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptDefault_Text">_selectable</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptReserved">return</span>;
            
            <span class="ActionScriptDefault_Text">_selectable</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">value</span>;
            <span class="ActionScriptDefault_Text">selectableChanged</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">true</span>;
            
            <span class="ActionScriptDefault_Text">invalidateProperties</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">invalidateDisplayList</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptComment">//----------------------------------
</span>        <span class="ActionScriptComment">//  selectionActivePosition
</span>        <span class="ActionScriptComment">//----------------------------------
</span>        
        <span class="ActionScriptASDoc">/**
         *  @private
         */</span>
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">_selectionActivePosition</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> -1;
        
        <span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptMetadata">Bindable</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"selectionChange"</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">]</span>
        <span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptMetadata">Inspectable</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"General"</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">defaultValue</span><span class="ActionScriptOperator">=</span><span class="ActionScriptString">"-1"</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">]</span>
        
        <span class="ActionScriptASDoc">/**
         *  A character position, relative to the beginning of the
         *  &lt;code&gt;text&lt;/code&gt; String, specifying the end of the selection
         *  that moves when the selection is extended with the arrow keys.
         *
         *  &lt;p&gt;The active position may be either the start
         *  or the end of the selection.&lt;/p&gt;
         *
         *  &lt;p&gt;For example, if you drag-select from position 12 to position 8,
         *  then &lt;code&gt;selectionAnchorPosition&lt;/code&gt; will be 12
         *  and &lt;code&gt;selectionActivePosition&lt;/code&gt; will be 8,
         *  and when you press Left-Arrow &lt;code&gt;selectionActivePosition&lt;/code&gt;
         *  will become 7.&lt;/p&gt;
         *
         *  &lt;p&gt;A value of -1 indicates "not set".&lt;/p&gt;
         *
         *  @default -1
         *
         *  @see spark.components.RichEditableText#selectionAnchorPosition
         *  
         *  @langversion 3.0
         *  @playerversion Flash 10
         *  @playerversion AIR 1.5
         *  @productversion Flex 4
         */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptReserved">get</span> <span class="ActionScriptDefault_Text">selectionActivePosition</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">int</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">_selectionActivePosition</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptComment">//----------------------------------
</span>        <span class="ActionScriptComment">//  selectionAnchorPosition
</span>        <span class="ActionScriptComment">//----------------------------------
</span>        
        <span class="ActionScriptASDoc">/**
         *  @private
         */</span>
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">_selectionAnchorPosition</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> -1;
        
        <span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptMetadata">Bindable</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"selectionChange"</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">]</span>
        <span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptMetadata">Inspectable</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"General"</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">defaultValue</span><span class="ActionScriptOperator">=</span><span class="ActionScriptString">"-1"</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">]</span>
        
        <span class="ActionScriptASDoc">/**
         *  A character position, relative to the beginning of the
         *  &lt;code&gt;text&lt;/code&gt; String, specifying the end of the selection
         *  that stays fixed when the selection is extended with the arrow keys.
         *
         *  &lt;p&gt;The anchor position may be either the start
         *  or the end of the selection.&lt;/p&gt;
         *
         *  &lt;p&gt;For example, if you drag-select from position 12 to position 8,
         *  then &lt;code&gt;selectionAnchorPosition&lt;/code&gt; will be 12
         *  and &lt;code&gt;selectionActivePosition&lt;/code&gt; will be 8,
         *  and when you press Left-Arrow &lt;code&gt;selectionActivePosition&lt;/code&gt;
         *  will become 7.&lt;/p&gt;
         *
         *  &lt;p&gt;A value of -1 indicates "not set".&lt;/p&gt;
         *
         *  @default -1
         *
         *  @see spark.components.RichEditableText#selectionActivePosition
         *  
         *  @langversion 3.0
         *  @playerversion Flash 10
         *  @playerversion AIR 1.5
         *  @productversion Flex 4
         */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptReserved">get</span> <span class="ActionScriptDefault_Text">selectionAnchorPosition</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">int</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">_selectionAnchorPosition</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptComment">//----------------------------------
</span>        <span class="ActionScriptComment">//  selectionHighlighting
</span>        <span class="ActionScriptComment">//----------------------------------
</span>        
        <span class="ActionScriptASDoc">/**
         *  @private
         */</span>
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">_selectionHighlighting</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptOperator">=</span>
            <span class="ActionScriptDefault_Text">TextSelectionHighlighting</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">WHEN_FOCUSED</span>;
        
        <span class="ActionScriptASDoc">/**
         *  @private
         *  To indicate either selection highlighting or selection styles have
         *  changed.
         */</span>
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">selectionFormatsChanged</span>:<span class="ActionScriptDefault_Text">Boolean</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">false</span>;
        
        <span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptMetadata">Inspectable</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"General"</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">enumeration</span><span class="ActionScriptOperator">=</span><span class="ActionScriptString">"always,whenActive,whenFocused"</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">defaultValue</span><span class="ActionScriptOperator">=</span><span class="ActionScriptString">"whenFocused"</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">]</span>
        
        <span class="ActionScriptASDoc">/**
         *  Determines when the text selection is highlighted.
         *  
         *  &lt;p&gt;The allowed values are specified by the
         *  spark.components.TextSelectionHighlighting class.
         *  Possible values are &lt;code&gt;TextSelectionHighlighting.WHEN_FOCUSED&lt;/code&gt;,
         *  &lt;code&gt;TextSelectionHighlighting.WHEN_ACTIVE&lt;/code&gt;,
         *  and &lt;code&gt;TextSelectionHighlighting.ALWAYS&lt;/code&gt;.&lt;/p&gt;
         *
         *  &lt;p&gt;&lt;code&gt;WHEN_FOCUSED&lt;/code&gt; shows the text selection
         *  only when the component has keyboard focus.&lt;/p&gt;
         *  
         *  &lt;p&gt;&lt;code&gt;WHEN_ACTIVE&lt;/code&gt; shows the text selection whenever
         *  the component's window is active, even if the component
         *  doesn't have the keyboard focus.&lt;/p&gt;
         *
         *  &lt;p&gt;&lt;code&gt;ALWAYS&lt;/code&gt; shows the text selection,
         *  even if the component doesn't have the keyboard focus
         *  or if the component's window isn't the active window.&lt;/p&gt;
         *  
         *  @default TextSelectionHighlighting.WHEN_FOCUSED
         *  
         *  @see spark.components.TextSelectionHighlighting
         * 
         *  @langversion 3.0
         *  @playerversion Flash 10
         *  @playerversion AIR 1.5
         *  @productversion Flex 4
         */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptReserved">get</span> <span class="ActionScriptDefault_Text">selectionHighlighting</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">String</span> 
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">_selectionHighlighting</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptASDoc">/**
         *  @private
         */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptReserved">set</span> <span class="ActionScriptDefault_Text">selectionHighlighting</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">value</span>:<span class="ActionScriptDefault_Text">String</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">value</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptDefault_Text">_selectionHighlighting</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptReserved">return</span>;
            
            <span class="ActionScriptDefault_Text">_selectionHighlighting</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">value</span>;
            <span class="ActionScriptDefault_Text">selectionFormatsChanged</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">true</span>;
            
            <span class="ActionScriptDefault_Text">invalidateProperties</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">invalidateDisplayList</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptComment">//----------------------------------
</span>        <span class="ActionScriptComment">//  text
</span>        <span class="ActionScriptComment">//----------------------------------
</span>        
        <span class="ActionScriptASDoc">/**
         *  @private
         */</span>
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">_text</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptString">""</span>;
        
        <span class="ActionScriptASDoc">/**
         *  @private
         */</span>
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">textChanged</span>:<span class="ActionScriptDefault_Text">Boolean</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">false</span>;
        
        <span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptMetadata">Bindable</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"change"</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">]</span>
        <span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptMetadata">Inspectable</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"General"</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">defaultValue</span><span class="ActionScriptOperator">=</span><span class="ActionScriptString">""</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">]</span>
        
        <span class="ActionScriptASDoc">/**
         *  The text String displayed by this component.
         *
         *  &lt;p&gt;Setting this property affects the &lt;code&gt;textFlow&lt;/code&gt; property
         *  and vice versa.&lt;/p&gt;
         *
         *  &lt;p&gt;If you set the &lt;code&gt;text&lt;/code&gt; to a String such as
         *  &lt;code&gt;"Hello World"&lt;/code&gt; and get the &lt;code&gt;textFlow&lt;/code&gt;,
         *  it will be a TextFlow containing a single ParagraphElement
         *  with a single SpanElement.&lt;/p&gt;
         *
         *  &lt;p&gt;If you set the &lt;code&gt;text&lt;/code&gt; to null, it will be
         *  set to the default value which is an empty string.&lt;/p&gt;
         * 
         *  &lt;p&gt;If the text contains explicit line breaks --
         *  CR ("\r"), LF ("\n"), or CR+LF ("\r\n") --
         *  then the content will be set to a TextFlow
         *  which contains multiple paragraphs, each with one span.&lt;/p&gt;
         *
         *  &lt;p&gt;If you set the &lt;code&gt;textFlow&lt;/code&gt; and get the &lt;code&gt;text&lt;/code&gt;,
         *  the text in each paragraph will be separated by a single
         *  LF ("\n").&lt;/p&gt;
         *
         *  &lt;p&gt;Setting this property also affects the properties
         *  specifying the control's scroll position and the text selection.
         *  It resets the &lt;code&gt;horizontalScrollPosition&lt;/code&gt;
         *  and &lt;code&gt;verticalScrollPosition&lt;/code&gt; to 0,
         *  and it sets the &lt;code&gt;selectionAnchorPosition&lt;/code&gt;
         *  and &lt;code&gt;selectionActivePosition&lt;/code&gt;
         *  to -1 to clear the selection.&lt;/p&gt;
         *
         *  @default ""
         *
         *  @see spark.components.RichEditableText#textFlow
         *  @see spark.components.RichEditableText#horizontalScrollPosition
         *  @see spark.components.RichEditableText#verticalScrollPosition
         *  @see spark.components.RichEditableText#selectionAnchorPosition
         *  @see spark.components.RichEditableText#selectionActivePosition
         *  
         *  @langversion 3.0
         *  @playerversion Flash 10
         *  @playerversion AIR 1.5
         *  @productversion Flex 4
         */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptReserved">get</span> <span class="ActionScriptDefault_Text">text</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">String</span> 
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptComment">// Extracting the plaintext from a TextFlow is somewhat expensive,
</span>            <span class="ActionScriptComment">// as it involves iterating over the leaf FlowElements in the TextFlow.
</span>            <span class="ActionScriptComment">// Therefore we do this extraction only when necessary, namely when
</span>            <span class="ActionScriptComment">// you first set the 'content' or the 'textFlow'
</span>            <span class="ActionScriptComment">// (or mutate the TextFlow), and then get the 'text'.
</span>            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">_text</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptReserved">null</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptComment">// If 'content' was last set,
</span>                <span class="ActionScriptComment">// we have to first turn that into a TextFlow.
</span>                <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">_content</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptReserved">null</span><span class="ActionScriptBracket/Brace">)</span>
                    <span class="ActionScriptDefault_Text">_textFlow</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">createTextFlowFromContent</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">_content</span><span class="ActionScriptBracket/Brace">)</span>;
                
                <span class="ActionScriptComment">// Once we have a TextFlow, we can export its plain text.
</span>                <span class="ActionScriptDefault_Text">_text</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">staticPlainTextExporter</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">export</span><span class="ActionScriptBracket/Brace">(</span>
                    <span class="ActionScriptDefault_Text">_textFlow</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">ConversionType</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">STRING_TYPE</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptReserved">as</span> <span class="ActionScriptDefault_Text">String</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            
            <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">_text</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptASDoc">/**
         *  @private
         *  This will create a TextFlow with a single paragraph with a single span 
         *  with exactly the text specified.  If there is whitespace and line 
         *  breaks in the text, they will remain, regardless of the settings of
         *  the lineBreak and whiteSpaceCollapse styles.
         */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptReserved">set</span> <span class="ActionScriptDefault_Text">text</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">value</span>:<span class="ActionScriptDefault_Text">String</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptComment">// Treat setting the 'text' to null
</span>            <span class="ActionScriptComment">// as if it were set to the empty String
</span>            <span class="ActionScriptComment">// (which is the default state).
</span>            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">value</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptReserved">null</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptDefault_Text">value</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptString">""</span>;
            
            <span class="ActionScriptComment">// If value is the same as _text, make sure if was not produced from
</span>            <span class="ActionScriptComment">// setting 'textFlow' or 'content'.  For example, if you set a TextFlow 
</span>            <span class="ActionScriptComment">// corresponding to "Hello &lt;span color="OxFF0000"&gt;World&lt;/span&gt;"
</span>            <span class="ActionScriptComment">// and then get the 'text', it will be the String "Hello World"
</span>            <span class="ActionScriptComment">// But if you then set the 'text' to "Hello World"
</span>            <span class="ActionScriptComment">// this represents a change: the "World" should no longer be red.
</span>            <span class="ActionScriptComment">//
</span>            <span class="ActionScriptComment">// Note: this is needed to stop two-binding from recursing.
</span>            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">source</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptString">"text"</span> <span class="ActionScriptOperator">&amp;&amp;</span> <span class="ActionScriptDefault_Text">text</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptDefault_Text">value</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptReserved">return</span>;
            
            <span class="ActionScriptDefault_Text">_text</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">value</span>;
            <span class="ActionScriptDefault_Text">textChanged</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">true</span>;
            <span class="ActionScriptDefault_Text">source</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptString">"text"</span>;
            
            <span class="ActionScriptComment">// Of 'text', 'textFlow', and 'content', the last one set wins.
</span>            <span class="ActionScriptDefault_Text">textFlowChanged</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">false</span>;
            <span class="ActionScriptDefault_Text">contentChanged</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">false</span>;
            
            <span class="ActionScriptComment">// The other two are now invalid and must be recalculated when needed.
</span>            <span class="ActionScriptDefault_Text">_textFlow</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">null</span>;
            <span class="ActionScriptDefault_Text">_content</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">null</span>;
            
            <span class="ActionScriptDefault_Text">invalidateProperties</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">invalidateSize</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">invalidateDisplayList</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptDefault_Text">dispatchEvent</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">FlexEvent</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">FlexEvent</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">VALUE_COMMIT</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>;                                   
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptComment">//----------------------------------
</span>        <span class="ActionScriptComment">//  textContainerManager
</span>        <span class="ActionScriptComment">//----------------------------------
</span>        
        <span class="ActionScriptASDoc">/**
         *  @private
         */</span>
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">_textContainerManager</span>:<span class="ActionScriptDefault_Text">RichEditableTextContainerManager</span>;
        
        <span class="ActionScriptASDoc">/**
         *  @private
         *  The TLF TextContainerManager instance that displays,
         *  scrolls, and edits the text in this component.
         */</span>
        <span class="ActionScriptDefault_Text">mx_internal</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptReserved">get</span> <span class="ActionScriptDefault_Text">textContainerManager</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">TextContainerManager</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">_textContainerManager</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptComment">//----------------------------------
</span>        <span class="ActionScriptComment">//  textFlow
</span>        <span class="ActionScriptComment">//----------------------------------
</span>        
        <span class="ActionScriptASDoc">/**
         *  @private
         *  Storage for the textFlow property.
         */</span>
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">_textFlow</span>:<span class="ActionScriptDefault_Text">TextFlow</span>;
        
        <span class="ActionScriptASDoc">/**
         *  @private
         */</span>
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">textFlowChanged</span>:<span class="ActionScriptDefault_Text">Boolean</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">false</span>;
        
        <span class="ActionScriptASDoc">/**
         *  The TextFlow representing the rich text displayed by this component.
         * 
         *  &lt;p&gt;A TextFlow is the most important class
         *  in the Text Layout Framework (TLF).
         *  It is the root of a tree of FlowElements
         *  representing rich text content.&lt;/p&gt;
         *
         *  &lt;p&gt;You normally create a TextFlow from TLF markup
         *  using the &lt;code&gt;TextFlowUtil.importFromString()&lt;/code&gt;
         *  or &lt;code&gt;TextFlowUtil.importFromXML()&lt;/code&gt; methods.
         *  Alternately, you can use TLF's TextConverter class
         *  (which can import a subset of HTML) or build a TextFlow
         *  using methods like &lt;code&gt;addChild()&lt;/code&gt; on TextFlow.&lt;/p&gt;
         *
         *  &lt;p&gt;Setting this property affects the &lt;code&gt;text&lt;/code&gt; property
         *  and vice versa.&lt;/p&gt;
         *
         *  &lt;p&gt;If you set the &lt;code&gt;textFlow&lt;/code&gt; and get the &lt;code&gt;text&lt;/code&gt;,
         *  the text in each paragraph will be separated by a single
         *  LF ("\n").&lt;/p&gt;
         *
         *  &lt;p&gt;If you set the &lt;code&gt;text&lt;/code&gt; to a String such as
         *  &lt;code&gt;"Hello World"&lt;/code&gt; and get the &lt;code&gt;textFlow&lt;/code&gt;,
         *  it will be a TextFlow containing a single ParagraphElement
         *  with a single SpanElement.&lt;/p&gt;
         *
         *  &lt;p&gt;If the text contains explicit line breaks --
         *  CR ("\r"), LF ("\n"), or CR+LF ("\r\n") --
         *  then the content will be set to a TextFlow
         *  which contains multiple paragraphs, each with one span.&lt;/p&gt;
         *
         *  &lt;p&gt;Setting this property also affects the properties
         *  specifying the control's scroll position and the text selection.
         *  It resets the &lt;code&gt;horizontalScrollPosition&lt;/code&gt;
         *  and &lt;code&gt;verticalScrollPosition&lt;/code&gt; to 0,
         *  and it sets the &lt;code&gt;selectionAnchorPosition&lt;/code&gt;
         *  and &lt;code&gt;selectionActivePosition&lt;/code&gt;
         *  to -1 to clear the selection.&lt;/p&gt;
         *
         *  &lt;p&gt;To turn a TextFlow object into TLF markup,
         *  use the &lt;code&gt;TextFlowUtil.export()&lt;/code&gt; markup.&lt;/p&gt;
         *
         *  &lt;p&gt;A single TextFlow cannot be shared by multiple instances
         *  of RichEditableText.
         *  To display the same text in a second instance, you must create
         *  a second TextFlow, either by using &lt;code&gt;TextFlowUtil.export()&lt;/code&gt;
         *  and &lt;code&gt;TextFlowUtil.importFromXML()&lt;/code&gt; or by using
         *  the &lt;code&gt;deepCopy()&lt;/code&gt; method on TextFlow.&lt;/p&gt;
         *
         *  @see spark.utils.TextFlowUtil#importFromString()
         *  @see spark.utils.TextFlowUtil#importFromXML()
         *  @see spark.components.RichEditableText#text
         *  
         *  @langversion 3.0
         *  @playerversion Flash 10
         *  @playerversion AIR 2.5
         *  @productversion Flex 4.5
         */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptReserved">get</span> <span class="ActionScriptDefault_Text">textFlow</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">TextFlow</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptComment">// Note: this could be called before all properties are committed.
</span>            
            <span class="ActionScriptComment">// We might not have a valid _textFlow for two reasons:
</span>            <span class="ActionScriptComment">// either because the 'text' was set (which is the state
</span>            <span class="ActionScriptComment">// after construction) or because the 'content' was set.
</span>            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptOperator">!</span><span class="ActionScriptDefault_Text">_textFlow</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">_content</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptReserved">null</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptDefault_Text">_textFlow</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">createTextFlowFromContent</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">_content</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptDefault_Text">_content</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">null</span>;
                <span class="ActionScriptBracket/Brace">}</span>
                <span class="ActionScriptReserved">else</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptDefault_Text">_textFlow</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">staticPlainTextImporter</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">importToFlow</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">_text</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptBracket/Brace">}</span>
                <span class="ActionScriptDefault_Text">textFlowChanged</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">true</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            
            <span class="ActionScriptComment">// Make sure the interactionManager and controller are added to this textFlow.           
</span>            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">textChanged</span> <span class="ActionScriptOperator">||</span> <span class="ActionScriptDefault_Text">contentChanged</span> <span class="ActionScriptOperator">||</span> <span class="ActionScriptDefault_Text">textFlowChanged</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">_textContainerManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">setTextFlow</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">_textFlow</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">textChanged</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">contentChanged</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">textFlowChanged</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">false</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            
            <span class="ActionScriptComment">// If not read-only, make sure the textFlow has a composer in
</span>            <span class="ActionScriptComment">// place so that it can be modified by the caller if desired.
</span>            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">editingMode</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptDefault_Text">EditingMode</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">READ_ONLY</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">_textContainerManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">beginInteraction</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">_textContainerManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">endInteraction</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            
            <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">_textFlow</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptASDoc">/**
         *  @private
         */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptReserved">set</span> <span class="ActionScriptDefault_Text">textFlow</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">value</span>:<span class="ActionScriptDefault_Text">TextFlow</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptComment">// Treat setting the 'textFlow' to null
</span>            <span class="ActionScriptComment">// as if 'text' were being set to the empty String
</span>            <span class="ActionScriptComment">// (which is the default state).
</span>            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">value</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptReserved">null</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">text</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptString">""</span>;
                <span class="ActionScriptReserved">return</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">value</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptDefault_Text">_textFlow</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptReserved">return</span>;
            
            <span class="ActionScriptDefault_Text">_textFlow</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">value</span>;
            <span class="ActionScriptDefault_Text">textFlowChanged</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">true</span>;
            <span class="ActionScriptDefault_Text">source</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptString">"textFlow"</span>;
            
            <span class="ActionScriptComment">// Of 'text', 'textFlow', and 'content', the last one set wins.
</span>            <span class="ActionScriptDefault_Text">textChanged</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">false</span>;
            <span class="ActionScriptDefault_Text">contentChanged</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">false</span>;
            
            <span class="ActionScriptComment">// The other two are now invalid and must be recalculated when needed.
</span>            <span class="ActionScriptDefault_Text">_text</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">null</span>
            <span class="ActionScriptDefault_Text">_content</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">null</span>;
            
            <span class="ActionScriptDefault_Text">invalidateProperties</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">invalidateSize</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">invalidateDisplayList</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptDefault_Text">dispatchEvent</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">FlexEvent</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">FlexEvent</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">VALUE_COMMIT</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>;                                   
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptComment">//----------------------------------
</span>        <span class="ActionScriptComment">//  typicalText
</span>        <span class="ActionScriptComment">//----------------------------------
</span>        
        <span class="ActionScriptASDoc">/**
         *  @private
         */</span>
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">typicalTextChanged</span>:<span class="ActionScriptDefault_Text">Boolean</span>;
                
        <span class="ActionScriptASDoc">/**
         *  @private
         */</span>
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">_typicalText</span>:<span class="ActionScriptDefault_Text">String</span>;
        
        <span class="ActionScriptASDoc">/**
         *  @private
         *  Used when _typicalText is multiline
         */</span>
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">_typicalTextFlow</span>:<span class="ActionScriptDefault_Text">TextFlow</span>;
        
        <span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptMetadata">Inspectable</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"General"</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">defaultValue</span><span class="ActionScriptOperator">=</span><span class="ActionScriptString">"null"</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">]</span>

        <span class="ActionScriptASDoc">/**
         *  Text that is used to determine
         *  the default width and height of the control, 
         *  without actually being displayed.
         *
         *  &lt;p&gt;This property will be ignored if you specify an explicit width,
         *  a percent width, or both &lt;code&gt;left&lt;/code&gt; and &lt;code&gt;right&lt;/code&gt;
         *  constraints.&lt;/p&gt;
         *
         *  &lt;p&gt;Use of this property causes the &lt;code&gt;widthInChars&lt;/code&gt; 
         *  and &lt;code&gt;heightInLines&lt;/code&gt; properties to be ignored. &lt;/p&gt;
         *
         *  @default null
         *
         *  @see spark.primitives.heightInLines
         *  @see spark.primitives.widthInChars
         *
         *  @langversion 3.0
         *  @playerversion Flash 10.2
         *  @playerversion AIR 2.0
         *  @productversion Flex 4.5
         */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptReserved">get</span> <span class="ActionScriptDefault_Text">typicalText</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">String</span> 
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">_typicalText</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptASDoc">/**
         *  @private
         */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptReserved">set</span> <span class="ActionScriptDefault_Text">typicalText</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">value</span>:<span class="ActionScriptDefault_Text">String</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">value</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptDefault_Text">_typicalText</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptReserved">return</span>;
            
            <span class="ActionScriptDefault_Text">_typicalText</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">value</span>;
            
            <span class="ActionScriptDefault_Text">typicalTextChanged</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">true</span>;
            
            <span class="ActionScriptDefault_Text">invalidateProperties</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">invalidateSize</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">invalidateDisplayList</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptComment">//----------------------------------
</span>        <span class="ActionScriptComment">//  widthInChars
</span>        <span class="ActionScriptComment">//----------------------------------
</span>        
        <span class="ActionScriptASDoc">/**
         *  @private
         *  These are measured in ems.
         */</span>
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">_widthInChars</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">NaN</span>;
        
        <span class="ActionScriptASDoc">/**
         *  @private
         */</span>
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">widthInCharsChanged</span>:<span class="ActionScriptDefault_Text">Boolean</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">true</span>;
        
        <span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptMetadata">Inspectable</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"General"</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">minValue</span><span class="ActionScriptOperator">=</span><span class="ActionScriptString">"0.0"</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">]</span>

        <span class="ActionScriptASDoc">/**
         *  The default width of the control, measured in em units.
         *
         *  &lt;p&gt;An em is a unit of typographic measurement
         *  equal to the point size.
         *  It is not necessarily exactly the width of the "M" character,
         *  but in many fonts the "M" is about one em wide.
         *  The control's &lt;code&gt;fontSize&lt;/code&gt; style is used,
         *  to calculate the em unit in pixels.&lt;/p&gt;
         *
         *  &lt;p&gt;You would, for example, set this property to 20 if you want
         *  the width of the RichEditableText to be sufficient
         *  to display about 20 characters of text.&lt;/p&gt;
         *
         *  &lt;p&gt;If this property is &lt;code&gt;NaN&lt;/code&gt; (the default),
         *  then the component's default width will be determined
         *  from the text to be displayed.&lt;/p&gt;
         *
         *  &lt;p&gt;This property will be ignored if you specify an explicit width,
         *  a percent width, or both &lt;code&gt;left&lt;/code&gt; and &lt;code&gt;right&lt;/code&gt;
         *  constraints.&lt;/p&gt;
         *
         *  &lt;p&gt;This property will also be ignored if the &lt;code&gt;typicalText&lt;/code&gt; 
         *  property is specified.&lt;/p&gt;
         * 
         *  &lt;p&gt;RichEditableText's &lt;code&gt;measure()&lt;/code&gt; method uses
         *  &lt;code&gt;widthInChars&lt;/code&gt; and &lt;code&gt;heightInLines&lt;/code&gt;
         *  to determine the &lt;code&gt;measuredWidth&lt;/code&gt;
         *  and &lt;code&gt;measuredHeight&lt;/code&gt;. 
         *  These are similar to the &lt;code&gt;cols&lt;/code&gt; and &lt;code&gt;rows&lt;/code&gt;
         *  of an HTML TextArea.&lt;/p&gt;
         *
         *  &lt;p&gt;Since both &lt;code&gt;widthInChars&lt;/code&gt; and &lt;code&gt;heightInLines&lt;/code&gt;
         *  default to &lt;code&gt;NaN&lt;/code&gt;, RichTextEditable "autosizes" by default:
         *  it starts out very small if it has no text, grows in width as you
         *  type, and grows in height when you press Enter to start a new line.&lt;/p&gt;
         *
         *  @default NaN
         *
         *  @see spark.primitives.heightInLines
         *
         *  @langversion 3.0
         *  @playerversion Flash 10
         *  @playerversion AIR 1.5
         *  @productversion Flex 4
         */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptReserved">get</span> <span class="ActionScriptDefault_Text">widthInChars</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">Number</span> 
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">_widthInChars</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptASDoc">/**
         *  @private
         */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptReserved">set</span> <span class="ActionScriptDefault_Text">widthInChars</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">value</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">value</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptDefault_Text">_widthInChars</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptReserved">return</span>;
            
            <span class="ActionScriptDefault_Text">_widthInChars</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">value</span>;
            <span class="ActionScriptDefault_Text">widthInCharsChanged</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">true</span>;
            
            <span class="ActionScriptDefault_Text">widthConstraint</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">NaN</span>;
            
            <span class="ActionScriptDefault_Text">invalidateProperties</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">invalidateSize</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">invalidateDisplayList</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptComment">//--------------------------------------------------------------------------
</span>        <span class="ActionScriptComment">//
</span>        <span class="ActionScriptComment">//  Overridden Methods: UIComponent
</span>        <span class="ActionScriptComment">//
</span>        <span class="ActionScriptComment">//--------------------------------------------------------------------------
</span>        
        <span class="ActionScriptASDoc">/**
         *  @private
         */</span>
        <span class="ActionScriptReserved">override</span> <span class="ActionScriptReserved">protected</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">initializeAccessibility</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">RichEditableText</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">createAccessibilityImplementation</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptReserved">null</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptDefault_Text">RichEditableText</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">createAccessibilityImplementation</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">this</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptASDoc">/**
         *  @private
         */</span>
        <span class="ActionScriptReserved">override</span> <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">parentChanged</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">p</span>:<span class="ActionScriptDefault_Text">DisplayObjectContainer</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">focusManager</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">focusManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">removeEventListener</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">FlexEvent</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">FLEX_WINDOW_ACTIVATE</span><span class="ActionScriptOperator">,</span> 
                    <span class="ActionScriptDefault_Text">_textContainerManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">activateHandler</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptDefault_Text">focusManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">removeEventListener</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">FlexEvent</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">FLEX_WINDOW_DEACTIVATE</span><span class="ActionScriptOperator">,</span> 
                    <span class="ActionScriptDefault_Text">_textContainerManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">deactivateHandler</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">}</span>
            
            <span class="ActionScriptReserved">super</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">parentChanged</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">p</span><span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">focusManager</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">addActivateHandlers</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptReserved">else</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptComment">// if no focusmanager yet, add capture phase to detect when it
</span>                <span class="ActionScriptComment">// gets added
</span>                <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">systemManager</span><span class="ActionScriptBracket/Brace">)</span>
                    <span class="ActionScriptDefault_Text">systemManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">getSandboxRoot</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">addEventListener</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">FlexEvent</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">ADD_FOCUS_MANAGER</span><span class="ActionScriptOperator">,</span> 
                        <span class="ActionScriptDefault_Text">addFocusManagerHandler</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptReserved">true</span><span class="ActionScriptOperator">,</span> 0<span class="ActionScriptOperator">,</span> <span class="ActionScriptReserved">true</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptReserved">else</span>
                    <span class="ActionScriptComment">// no systemManager yet?  Check again when added to stage
</span>                    <span class="ActionScriptDefault_Text">addEventListener</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">Event</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">ADDED_TO_STAGE</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">addedToStageHandler</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptASDoc">/**
         *  @private
         */</span>
        <span class="ActionScriptReserved">override</span> <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">removeChild</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">child</span>:<span class="ActionScriptDefault_Text">DisplayObject</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">DisplayObject</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptComment">// not sure why this happens but it does if you just change
</span>            <span class="ActionScriptComment">// the embeddedFont context
</span>            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptOperator">!</span><span class="ActionScriptDefault_Text">child</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">parent</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">child</span>;
            
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">child</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">parent</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptReserved">this</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptReserved">return</span> <span class="ActionScriptReserved">super</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">removeChild</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">child</span><span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">child</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">parent</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">removeChild</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">child</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptASDoc">/**
         *  @private
         */</span>
        <span class="ActionScriptReserved">override</span> <span class="ActionScriptReserved">protected</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">commitProperties</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">super</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">commitProperties</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptDefault_Text">updateStylesIfChanged</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptComment">// EditingMode needs to be current before attempting to set a
</span>            <span class="ActionScriptComment">// selection below.
</span>            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">enabledChanged</span> <span class="ActionScriptOperator">||</span> <span class="ActionScriptDefault_Text">selectableChanged</span> <span class="ActionScriptOperator">||</span> <span class="ActionScriptDefault_Text">editableChanged</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">updateEditingMode</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
                
                <span class="ActionScriptDefault_Text">enabledChanged</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">false</span>;
                <span class="ActionScriptDefault_Text">editableChanged</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">false</span>;
                <span class="ActionScriptDefault_Text">selectableChanged</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">false</span>;          
            <span class="ActionScriptBracket/Brace">}</span>
            
            <span class="ActionScriptComment">// Only one of textChanged, textFlowChanged, and contentChanged
</span>            <span class="ActionScriptComment">// will be true; the other two will be false because each setter
</span>            <span class="ActionScriptComment">// guarantees this.
</span>            
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">textChanged</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptComment">// If the text has linebreaks (CR, LF, or CF+LF)
</span>                <span class="ActionScriptComment">// create a multi-paragraph TextFlow from it
</span>                <span class="ActionScriptComment">// and use the TextFlowTextLineFactory to render it.
</span>                <span class="ActionScriptComment">// Otherwise the StringTextLineFactory will put
</span>                <span class="ActionScriptComment">// all of the lines into a single paragraph
</span>                <span class="ActionScriptComment">// and FTE performance will degrade on a large paragraph.
</span>                <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">_text</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">indexOf</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"\n"</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptOperator">-</span>1 <span class="ActionScriptOperator">||</span> <span class="ActionScriptDefault_Text">_text</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">indexOf</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"\r"</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptOperator">-</span>1<span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptDefault_Text">_textFlow</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">staticPlainTextImporter</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">importToFlow</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">_text</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptDefault_Text">_textContainerManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">setTextFlow</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">_textFlow</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptBracket/Brace">}</span>
                <span class="ActionScriptReserved">else</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptDefault_Text">_textContainerManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">setText</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">_text</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptReserved">else</span> <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">textFlowChanged</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">_textContainerManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">setTextFlow</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">_textFlow</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptReserved">else</span> <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">contentChanged</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">_textFlow</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">createTextFlowFromContent</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">_content</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">_textContainerManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">setTextFlow</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">_textFlow</span><span class="ActionScriptBracket/Brace">)</span>;
                
                <span class="ActionScriptComment">// Content converted to textFlow.
</span>                <span class="ActionScriptDefault_Text">_content</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">null</span>;
            <span class="ActionScriptBracket/Brace">}</span>                        
            
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">textChanged</span> <span class="ActionScriptOperator">||</span> <span class="ActionScriptDefault_Text">textFlowChanged</span> <span class="ActionScriptOperator">||</span> <span class="ActionScriptDefault_Text">contentChanged</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">lastGeneration</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">_textFlow</span> <span class="ActionScriptOperator">?</span> <span class="ActionScriptDefault_Text">_textFlow</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">generation</span> : 0;
                <span class="ActionScriptDefault_Text">lastContentBoundsGeneration</span> <span class="ActionScriptOperator">=</span> 0;
                
                <span class="ActionScriptComment">// Handle the case where the initial text, textFlow or content 
</span>                <span class="ActionScriptComment">// is displayed as a password.
</span>                <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">displayAsPassword</span><span class="ActionScriptBracket/Brace">)</span>
                    <span class="ActionScriptDefault_Text">displayAsPasswordChanged</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">true</span>;
                
                <span class="ActionScriptComment">// New text so remove any leftover constraints.
</span>                <span class="ActionScriptComment">// Used if an item renderer is being recycled.
</span>                <span class="ActionScriptDefault_Text">widthConstraint</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">NaN</span>;
                <span class="ActionScriptDefault_Text">heightConstraint</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">NaN</span>;
                
                <span class="ActionScriptDefault_Text">textChanged</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">false</span>;
                <span class="ActionScriptDefault_Text">textFlowChanged</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">false</span>;
                <span class="ActionScriptDefault_Text">contentChanged</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">false</span>;
                <span class="ActionScriptDefault_Text">invalidateSize</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">invalidateDisplayList</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            
            <span class="ActionScriptComment">// If displayAsPassword changed, it only applies to the display, 
</span>            <span class="ActionScriptComment">// not the underlying text.
</span>            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">displayAsPasswordChanged</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">oldAnchorPosition</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">_selectionAnchorPosition</span>;
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">oldActivePosition</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">_selectionActivePosition</span>;
                
                <span class="ActionScriptComment">// If there is any text, convert it to the passwordChar.
</span>                <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">displayAsPassword</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptComment">// Make sure _text is set with the actual text before we
</span>                    <span class="ActionScriptComment">// change the displayed text.
</span>                    <span class="ActionScriptDefault_Text">_text</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">text</span>;
                    
                    <span class="ActionScriptComment">// Paragraph terminators are lost during this substitution.
</span>                    <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">textToDisplay</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">StringUtil</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">repeat</span><span class="ActionScriptBracket/Brace">(</span>
                        <span class="ActionScriptDefault_Text">passwordChar</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">_text</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">length</span><span class="ActionScriptBracket/Brace">)</span>;
                    
                    <span class="ActionScriptDefault_Text">_textContainerManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">setText</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">textToDisplay</span><span class="ActionScriptBracket/Brace">)</span>;                            
                <span class="ActionScriptBracket/Brace">}</span>
                <span class="ActionScriptReserved">else</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptComment">// Text was displayed as password.  Now display as plain text.
</span>                    <span class="ActionScriptDefault_Text">_textContainerManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">setText</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">_text</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptBracket/Brace">}</span>
                
                <span class="ActionScriptComment">// When TLF text is set above, TLF's textFlow is recreated so reset
</span>                <span class="ActionScriptComment">// our copy of the textFlow and the generation.
</span>                <span class="ActionScriptDefault_Text">_textFlow</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">null</span>;
                <span class="ActionScriptDefault_Text">lastGeneration</span> <span class="ActionScriptOperator">=</span> 0;
                <span class="ActionScriptDefault_Text">lastContentBoundsGeneration</span> <span class="ActionScriptOperator">=</span> 0;
                
                <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">editingMode</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptDefault_Text">EditingMode</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">READ_ONLY</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptComment">// Must preserve the selection, if there was one.
</span>                    <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">selManager</span>:<span class="ActionScriptDefault_Text">ISelectionManager</span> <span class="ActionScriptOperator">=</span> 
                        <span class="ActionScriptDefault_Text">_textContainerManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">beginInteraction</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
                    
                    <span class="ActionScriptComment">// The visible selection will be refreshed during the update.
</span>                    <span class="ActionScriptDefault_Text">selManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">selectRange</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">oldAnchorPosition</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">oldActivePosition</span><span class="ActionScriptBracket/Brace">)</span>;        
                    
                    <span class="ActionScriptDefault_Text">_textContainerManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">endInteraction</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptBracket/Brace">}</span>           
                
                <span class="ActionScriptDefault_Text">displayAsPasswordChanged</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">false</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">clipAndEnableScrollingChanged</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptComment">// The TLF code seems to check for !off.
</span>                <span class="ActionScriptDefault_Text">_textContainerManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">horizontalScrollPolicy</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptString">"auto"</span>;
                <span class="ActionScriptDefault_Text">_textContainerManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">verticalScrollPolicy</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptString">"auto"</span>;
                
                <span class="ActionScriptDefault_Text">clipAndEnableScrollingChanged</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">false</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">horizontalScrollPositionChanged</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">oldHorizontalScrollPosition</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> 
                    <span class="ActionScriptDefault_Text">_textContainerManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">horizontalScrollPosition</span>;
                
                <span class="ActionScriptDefault_Text">_textContainerManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">horizontalScrollPosition</span> <span class="ActionScriptOperator">=</span>
                    <span class="ActionScriptDefault_Text">_horizontalScrollPosition</span>; 
                
                <span class="ActionScriptDefault_Text">dispatchPropertyChangeEvent</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"horizontalScrollPosition"</span><span class="ActionScriptOperator">,</span>
                    <span class="ActionScriptDefault_Text">oldHorizontalScrollPosition</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">_horizontalScrollPosition</span><span class="ActionScriptBracket/Brace">)</span>;
                
                <span class="ActionScriptDefault_Text">horizontalScrollPositionChanged</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">false</span>;            
            <span class="ActionScriptBracket/Brace">}</span>
            
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">verticalScrollPositionChanged</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">oldVerticalScrollPosition</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> 
                    <span class="ActionScriptDefault_Text">_textContainerManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">verticalScrollPosition</span>;
                
                <span class="ActionScriptDefault_Text">_textContainerManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">verticalScrollPosition</span> <span class="ActionScriptOperator">=</span>
                    <span class="ActionScriptDefault_Text">_verticalScrollPosition</span>;
                
                <span class="ActionScriptDefault_Text">dispatchPropertyChangeEvent</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"verticalScrollPosition"</span><span class="ActionScriptOperator">,</span>
                    <span class="ActionScriptDefault_Text">oldVerticalScrollPosition</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">_verticalScrollPosition</span><span class="ActionScriptBracket/Brace">)</span>;
                
                <span class="ActionScriptDefault_Text">verticalScrollPositionChanged</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">false</span>;            
            <span class="ActionScriptBracket/Brace">}</span>
            
            <span class="ActionScriptComment">// Updating the text programatically removes all child TextLine elements
</span>            <span class="ActionScriptComment">// before rebuilding the TextFlow, effectively removing all visual elements
</span>            <span class="ActionScriptComment">// from the display list. This causes any accessibilityImplementation that
</span>            <span class="ActionScriptComment">// was assigned to the component to be removed. The following line restores
</span>            <span class="ActionScriptComment">// the accessibilityImplementation if it no longer exists. 
</span>            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptOperator">!</span><span class="ActionScriptDefault_Text">accessibilityImplementation</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptDefault_Text">initializeAccessibility</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptASDoc">/**
         *  @private
         */</span>
        <span class="ActionScriptReserved">override</span> <span class="ActionScriptReserved">protected</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">canSkipMeasurement</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">Boolean</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">autoSize</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">false</span>;
            <span class="ActionScriptReserved">return</span> <span class="ActionScriptReserved">super</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">canSkipMeasurement</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptASDoc">/**
         *  @private
         */</span>
        <span class="ActionScriptReserved">override</span> <span class="ActionScriptReserved">protected</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">measure</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span> 
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">bounds</span>:<span class="ActionScriptDefault_Text">Rectangle</span>;
            
            <span class="ActionScriptComment">// If the damage handler is called while measuring text, this means
</span>            <span class="ActionScriptComment">// the text lines are damaged and the display needs to be updated. 
</span>            <span class="ActionScriptComment">// This flag tells the handler to invalidate just the display list.
</span>            <span class="ActionScriptDefault_Text">inMeasureMethod</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">true</span>;
            
            <span class="ActionScriptDefault_Text">lastMeasuredWidth</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">measuredWidth</span>;
            <span class="ActionScriptDefault_Text">lastMeasuredHeight</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">measuredHeight</span>;
            
            <span class="ActionScriptReserved">super</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">measure</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptComment">// Styles can be changed in event handlers while in the middle
</span>            <span class="ActionScriptComment">// of the component lifecycle.  Make sure they are not stale when
</span>            <span class="ActionScriptComment">// composing text.
</span>            <span class="ActionScriptDefault_Text">updateStylesIfChanged</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptComment">// percentWidth and/or percentHeight will come back in as constraints
</span>            <span class="ActionScriptComment">// on the remeasure if we're autoSizing.
</span>            
            <span class="ActionScriptComment">// TODO:(cframpto) implement blockProgression rl for autoSize
</span>            
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">isMeasureFixed</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span> 
            <span class="ActionScriptBracket/Brace">{</span>            
                <span class="ActionScriptDefault_Text">autoSize</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">false</span>;
                
                <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">typicalText</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">typicalTextChanged</span><span class="ActionScriptBracket/Brace">)</span>
                    <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptComment">// If the text has linebreaks (CR, LF, or CF+LF)
</span>                        <span class="ActionScriptComment">// create a multi-paragraph TextFlow from it
</span>                        <span class="ActionScriptComment">// and use the TextFlowTextLineFactory to render it.
</span>                        <span class="ActionScriptComment">// Otherwise the StringTextLineFactory will put
</span>                        <span class="ActionScriptComment">// all of the lines into a single paragraph
</span>                        <span class="ActionScriptComment">// and FTE performance will degrade on a large paragraph.
</span>                        <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">_typicalText</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">indexOf</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"\n"</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptOperator">-</span>1 <span class="ActionScriptOperator">||</span> <span class="ActionScriptDefault_Text">_typicalText</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">indexOf</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"\r"</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptOperator">-</span>1<span class="ActionScriptBracket/Brace">)</span>
                        <span class="ActionScriptBracket/Brace">{</span>
                            <span class="ActionScriptDefault_Text">_typicalTextFlow</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">staticPlainTextImporter</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">importToFlow</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">_typicalText</span><span class="ActionScriptBracket/Brace">)</span>;
                            <span class="ActionScriptComment">// this helped get the factory to generate the same bounds as the
</span>                            <span class="ActionScriptComment">// composer
</span>                            <span class="ActionScriptDefault_Text">_typicalTextFlow</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">hostFormat</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">_textContainerManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">hostFormat</span>;
                        <span class="ActionScriptBracket/Brace">}</span>
                        <span class="ActionScriptReserved">else</span>
                            <span class="ActionScriptDefault_Text">_typicalTextFlow</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">null</span>;
                        <span class="ActionScriptDefault_Text">typicalTextChanged</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">false</span>;
                    <span class="ActionScriptBracket/Brace">}</span>
                    <span class="ActionScriptComment">// if multiline...
</span>                    <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">_typicalTextFlow</span><span class="ActionScriptBracket/Brace">)</span>
                    <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptComment">// create the factory if needed
</span>                        <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptOperator">!</span><span class="ActionScriptDefault_Text">staticTextFlowFactory</span><span class="ActionScriptBracket/Brace">)</span>
                        <span class="ActionScriptBracket/Brace">{</span>
                            <span class="ActionScriptDefault_Text">staticTextFlowFactory</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">TextFlowTextLineFactory</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
                            <span class="ActionScriptComment">// set bounds to natural bounds
</span>                            <span class="ActionScriptDefault_Text">staticTextFlowFactory</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">compositionBounds</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">unbounded</span>;
                        <span class="ActionScriptBracket/Brace">}</span>
                        <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">_typicalTextFlow</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">flowComposer</span><span class="ActionScriptBracket/Brace">)</span>
                        <span class="ActionScriptBracket/Brace">{</span>
                            <span class="ActionScriptDefault_Text">_typicalTextFlow</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">flowComposer</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">swfContext</span> <span class="ActionScriptOperator">=</span> 
                                <span class="ActionScriptDefault_Text">ISWFContext</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">embeddedFontContext</span><span class="ActionScriptBracket/Brace">)</span>;
                        <span class="ActionScriptBracket/Brace">}</span>                       
                        <span class="ActionScriptDefault_Text">staticTextFlowFactory</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">swfContext</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">ISWFContext</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">embeddedFontContext</span><span class="ActionScriptBracket/Brace">)</span>;
                        <span class="ActionScriptComment">// create the textlines
</span>                        <span class="ActionScriptDefault_Text">staticTextFlowFactory</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">createTextLines</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">tossTextLine</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">_typicalTextFlow</span><span class="ActionScriptBracket/Brace">)</span>;
                        <span class="ActionScriptComment">// get the bounds
</span>                        <span class="ActionScriptDefault_Text">bounds</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">staticTextFlowFactory</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">getContentBounds</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptBracket/Brace">}</span>
                    <span class="ActionScriptReserved">else</span> <span class="ActionScriptComment">// single line
</span>                    <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptComment">// create the factory if needed
</span>                        <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptOperator">!</span><span class="ActionScriptDefault_Text">staticStringFactory</span><span class="ActionScriptBracket/Brace">)</span>
                        <span class="ActionScriptBracket/Brace">{</span>
                            <span class="ActionScriptDefault_Text">staticStringFactory</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">StringTextLineFactory</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
                            <span class="ActionScriptComment">// set bounds to natural bounds
</span>                            <span class="ActionScriptDefault_Text">staticStringFactory</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">compositionBounds</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">unbounded</span>;
                        <span class="ActionScriptBracket/Brace">}</span>
                        <span class="ActionScriptComment">// create the textlines
</span>                        <span class="ActionScriptDefault_Text">staticStringFactory</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">text</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">_typicalText</span>;
                        <span class="ActionScriptDefault_Text">staticStringFactory</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">textFlowFormat</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">_textContainerManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">hostFormat</span>;
                        <span class="ActionScriptDefault_Text">staticStringFactory</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">swfContext</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">ISWFContext</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">embeddedFontContext</span><span class="ActionScriptBracket/Brace">)</span>;
                        <span class="ActionScriptDefault_Text">staticStringFactory</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">createTextLines</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">tossTextLine</span><span class="ActionScriptBracket/Brace">)</span>;
                        <span class="ActionScriptComment">// get the bounds
</span>                        <span class="ActionScriptDefault_Text">bounds</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">staticStringFactory</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">getContentBounds</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptBracket/Brace">}</span>           
                    
                    <span class="ActionScriptDefault_Text">measuredWidth</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">Math</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">ceil</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">bounds</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">width</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptDefault_Text">measuredHeight</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">Math</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">ceil</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">bounds</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">height</span><span class="ActionScriptBracket/Brace">)</span>;                  
                <span class="ActionScriptBracket/Brace">}</span>
                <span class="ActionScriptReserved">else</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptComment">// Go large.  For performance reasons, want to avoid a scrollRect 
</span>                    <span class="ActionScriptComment">// whenever possible in drawBackgroundAndSetScrollRect().  This is
</span>                    <span class="ActionScriptComment">// particularly true for 1 line TextInput components.
</span>                    <span class="ActionScriptDefault_Text">measuredWidth</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptOperator">!</span><span class="ActionScriptDefault_Text">isNaN</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">explicitWidth</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">?</span> <span class="ActionScriptDefault_Text">explicitWidth</span> :
                        <span class="ActionScriptDefault_Text">Math</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">ceil</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">calculateWidthInChars</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptDefault_Text">measuredHeight</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptOperator">!</span><span class="ActionScriptDefault_Text">isNaN</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">explicitHeight</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">?</span> <span class="ActionScriptDefault_Text">explicitHeight</span> :
                        <span class="ActionScriptDefault_Text">Math</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">ceil</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">calculateHeightInLines</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptReserved">else</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">composeWidth</span>:<span class="ActionScriptDefault_Text">Number</span>;
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">composeHeight</span>:<span class="ActionScriptDefault_Text">Number</span>;
                
                <span class="ActionScriptComment">// If we're here, then at one or both of the width and height can
</span>                <span class="ActionScriptComment">// grow to fit the text.  It is important to figure out whether
</span>                <span class="ActionScriptComment">// or not autoSize should be allowed to continue.  If in
</span>                <span class="ActionScriptComment">// updateDisplayList(), autoSize is true, then the 
</span>                <span class="ActionScriptComment">// compositionHeight is NaN to allow the text to grow.          
</span>                <span class="ActionScriptDefault_Text">autoSize</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">true</span>;
                
                <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptOperator">!</span><span class="ActionScriptDefault_Text">isNaN</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">widthConstraint</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">||</span> <span class="ActionScriptOperator">!</span><span class="ActionScriptDefault_Text">isNaN</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">explicitWidth</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">||</span> 
                    <span class="ActionScriptOperator">!</span><span class="ActionScriptDefault_Text">isNaN</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">widthInChars</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptComment">// width specified but no height
</span>                    <span class="ActionScriptComment">// if no text, start at one line high and grow
</span>                    
                    <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptOperator">!</span><span class="ActionScriptDefault_Text">isNaN</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">widthConstraint</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>
                        <span class="ActionScriptDefault_Text">composeWidth</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">widthConstraint</span>;
                    <span class="ActionScriptReserved">else</span> <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptOperator">!</span><span class="ActionScriptDefault_Text">isNaN</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">explicitWidth</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>                    
                        <span class="ActionScriptDefault_Text">composeWidth</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">explicitWidth</span>;
                    <span class="ActionScriptReserved">else</span>
                        <span class="ActionScriptDefault_Text">composeWidth</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">Math</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">ceil</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">calculateWidthInChars</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>;
                    
                    <span class="ActionScriptComment">// The composeWidth may be adjusted for minWidth/maxWidth
</span>                    <span class="ActionScriptComment">// except if we're using the explicitWidth.  
</span>                    <span class="ActionScriptDefault_Text">bounds</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">measureTextSize</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">composeWidth</span><span class="ActionScriptBracket/Brace">)</span>;
                    
                    <span class="ActionScriptComment">// The measured width shouldnt be pinned to the composeWidth if 
</span>                    <span class="ActionScriptComment">// the composeWidth is set by %, otherwise the measuredWidth 
</span>                    <span class="ActionScriptComment">// can keep stretching
</span>                    <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptOperator">!</span><span class="ActionScriptDefault_Text">isNaN</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">explicitWidth</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">||</span> <span class="ActionScriptOperator">!</span><span class="ActionScriptDefault_Text">isNaN</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">widthInChars</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>
                        <span class="ActionScriptDefault_Text">measuredWidth</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">textContainerManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">compositionWidth</span>;
                    <span class="ActionScriptReserved">else</span>
                        <span class="ActionScriptDefault_Text">measuredWidth</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">Math</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">ceil</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">bounds</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">width</span><span class="ActionScriptBracket/Brace">)</span>; 
                    <span class="ActionScriptDefault_Text">measuredHeight</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">Math</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">ceil</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">bounds</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">bottom</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptBracket/Brace">}</span>
                <span class="ActionScriptReserved">else</span> <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptOperator">!</span><span class="ActionScriptDefault_Text">isNaN</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">heightConstraint</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">||</span> <span class="ActionScriptOperator">!</span><span class="ActionScriptDefault_Text">isNaN</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">explicitHeight</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">||</span> 
                    <span class="ActionScriptOperator">!</span><span class="ActionScriptDefault_Text">isNaN</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">_heightInLines</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptComment">// if no text, 1 char wide with specified height and grow
</span>                    
                    <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptOperator">!</span><span class="ActionScriptDefault_Text">isNaN</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">heightConstraint</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>
                        <span class="ActionScriptDefault_Text">composeHeight</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">heightConstraint</span>;
                    <span class="ActionScriptReserved">else</span> <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptOperator">!</span><span class="ActionScriptDefault_Text">isNaN</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">explicitHeight</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>
                        <span class="ActionScriptDefault_Text">composeHeight</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">explicitHeight</span>;
                    <span class="ActionScriptReserved">else</span>
                        <span class="ActionScriptDefault_Text">composeHeight</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">calculateHeightInLines</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
                    
                    <span class="ActionScriptComment">// The composeWidth may be adjusted for minWidth/maxWidth.
</span>                    <span class="ActionScriptDefault_Text">bounds</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">measureTextSize</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">NaN</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">composeHeight</span><span class="ActionScriptBracket/Brace">)</span>;
                    
                    <span class="ActionScriptDefault_Text">measuredWidth</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">Math</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">ceil</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">bounds</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">right</span><span class="ActionScriptBracket/Brace">)</span>;               
                    <span class="ActionScriptDefault_Text">measuredHeight</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">composeHeight</span>;

                    <span class="ActionScriptComment">// Have we already hit the limit with the existing text?  If we
</span>                    <span class="ActionScriptComment">// are beyond the composeHeight we can assume we've maxed out on
</span>                    <span class="ActionScriptComment">// the compose width as well (or the composeHeight isn't
</span>                    <span class="ActionScriptComment">// large enough for even one line of text).
</span>                    <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">bounds</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">bottom</span> <span class="ActionScriptOperator">&gt;</span> <span class="ActionScriptDefault_Text">composeHeight</span><span class="ActionScriptBracket/Brace">)</span>
                        <span class="ActionScriptDefault_Text">autoSize</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">false</span>;
                <span class="ActionScriptBracket/Brace">}</span>
                <span class="ActionScriptReserved">else</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptComment">// The composeWidth may be adjusted for minWidth/maxWidth.
</span>                    <span class="ActionScriptDefault_Text">bounds</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">measureTextSize</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">NaN</span><span class="ActionScriptBracket/Brace">)</span>;
                    
                    <span class="ActionScriptDefault_Text">measuredWidth</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">Math</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">ceil</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">bounds</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">right</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptDefault_Text">measuredHeight</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">Math</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">ceil</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">bounds</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">bottom</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptBracket/Brace">}</span>
                
                <span class="ActionScriptComment">// Clamp the height, except if we're using the explicitHeight.
</span>                <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">isNaN</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">explicitHeight</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>            
                    <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptOperator">!</span><span class="ActionScriptDefault_Text">isNaN</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">explicitMinHeight</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">&amp;&amp;</span> <span class="ActionScriptDefault_Text">measuredHeight</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">explicitMinHeight</span><span class="ActionScriptBracket/Brace">)</span>
                        <span class="ActionScriptDefault_Text">measuredHeight</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">explicitMinHeight</span>;
                    
                    <span class="ActionScriptComment">// Reached max height so can't grow anymore.
</span>                    <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptOperator">!</span><span class="ActionScriptDefault_Text">isNaN</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">explicitMaxHeight</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">&amp;&amp;</span> <span class="ActionScriptDefault_Text">measuredHeight</span> <span class="ActionScriptOperator">&gt;</span> <span class="ActionScriptDefault_Text">explicitMaxHeight</span><span class="ActionScriptBracket/Brace">)</span>
                    <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptDefault_Text">measuredHeight</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">explicitMaxHeight</span>;
                        <span class="ActionScriptDefault_Text">autoSize</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">false</span>;
                    <span class="ActionScriptBracket/Brace">}</span>
                <span class="ActionScriptBracket/Brace">}</span>
                
                <span class="ActionScriptComment">// Make sure we weren't previously scrolled. 
</span>                <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">autoSize</span> <span class="ActionScriptOperator">&amp;&amp;</span> <span class="ActionScriptDefault_Text">getStyle</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"lineBreak"</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptString">"toFit"</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptDefault_Text">_textContainerManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">horizontalScrollPosition</span> <span class="ActionScriptOperator">=</span> 0;
                    <span class="ActionScriptDefault_Text">_textContainerManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">verticalScrollPosition</span> <span class="ActionScriptOperator">=</span> 0;                
                <span class="ActionScriptBracket/Brace">}</span>               
                
                <span class="ActionScriptComment">// If we remeasured, we composed and cleared the display.  We need to update the 
</span>                <span class="ActionScriptComment">// display if the size didn't change, since validateSize will not do it for us.  
</span>                <span class="ActionScriptComment">// This code path can be used by itemRenderer's since setLayoutBounds(), which is
</span>                <span class="ActionScriptComment">// where the constraints are set, is not always called.
</span>                <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">remeasuringText</span> <span class="ActionScriptOperator">&amp;&amp;</span> 
                    <span class="ActionScriptDefault_Text">lastMeasuredWidth</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptDefault_Text">measuredWidth</span> <span class="ActionScriptOperator">&amp;&amp;</span> <span class="ActionScriptDefault_Text">lastMeasuredHeight</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptDefault_Text">measuredHeight</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptDefault_Text">_textContainerManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">updateContainer</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptBracket/Brace">}</span>
            
            <span class="ActionScriptDefault_Text">remeasuringText</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">false</span>;
            <span class="ActionScriptDefault_Text">inMeasureMethod</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">false</span>;
            
            <span class="ActionScriptComment">//trace("measure", measuredWidth, measuredHeight, "autoSize", autoSize);
</span>        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptASDoc">/**
         *  @private
         */</span>
        <span class="ActionScriptReserved">override</span> <span class="ActionScriptReserved">protected</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">updateDisplayList</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">unscaledWidth</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptOperator">,</span>
                                                      <span class="ActionScriptDefault_Text">unscaledHeight</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span> 
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">inUpdateDLMethod</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">true</span>;
            
            <span class="ActionScriptComment">//trace("updateDisplayList", unscaledWidth, unscaledHeight, "autoSize", autoSize);
</span>            
            <span class="ActionScriptComment">// Styles can be changed in event handlers while in the middle
</span>            <span class="ActionScriptComment">// of the component lifecycle.  Make sure they are not stale when
</span>            <span class="ActionScriptComment">// composing text.
</span>            <span class="ActionScriptDefault_Text">updateStylesIfChanged</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptComment">// Check if the auto-size text is constrained in some way and needs
</span>            <span class="ActionScriptComment">// to be remeasured.  If one of the dimension changes, the text may
</span>            <span class="ActionScriptComment">// compose differently and have a different size which the layout 
</span>            <span class="ActionScriptComment">// manager needs to know.
</span>            <span class="ActionScriptComment">// Don't exit early if we have changed size.  We may have to run 
</span>            <span class="ActionScriptComment">// drawBackgroundAndSetScrollRect 
</span>            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">autoSize</span> <span class="ActionScriptOperator">&amp;&amp;</span> 
                <span class="ActionScriptDefault_Text">lastUnscaledHeight</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptDefault_Text">unscaledHeight</span> <span class="ActionScriptOperator">&amp;&amp;</span> <span class="ActionScriptDefault_Text">lastUnscaledWidth</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptDefault_Text">unscaledWidth</span> <span class="ActionScriptOperator">&amp;&amp;</span> 
                <span class="ActionScriptDefault_Text">remeasureText</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">unscaledWidth</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">unscaledHeight</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">inUpdateDLMethod</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">false</span>;
                <span class="ActionScriptReserved">return</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            
            <span class="ActionScriptReserved">super</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">updateDisplayList</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">unscaledWidth</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">unscaledHeight</span><span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptComment">// If we're autoSizing we're telling the layout manager one set of
</span>            <span class="ActionScriptComment">// values and TLF another set of values so there is room for the text
</span>            <span class="ActionScriptComment">// to grow.
</span>            
            <span class="ActionScriptComment">// TODO:(cframpto) compositionWidth can be NaN when 
</span>            <span class="ActionScriptComment">// autoSize for blockProgression=="rl" is implemented
</span>            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptOperator">!</span><span class="ActionScriptDefault_Text">autoSize</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">_textContainerManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">compositionWidth</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">unscaledWidth</span>;
                <span class="ActionScriptDefault_Text">_textContainerManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">compositionHeight</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">unscaledHeight</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            
            <span class="ActionScriptComment">// If scrolling, always compose with the composer so we get consistent
</span>            <span class="ActionScriptComment">// measurements.  The factory and the composer produce slightly 
</span>            <span class="ActionScriptComment">// different results which can confuse the scroller.  If there isn't a 
</span>            <span class="ActionScriptComment">// composer, this calls updateContainer so do it here now that the 
</span>            <span class="ActionScriptComment">// composition sizes are set so the results can be used.
</span>            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">clipAndEnableScrolling</span> <span class="ActionScriptOperator">&amp;&amp;</span> 
                <span class="ActionScriptDefault_Text">_textContainerManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">composeState</span> <span class="ActionScriptOperator">!=</span> 
                <span class="ActionScriptDefault_Text">TextContainerManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">COMPOSE_COMPOSER</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">_textContainerManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">convertToTextFlowWithComposer</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            
            <span class="ActionScriptComment">// The EditManager calls updateAllControllers() directly when there
</span>            <span class="ActionScriptComment">// is interactive input such as typing or cut/paste. This bypasses
</span>            <span class="ActionScriptComment">// our update cycle which matters if we are auto-sizing.
</span>            <span class="ActionScriptComment">// compositionWidth/Height are NaN and the background is drawn with
</span>            <span class="ActionScriptComment">// the old width/height because measureTextSize hasn't had a
</span>            <span class="ActionScriptComment">// chance to update the layout manager yet.  Once the layoutManager
</span>            <span class="ActionScriptComment">// has been updated, the compositionWidth/Height are still NaN
</span>            <span class="ActionScriptComment">// so TLF doesn't think there is anything to compose.  The text 
</span>            <span class="ActionScriptComment">// hasn't changed shape, but the background has.
</span>            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">autoSize</span> <span class="ActionScriptOperator">&amp;&amp;</span> <span class="ActionScriptOperator">!</span><span class="ActionScriptDefault_Text">isNaN</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">lastUnscaledWidth</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">&amp;&amp;</span>
                <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">lastUnscaledWidth</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptDefault_Text">unscaledWidth</span> <span class="ActionScriptOperator">||</span> 
                    <span class="ActionScriptDefault_Text">lastUnscaledHeight</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptDefault_Text">unscaledHeight</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">_textContainerManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">composeState</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptDefault_Text">TextContainerManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">COMPOSE_COMPOSER</span><span class="ActionScriptBracket/Brace">)</span>
                     <span class="ActionScriptDefault_Text">_textContainerManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">getTextFlow</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">flowComposer</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">getControllerAt</span><span class="ActionScriptBracket/Brace">(</span>0<span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">shapesInvalid</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">true</span>;
                <span class="ActionScriptReserved">else</span> <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptOperator">!</span><span class="ActionScriptDefault_Text">_textContainerManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">isDamaged</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>
                    <span class="ActionScriptDefault_Text">_textContainerManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">drawBackgroundAndSetScrollRect</span><span class="ActionScriptBracket/Brace">(</span>0<span class="ActionScriptOperator">,</span>0<span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>
               
            <span class="ActionScriptDefault_Text">_textContainerManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">updateContainer</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptDefault_Text">lastUnscaledWidth</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">unscaledWidth</span>;
            <span class="ActionScriptDefault_Text">lastUnscaledHeight</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">unscaledHeight</span>;
            
            <span class="ActionScriptDefault_Text">inUpdateDLMethod</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">false</span>;
         <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptASDoc">/**
         *  @private
         *  This is called by the layout manager the first time this
         *  component is measured, or later if its size changes. This
         *  is not always called before updateDisplayList().  For example,
         *  for recycled item renderers this is not called if the measured
         *  size doesn't change.
         * 
         *  width and height are NaN unless there are constraints on them.
         */</span>
        <span class="ActionScriptReserved">override</span> <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">setLayoutBoundsSize</span><span class="ActionScriptBracket/Brace">(</span>
                                    <span class="ActionScriptDefault_Text">width</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">height</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptOperator">,</span>
                                    <span class="ActionScriptDefault_Text">postLayoutTransform</span>:<span class="ActionScriptDefault_Text">Boolean</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">true</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptComment">//trace("setLayoutBoundsSize", width, height);
</span>            
            <span class="ActionScriptComment">// Save these so when we are auto-sizing we know which dimensions
</span>            <span class="ActionScriptComment">// are constrained.  Without this it is not possible to differentiate 
</span>            <span class="ActionScriptComment">// between a measured width/height that is the same as the
</span>            <span class="ActionScriptComment">// constrained width/height to know whether that dimension can
</span>            <span class="ActionScriptComment">// be sized or must be fixed at the constrained value.                
</span>            <span class="ActionScriptDefault_Text">heightConstraint</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">height</span>;

            <span class="ActionScriptReserved">super</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">setLayoutBoundsSize</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">width</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">height</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">postLayoutTransform</span><span class="ActionScriptBracket/Brace">)</span>;

            <span class="ActionScriptComment">// Did we already constrain the width?
</span>            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">widthConstraint</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptDefault_Text">width</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptReserved">return</span>;
            
            <span class="ActionScriptComment">// No reflow for explicit lineBreak
</span>            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">getStyle</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"lineBreak"</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptString">"explicit"</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptReserved">return</span>;
            
            <span class="ActionScriptComment">// If we don't measure.
</span>            <span class="ActionScriptComment">// Call super so we don't call the override
</span>            <span class="ActionScriptComment">// and set autoSize to false;
</span>            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">super</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">canSkipMeasurement</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptReserved">return</span>;
            
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptOperator">!</span><span class="ActionScriptDefault_Text">isNaN</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">explicitHeight</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptReserved">return</span>;
            
            <span class="ActionScriptComment">// We support reflow only in the case of constrained width and
</span>            <span class="ActionScriptComment">// unconstrained height. Note that we compare with measuredWidth,
</span>            <span class="ActionScriptComment">// as for example the RichEditableText can be
</span>            <span class="ActionScriptComment">// constrained by the layout with "left" and "right", but the
</span>            <span class="ActionScriptComment">// container width itself may not be constrained and it would depend
</span>            <span class="ActionScriptComment">// on the element's measuredWidth.
</span>            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">constrainedWidth</span>:<span class="ActionScriptDefault_Text">Boolean</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptOperator">!</span><span class="ActionScriptDefault_Text">isNaN</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">width</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">&amp;&amp;</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">width</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptDefault_Text">measuredWidth</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">&amp;&amp;</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">width</span> <span class="ActionScriptOperator">!=</span> 0<span class="ActionScriptBracket/Brace">)</span>; 
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptOperator">!</span><span class="ActionScriptDefault_Text">constrainedWidth</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptReserved">return</span>;
            
            <span class="ActionScriptComment">// We support reflow only when we don't have a transform.
</span>            <span class="ActionScriptComment">// We could add support for scale, but not skew or rotation.
</span>            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">postLayoutTransform</span> <span class="ActionScriptOperator">&amp;&amp;</span> <span class="ActionScriptDefault_Text">hasComplexLayoutMatrix</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptReserved">return</span>;
            
            <span class="ActionScriptDefault_Text">widthConstraint</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">width</span>;

            <span class="ActionScriptDefault_Text">invalidateSize</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptASDoc">/**
         *  @inheritDoc
         *  
         *  @langversion 3.0
         *  @playerversion Flash 10
         *  @playerversion AIR 1.5
         *  @productversion Flex 4
         */</span>
        <span class="ActionScriptReserved">override</span> <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">stylesInitialized</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">super</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">stylesInitialized</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptDefault_Text">ascent</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">NaN</span>;
            <span class="ActionScriptDefault_Text">descent</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">NaN</span>;
            
            <span class="ActionScriptDefault_Text">hostFormatChanged</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">true</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptASDoc">/**
         *  @inheritDoc
         *  
         *  @langversion 3.0
         *  @playerversion Flash 10
         *  @playerversion AIR 1.5
         *  @productversion Flex 4
         */</span>
        <span class="ActionScriptReserved">override</span> <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">styleChanged</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">styleProp</span>:<span class="ActionScriptDefault_Text">String</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">super</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">styleChanged</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">styleProp</span><span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptComment">// If null or "styleName" is passed it indicates that
</span>            <span class="ActionScriptComment">// multiple styles may have changed.  Otherwise it is a single style
</span>            <span class="ActionScriptComment">// so mark whether it is the selectionFormat that changed or the
</span>            <span class="ActionScriptComment">// hostFormat that changed.
</span>            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">styleProp</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptReserved">null</span> <span class="ActionScriptOperator">||</span> <span class="ActionScriptDefault_Text">styleProp</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptString">"styleName"</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">hostFormatChanged</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">true</span>;
                <span class="ActionScriptDefault_Text">selectionFormatsChanged</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">true</span>;
                <span class="ActionScriptDefault_Text">ascent</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">NaN</span>;
                <span class="ActionScriptDefault_Text">descent</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">NaN</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptReserved">else</span> <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">styleProp</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptString">"focusedTextSelectionColor"</span> <span class="ActionScriptOperator">||</span> 
                <span class="ActionScriptDefault_Text">styleProp</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptString">"unfocusedTextSelectionColor"</span> <span class="ActionScriptOperator">||</span>
                <span class="ActionScriptDefault_Text">styleProp</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptString">"inactiveTextSelectionColor"</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">selectionFormatsChanged</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">true</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptReserved">else</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">hostFormatChanged</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">true</span>;
                
                <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">styleProp</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">indexOf</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"font"</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">==</span> 0 <span class="ActionScriptOperator">||</span> <span class="ActionScriptDefault_Text">styleProp</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptString">"cffHinting"</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptComment">// Regenerate font swfContext and metrics as well.
</span>                    <span class="ActionScriptDefault_Text">ascent</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">NaN</span>;
                    <span class="ActionScriptDefault_Text">descent</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">NaN</span>;
                <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptBracket/Brace">}</span>
            
            <span class="ActionScriptComment">// Need to create new format(s).
</span>            <span class="ActionScriptDefault_Text">invalidateProperties</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptASDoc">/**
         *  @private
         */</span>
        <span class="ActionScriptReserved">override</span> <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">setFocus</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptComment">// We are about to set focus on this component.  If it is due to
</span>            <span class="ActionScriptComment">// a programmatic focus change we have to programatically do what the
</span>            <span class="ActionScriptComment">// mouseOverHandler and the mouseDownHandler do so that the user can 
</span>            <span class="ActionScriptComment">// type in this component without using the mouse first.  We need to
</span>            <span class="ActionScriptComment">// put a textFlow with a composer in place.
</span>            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">editingMode</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptDefault_Text">EditingMode</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">READ_ONLY</span> <span class="ActionScriptOperator">&amp;&amp;</span>
                <span class="ActionScriptDefault_Text">_textContainerManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">composeState</span> <span class="ActionScriptOperator">!=</span> 
                <span class="ActionScriptDefault_Text">TextContainerManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">COMPOSE_COMPOSER</span><span class="ActionScriptBracket/Brace">)</span>   
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">_textContainerManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">beginInteraction</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">_textContainerManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">endInteraction</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            
            <span class="ActionScriptReserved">super</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">setFocus</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptASDoc">/**
         *  @private
         */</span>
        <span class="ActionScriptReserved">override</span> <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">drawFocus</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">isFocused</span>:<span class="ActionScriptDefault_Text">Boolean</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">isFocused</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptComment">// For some composite components, the focused object may not
</span>                <span class="ActionScriptComment">// be "this". If so, we don't want to draw the focus.  This
</span>                <span class="ActionScriptComment">// replaces the parentDrawsFocus variable used in halo.
</span>                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">fm</span>:<span class="ActionScriptDefault_Text">IFocusManager</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">focusManager</span>;
                <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">fm</span> <span class="ActionScriptOperator">&amp;&amp;</span> <span class="ActionScriptDefault_Text">fm</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">getFocus</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptReserved">this</span><span class="ActionScriptBracket/Brace">)</span>
                    <span class="ActionScriptReserved">return</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            
            <span class="ActionScriptReserved">super</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">drawFocus</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">isFocused</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptComment">//--------------------------------------------------------------------------
</span>        <span class="ActionScriptComment">//
</span>        <span class="ActionScriptComment">//  Methods: IViewport
</span>        <span class="ActionScriptComment">//
</span>        <span class="ActionScriptComment">//--------------------------------------------------------------------------
</span>        
        <span class="ActionScriptComment">//----------------------------------
</span>        <span class="ActionScriptComment">//  horizontalScrollPositionDelta
</span>        <span class="ActionScriptComment">//----------------------------------
</span>        
        <span class="ActionScriptASDoc">/**
         *  @inheritDoc
         *  
         *  @langversion 3.0
         *  @playerversion Flash 10
         *  @playerversion AIR 1.5
         *  @productversion Flex 4
         */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">getHorizontalScrollPositionDelta</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">navigationUnit</span>:<span class="ActionScriptDefault_Text">uint</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">Number</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">scrollR</span>:<span class="ActionScriptDefault_Text">Rectangle</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">scrollRect</span>;
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptOperator">!</span><span class="ActionScriptDefault_Text">scrollR</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptReserved">return</span> 0;
            
            <span class="ActionScriptComment">// maxDelta is the horizontalScrollPosition delta required 
</span>            <span class="ActionScriptComment">// to scroll to the RIGHT and minDelta scrolls to LEFT. 
</span>            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">maxDelta</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">contentWidth</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">scrollR</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">right</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">minDelta</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">scrollR</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">left</span>;
            
            <span class="ActionScriptComment">// Scroll by a "character" which is 1 em (matches widthInChars()).
</span>            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">em</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">getStyle</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"fontSize"</span><span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptReserved">switch</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">navigationUnit</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptReserved">case</span> <span class="ActionScriptDefault_Text">NavigationUnit</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">LEFT</span>:
                    <span class="ActionScriptReserved">return</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">scrollR</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">left</span> <span class="ActionScriptOperator">&lt;=</span> 0<span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">?</span> 0 : <span class="ActionScriptDefault_Text">Math</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">max</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">minDelta</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">em</span><span class="ActionScriptBracket/Brace">)</span>;
                    
                <span class="ActionScriptReserved">case</span> <span class="ActionScriptDefault_Text">NavigationUnit</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">RIGHT</span>:
                    <span class="ActionScriptReserved">return</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">scrollR</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">right</span> <span class="ActionScriptOperator">&gt;=</span> <span class="ActionScriptDefault_Text">contentWidth</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">?</span> 0 : <span class="ActionScriptDefault_Text">Math</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">min</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">maxDelta</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">em</span><span class="ActionScriptBracket/Brace">)</span>;
                    
                <span class="ActionScriptReserved">case</span> <span class="ActionScriptDefault_Text">NavigationUnit</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">PAGE_LEFT</span>:
                    <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">Math</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">max</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">minDelta</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">scrollR</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">width</span><span class="ActionScriptBracket/Brace">)</span>;
                    
                <span class="ActionScriptReserved">case</span> <span class="ActionScriptDefault_Text">NavigationUnit</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">PAGE_RIGHT</span>:
                    <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">Math</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">min</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">maxDelta</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">scrollR</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">width</span><span class="ActionScriptBracket/Brace">)</span>;
                    
                <span class="ActionScriptReserved">case</span> <span class="ActionScriptDefault_Text">NavigationUnit</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">HOME</span>: 
                    <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">minDelta</span>;
                    
                <span class="ActionScriptReserved">case</span> <span class="ActionScriptDefault_Text">NavigationUnit</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">END</span>: 
                    <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">maxDelta</span>;
                    
                <span class="ActionScriptReserved">default</span>:
                    <span class="ActionScriptReserved">return</span> 0;
            <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptComment">//----------------------------------
</span>        <span class="ActionScriptComment">//  verticalScrollPositionDelta
</span>        <span class="ActionScriptComment">//----------------------------------
</span>        
        <span class="ActionScriptASDoc">/**
         *  @inheritDoc
         *  
         *  @langversion 3.0
         *  @playerversion Flash 10
         *  @playerversion AIR 1.5
         *  @productversion Flex 4
         */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">getVerticalScrollPositionDelta</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">navigationUnit</span>:<span class="ActionScriptDefault_Text">uint</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">Number</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">scrollR</span>:<span class="ActionScriptDefault_Text">Rectangle</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">scrollRect</span>;
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptOperator">!</span><span class="ActionScriptDefault_Text">scrollR</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptReserved">return</span> 0;
            
            <span class="ActionScriptComment">// maxDelta is the horizontalScrollPosition delta required 
</span>            <span class="ActionScriptComment">// to scroll to the END and minDelta scrolls to HOME. 
</span>            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">maxDelta</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">contentHeight</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">scrollR</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">bottom</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">minDelta</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">scrollR</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">top</span>;
            
            <span class="ActionScriptReserved">switch</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">navigationUnit</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptReserved">case</span> <span class="ActionScriptDefault_Text">NavigationUnit</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">UP</span>:
                    <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">_textContainerManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">getScrollDelta</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptOperator">-</span>1<span class="ActionScriptBracket/Brace">)</span>;
                    
                <span class="ActionScriptReserved">case</span> <span class="ActionScriptDefault_Text">NavigationUnit</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">DOWN</span>:
                    <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">_textContainerManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">getScrollDelta</span><span class="ActionScriptBracket/Brace">(</span>1<span class="ActionScriptBracket/Brace">)</span>;
                    
                <span class="ActionScriptReserved">case</span> <span class="ActionScriptDefault_Text">NavigationUnit</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">PAGE_UP</span>:
                    <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">Math</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">max</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">minDelta</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">scrollR</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">height</span><span class="ActionScriptBracket/Brace">)</span>;
                    
                <span class="ActionScriptReserved">case</span> <span class="ActionScriptDefault_Text">NavigationUnit</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">PAGE_DOWN</span>:
                    <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">Math</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">min</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">maxDelta</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">scrollR</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">height</span><span class="ActionScriptBracket/Brace">)</span>;
                    
                <span class="ActionScriptReserved">case</span> <span class="ActionScriptDefault_Text">NavigationUnit</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">HOME</span>:
                    <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">minDelta</span>;
                    
                <span class="ActionScriptReserved">case</span> <span class="ActionScriptDefault_Text">NavigationUnit</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">END</span>:
                    <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">maxDelta</span>;
                    
                <span class="ActionScriptReserved">default</span>:
                    <span class="ActionScriptReserved">return</span> 0;
            <span class="ActionScriptBracket/Brace">}</span>       
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptComment">//--------------------------------------------------------------------------
</span>        <span class="ActionScriptComment">//
</span>        <span class="ActionScriptComment">//  Methods
</span>        <span class="ActionScriptComment">//
</span>        <span class="ActionScriptComment">//--------------------------------------------------------------------------
</span>        
        <span class="ActionScriptASDoc">/**
         *  Inserts the specified text into the RichEditableText
         *  as if you had typed it.
         *
         *  &lt;p&gt;If a range was selected, the new text replaces the selected text.
         *  If there was an insertion point, the new text is inserted there.&lt;/p&gt;
         *
         *  &lt;p&gt;An insertion point is then set after the new text.
         *  If necessary, the text will scroll to ensure
         *  that the insertion point is visible.&lt;/p&gt;
         *
         *  @param text The text to be inserted.
         *  
         *  @langversion 3.0
         *  @playerversion Flash 10
         *  @playerversion AIR 1.5
         *  @productversion Flex 4
         */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">insertText</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">text</span>:<span class="ActionScriptDefault_Text">String</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>      
            <span class="ActionScriptDefault_Text">handleInsertText</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">text</span><span class="ActionScriptBracket/Brace">)</span>;  
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptASDoc">/**
         *  Appends the specified text to the end of the RichEditableText,
         *  as if you had clicked at the end and typed.
         *
         *  &lt;p&gt;An insertion point is then set after the new text.
         *  If necessary, the text will scroll to ensure
         *  that the insertion point is visible.&lt;/p&gt;
         *
         *  @param text The text to be appended.
         *  
         *  @langversion 3.0
         *  @playerversion Flash 10
         *  @playerversion AIR 1.5
         *  @productversion Flex 4
         */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">appendText</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">text</span>:<span class="ActionScriptDefault_Text">String</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">handleInsertText</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">text</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptReserved">true</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptASDoc">/**
         *  @copy flashx.textLayout.container.ContainerController#scrollToRange() 
         *  
         *  @langversion 3.0
         *  @playerversion Flash 10
         *  @playerversion AIR 1.5
         *  @productversion Flex 4
         */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">scrollToRange</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">anchorPosition</span>:<span class="ActionScriptDefault_Text">int</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">activePosition</span>:<span class="ActionScriptDefault_Text">int</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptComment">// Make sure the properties are commited since the text could change.
</span>            <span class="ActionScriptDefault_Text">validateProperties</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptComment">// Scrolls so that the text position is visible in the container. 
</span>            <span class="ActionScriptDefault_Text">textContainerManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">scrollToRange</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">anchorPosition</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">activePosition</span><span class="ActionScriptBracket/Brace">)</span>;       
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptASDoc">/**
         *  Selects a specified range of characters.
         *
         *  &lt;p&gt;If either position is negative, it will deselect the text range.&lt;/p&gt;
         *
         *  @param anchorPosition The character position specifying the end
         *  of the selection that stays fixed when the selection is extended.
         *
         *  @param activePosition The character position specifying the end
         *  of the selection that moves when the selection is extended.
         *  
         *  @langversion 3.0
         *  @playerversion Flash 10
         *  @playerversion AIR 1.5
         *  @productversion Flex 4
         */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">selectRange</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">anchorPosition</span>:<span class="ActionScriptDefault_Text">int</span><span class="ActionScriptOperator">,</span>
                                    <span class="ActionScriptDefault_Text">activePosition</span>:<span class="ActionScriptDefault_Text">int</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptComment">// Make sure the properties are commited since the text could change.
</span>            <span class="ActionScriptDefault_Text">validateProperties</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">editingMode</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptDefault_Text">EditingMode</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">READ_ONLY</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">selectionState</span>:<span class="ActionScriptDefault_Text">SelectionState</span> <span class="ActionScriptOperator">=</span>
                    <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">SelectionState</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">textFlow</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">anchorPosition</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">activePosition</span><span class="ActionScriptBracket/Brace">)</span>;
                
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">selectionEvent</span>:<span class="ActionScriptDefault_Text">SelectionEvent</span> <span class="ActionScriptOperator">=</span> 
                    <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">SelectionEvent</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">SelectionEvent</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">SELECTION_CHANGE</span><span class="ActionScriptOperator">,</span> 
                        <span class="ActionScriptReserved">false</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptReserved">false</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">selectionState</span><span class="ActionScriptBracket/Brace">)</span>;
                
                <span class="ActionScriptDefault_Text">textContainerManager_selectionChangeHandler</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">selectionEvent</span><span class="ActionScriptBracket/Brace">)</span>;            
            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptReserved">else</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">im</span>:<span class="ActionScriptDefault_Text">ISelectionManager</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">_textContainerManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">beginInteraction</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
                
                <span class="ActionScriptDefault_Text">im</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">selectRange</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">anchorPosition</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">activePosition</span><span class="ActionScriptBracket/Brace">)</span>;        
                
                <span class="ActionScriptComment">// Refresh the selection.  This does not cause a damage event.
</span>                <span class="ActionScriptDefault_Text">im</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">refreshSelection</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
                
                <span class="ActionScriptDefault_Text">_textContainerManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">endInteraction</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            
            <span class="ActionScriptComment">// Remember if the current selection is a range which was set
</span>            <span class="ActionScriptComment">// programatically.
</span>            <span class="ActionScriptDefault_Text">hasProgrammaticSelectionRange</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">anchorPosition</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptDefault_Text">activePosition</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptASDoc">/**
         *  Selects all of the text. This does not include the final paragraph
         *  terminator.
         *  
         *  @langversion 3.0
         *  @playerversion Flash 10
         *  @playerversion AIR 1.5
         *  @productversion Flex 4
         */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">selectAll</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">selectRange</span><span class="ActionScriptBracket/Brace">(</span>0<span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">int</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">MAX_VALUE</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>
       
        <span class="ActionScriptASDoc">/**
         *  Returns a TextLayoutFormat object specifying the computed formats
         *  for the specified range of characters.
         *
         *  &lt;p&gt;If a format is not consistently set across the entire range,
         *  its value will be &lt;code&gt;undefined&lt;/code&gt;.&lt;/p&gt;
         *
         *  &lt;p&gt;You can specify a Vector of Strings containing the names of the
         *  formats that you care about; if you don't, all formats
         *  will be computed.&lt;/p&gt;
         *  
         *  &lt;p&gt;If you don't specify a range, the selected range is used.&lt;/p&gt;
         *
         *  @param requestedFormats A Vector of Strings specifying the names
         *  of the requested formats, or &lt;code&gt;null&lt;/code&gt; to request all formats.
         *
         *  @param anchorPosition A character position specifying
         *  the fixed end of the selection.
         *
         *  @param activePosition A character position specifying
         *   the movable end of the selection.
         *
         *  @return A TextLayoutFormat object.
         *  
         *  @langversion 3.0
         *  @playerversion Flash 10
         *  @playerversion AIR 1.5
         *  @productversion Flex 4
         */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">getFormatOfRange</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">requestedFormats</span>:<span class="ActionScriptDefault_Text">Vector</span><span class="ActionScriptBracket/Brace">.&lt;</span><span class="ActionScriptDefault_Text">String</span><span class="ActionScriptBracket/Brace">&gt;</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">null</span><span class="ActionScriptOperator">,</span>
                                         <span class="ActionScriptDefault_Text">anchorPosition</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> -1<span class="ActionScriptOperator">,</span>
                                         <span class="ActionScriptDefault_Text">activePosition</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> -1<span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">TextLayoutFormat</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">format</span>:<span class="ActionScriptDefault_Text">TextLayoutFormat</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">TextLayoutFormat</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptComment">// Make sure all properties are committed.
</span>            <span class="ActionScriptDefault_Text">validateProperties</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptComment">// This internal TLF object maps the names of format properties
</span>            <span class="ActionScriptComment">// to Property instances.
</span>            <span class="ActionScriptComment">// Each Property instance has a category property which tells
</span>            <span class="ActionScriptComment">// whether it is container-, paragraph-, or character-level.
</span>            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">description</span>:<span class="ActionScriptDefault_Text">Object</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">TextLayoutFormat</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">description</span>;
            
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">p</span>:<span class="ActionScriptDefault_Text">String</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">category</span>:<span class="ActionScriptDefault_Text">String</span>;
            
            <span class="ActionScriptComment">// Based on which formats have been requested, determine which
</span>            <span class="ActionScriptComment">// of the getCommonXXXFormat() methods we need to call.
</span>            
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">needContainerFormat</span>:<span class="ActionScriptDefault_Text">Boolean</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">false</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">needParagraphFormat</span>:<span class="ActionScriptDefault_Text">Boolean</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">false</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">needCharacterFormat</span>:<span class="ActionScriptDefault_Text">Boolean</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">false</span>;
            
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptOperator">!</span><span class="ActionScriptDefault_Text">requestedFormats</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">requestedFormats</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Vector</span><span class="ActionScriptBracket/Brace">.&lt;</span><span class="ActionScriptDefault_Text">String</span><span class="ActionScriptBracket/Brace">&gt;</span>;
                <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">p</span> <span class="ActionScriptReserved">in</span> <span class="ActionScriptDefault_Text">description</span><span class="ActionScriptBracket/Brace">)</span>
                    <span class="ActionScriptDefault_Text">requestedFormats</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">push</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">p</span><span class="ActionScriptBracket/Brace">)</span>;
                
                <span class="ActionScriptDefault_Text">needContainerFormat</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">true</span>;
                <span class="ActionScriptDefault_Text">needParagraphFormat</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">true</span>;
                <span class="ActionScriptDefault_Text">needCharacterFormat</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">true</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptReserved">else</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptReserved">for each</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">p</span> <span class="ActionScriptReserved">in</span> <span class="ActionScriptDefault_Text">requestedFormats</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptOperator">!</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">p</span> <span class="ActionScriptReserved">in</span> <span class="ActionScriptDefault_Text">description</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>
                        <span class="ActionScriptReserved">continue</span>;
                    
                    <span class="ActionScriptDefault_Text">category</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">description</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">p</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">category</span>;
                    
                    <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">category</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptDefault_Text">Category</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">CONTAINER</span><span class="ActionScriptBracket/Brace">)</span>
                        <span class="ActionScriptDefault_Text">needContainerFormat</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">true</span>;
                    <span class="ActionScriptReserved">else</span> <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">category</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptDefault_Text">Category</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">PARAGRAPH</span><span class="ActionScriptBracket/Brace">)</span>
                        <span class="ActionScriptDefault_Text">needParagraphFormat</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">true</span>;
                    <span class="ActionScriptReserved">else</span> <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">category</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptDefault_Text">Category</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">CHARACTER</span><span class="ActionScriptBracket/Brace">)</span>
                        <span class="ActionScriptDefault_Text">needCharacterFormat</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">true</span>;
                <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptBracket/Brace">}</span>
            
            <span class="ActionScriptComment">// Get the common formats.
</span>            
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">containerFormat</span>:<span class="ActionScriptDefault_Text">ITextLayoutFormat</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">paragraphFormat</span>:<span class="ActionScriptDefault_Text">ITextLayoutFormat</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">characterFormat</span>:<span class="ActionScriptDefault_Text">ITextLayoutFormat</span>;
            
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">anchorPosition</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptOperator">-</span>1 <span class="ActionScriptOperator">&amp;&amp;</span> <span class="ActionScriptDefault_Text">activePosition</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptOperator">-</span>1<span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">anchorPosition</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">_selectionAnchorPosition</span>;
                <span class="ActionScriptDefault_Text">activePosition</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">_selectionActivePosition</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">needContainerFormat</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">containerFormat</span> <span class="ActionScriptOperator">=</span> 
                    <span class="ActionScriptDefault_Text">_textContainerManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">getCommonContainerFormat</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">needParagraphFormat</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">paragraphFormat</span> <span class="ActionScriptOperator">=</span> 
                    <span class="ActionScriptDefault_Text">_textContainerManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">getCommonParagraphFormat</span><span class="ActionScriptBracket/Brace">(</span>
                        <span class="ActionScriptDefault_Text">anchorPosition</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">activePosition</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">needCharacterFormat</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">characterFormat</span> <span class="ActionScriptOperator">=</span> 
                    <span class="ActionScriptDefault_Text">_textContainerManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">getCommonCharacterFormat</span><span class="ActionScriptBracket/Brace">(</span>
                        <span class="ActionScriptDefault_Text">anchorPosition</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">activePosition</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            
            <span class="ActionScriptComment">// Extract the requested formats to return.
</span>            <span class="ActionScriptReserved">for each</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">p</span> <span class="ActionScriptReserved">in</span> <span class="ActionScriptDefault_Text">requestedFormats</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptOperator">!</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">p</span> <span class="ActionScriptReserved">in</span> <span class="ActionScriptDefault_Text">description</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>
                    <span class="ActionScriptReserved">continue</span>;
                
                <span class="ActionScriptDefault_Text">category</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">description</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">p</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">category</span>;
                
                <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">category</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptDefault_Text">Category</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">CONTAINER</span> <span class="ActionScriptOperator">&amp;&amp;</span> <span class="ActionScriptDefault_Text">containerFormat</span><span class="ActionScriptBracket/Brace">)</span>
                    <span class="ActionScriptDefault_Text">format</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">p</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">containerFormat</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">p</span><span class="ActionScriptBracket/Brace">]</span>;
                <span class="ActionScriptReserved">else</span> <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">category</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptDefault_Text">Category</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">PARAGRAPH</span> <span class="ActionScriptOperator">&amp;&amp;</span> <span class="ActionScriptDefault_Text">paragraphFormat</span><span class="ActionScriptBracket/Brace">)</span>
                    <span class="ActionScriptDefault_Text">format</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">p</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">paragraphFormat</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">p</span><span class="ActionScriptBracket/Brace">]</span>;
                <span class="ActionScriptReserved">else</span> <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">category</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptDefault_Text">Category</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">CHARACTER</span> <span class="ActionScriptOperator">&amp;&amp;</span> <span class="ActionScriptDefault_Text">characterFormat</span><span class="ActionScriptBracket/Brace">)</span>
                    <span class="ActionScriptDefault_Text">format</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">p</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">characterFormat</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">p</span><span class="ActionScriptBracket/Brace">]</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            
            <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">format</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptASDoc">/**
         *  Applies the specified formats to each element in the specified
         *  range that correspond to the given format.  
         *  It applies the character formats to the text in the specified range
         *  (no change is made if the specified range is a single point). 
         *  It applies the paragraph formats to any paragraphs at least 
         *  partially within the range (or a single paragraph if the range is a 
         *  single point).
         *  It applies the container formats to the container.
         * 
         *  &lt;p&gt;The supported formats are those in TextLayoutFormat.
         *  A value of &lt;code&gt;undefined&lt;/code&gt; does not get applied.
         *  If you don't specify a range, the selected range is used.&lt;/p&gt;
         *
         *  &lt;p&gt;The following example sets the &lt;code&gt;fontSize&lt;/code&gt; and &lt;code&gt;color&lt;/code&gt; of the selection:
         *  &lt;pre&gt;
         *  var textLayoutFormat:TextLayoutFormat = new TextLayoutFormat();
         *  textLayoutFormat.fontSize = 12;
         *  textLayoutFormat.color = 0xFF0000;
         *  myRET.setFormatOfRange(textLayoutFormat);
         *  &lt;/pre&gt;
         *  &lt;/p&gt;
         *  
         *  &lt;p&gt;If you use the results of &lt;code&gt;getFormatOfRange()&lt;/code&gt; to
         *  specify the &lt;code&gt;format&lt;/code&gt;, note that every format in the
         *  &lt;code&gt;TextLayoutFormat&lt;/code&gt; has a
         *  computed value, which will be applied to each element that 
         *  corresponds to the given format.&lt;/p&gt;
         * 
         *  &lt;p&gt;If you would like to specify a format to be applied to all the text
         *  it would be better to use &lt;code&gt;setStyle(format, value)&lt;/code&gt;
         *  on the component itself.&lt;/p&gt;
         * 
         *  &lt;p&gt;The following example sets the &lt;code&gt;fontSize&lt;/code&gt; and &lt;code&gt;color&lt;/code&gt; of all the text:
         *  &lt;pre&gt;
         *  myRET.setStyle("fontSize", 12);
         *  myRET.setStyle("color", 0xFF0000);
         *  &lt;/pre&gt;
         *  &lt;/p&gt;
         * 
         *  @param format The TextLayoutFormat to apply to the selection.
         * 
         *  @param anchorPosition A character position, relative to the beginning of the 
         *  text String, specifying the end of the selection that stays fixed when the 
         *  selection is extended with the arrow keys.
         * 
         *  @param activePosition A character position, relative to the beginning of the 
         *  text String, specifying the end of the selection that moves when the 
         *  selection is extended with the arrow keys. 
         * 
         *  @langversion 3.0
         *  @playerversion Flash 10
         *  @playerversion AIR 1.5
         *  @productversion Flex 4
         */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">setFormatOfRange</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">format</span>:<span class="ActionScriptDefault_Text">TextLayoutFormat</span><span class="ActionScriptOperator">,</span>
                                         <span class="ActionScriptDefault_Text">anchorPosition</span>:<span class="ActionScriptDefault_Text">int</span><span class="ActionScriptOperator">=</span>-1<span class="ActionScriptOperator">,</span>
                                         <span class="ActionScriptDefault_Text">activePosition</span>:<span class="ActionScriptDefault_Text">int</span><span class="ActionScriptOperator">=</span>-1<span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptComment">// Make sure all properties are committed.  The damage handler for the 
</span>            <span class="ActionScriptComment">// applyTextFormat op will cause the remeasure and display update.
</span>            <span class="ActionScriptDefault_Text">validateProperties</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptComment">// Assign each specified attribute to one of three format objects,
</span>            <span class="ActionScriptComment">// depending on whether it is container-, paragraph-,
</span>            <span class="ActionScriptComment">// or character-level. Note that these can remain null.
</span>            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">containerFormat</span>:<span class="ActionScriptDefault_Text">TextLayoutFormat</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">paragraphFormat</span>:<span class="ActionScriptDefault_Text">TextLayoutFormat</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">characterFormat</span>:<span class="ActionScriptDefault_Text">TextLayoutFormat</span>;
            
            <span class="ActionScriptComment">// This internal TLF object maps the names of format properties
</span>            <span class="ActionScriptComment">// to Property instances.
</span>            <span class="ActionScriptComment">// Each Property instance has a category property which tells
</span>            <span class="ActionScriptComment">// whether it is container-, paragraph-, or character-level.
</span>            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">description</span>:<span class="ActionScriptDefault_Text">Object</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">TextLayoutFormat</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">description</span>;
            
            <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">p</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptReserved">in</span> <span class="ActionScriptDefault_Text">description</span><span class="ActionScriptBracket/Brace">)</span> 
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">format</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">p</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">===</span> <span class="ActionScriptDefault_Text">undefined</span><span class="ActionScriptBracket/Brace">)</span>
                    <span class="ActionScriptReserved">continue</span>;
                
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">category</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">description</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">p</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">category</span>;
                
                <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">category</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptDefault_Text">Category</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">CONTAINER</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptOperator">!</span><span class="ActionScriptDefault_Text">containerFormat</span><span class="ActionScriptBracket/Brace">)</span>
                        <span class="ActionScriptDefault_Text">containerFormat</span> <span class="ActionScriptOperator">=</span>  <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">TextLayoutFormat</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptDefault_Text">containerFormat</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">p</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">format</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">p</span><span class="ActionScriptBracket/Brace">]</span>;
                <span class="ActionScriptBracket/Brace">}</span>
                <span class="ActionScriptReserved">else</span> <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">category</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptDefault_Text">Category</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">PARAGRAPH</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptOperator">!</span><span class="ActionScriptDefault_Text">paragraphFormat</span><span class="ActionScriptBracket/Brace">)</span>
                        <span class="ActionScriptDefault_Text">paragraphFormat</span> <span class="ActionScriptOperator">=</span>  <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">TextLayoutFormat</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptDefault_Text">paragraphFormat</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">p</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">format</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">p</span><span class="ActionScriptBracket/Brace">]</span>;
                <span class="ActionScriptBracket/Brace">}</span>
                <span class="ActionScriptReserved">else</span> <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">category</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptDefault_Text">Category</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">CHARACTER</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptOperator">!</span><span class="ActionScriptDefault_Text">characterFormat</span><span class="ActionScriptBracket/Brace">)</span>
                        <span class="ActionScriptDefault_Text">characterFormat</span> <span class="ActionScriptOperator">=</span>  <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">TextLayoutFormat</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptDefault_Text">characterFormat</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">p</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">format</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">p</span><span class="ActionScriptBracket/Brace">]</span>;
                <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptBracket/Brace">}</span>
            
            <span class="ActionScriptComment">// If the selection isn't specified, use the current one.
</span>            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">anchorPosition</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptOperator">-</span>1 <span class="ActionScriptOperator">&amp;&amp;</span> <span class="ActionScriptDefault_Text">activePosition</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptOperator">-</span>1<span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">anchorPosition</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">_selectionAnchorPosition</span>;
                <span class="ActionScriptDefault_Text">activePosition</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">_selectionActivePosition</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            
            <span class="ActionScriptComment">// Apply the three format objects to the current selection if
</span>            <span class="ActionScriptComment">// selectionState is null, else the specified selection.
</span>            <span class="ActionScriptDefault_Text">_textContainerManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">applyFormatOperation</span><span class="ActionScriptBracket/Brace">(</span>
                <span class="ActionScriptDefault_Text">characterFormat</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">paragraphFormat</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">containerFormat</span><span class="ActionScriptOperator">,</span> 
                <span class="ActionScriptDefault_Text">anchorPosition</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">activePosition</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptASDoc">/**
         *  @private
         */</span>
        <span class="ActionScriptDefault_Text">mx_internal</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">createTextContainerManager</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">RichEditableTextContainerManager</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">return</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">RichEditableTextContainerManager</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">this</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptASDoc">/**
         *  @private
         */</span>
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">updateStylesIfChanged</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">hostFormatChanged</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptComment">// Side-effect is it marks the text as damaged.
</span>                <span class="ActionScriptDefault_Text">_textContainerManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">hostFormat</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">CSSTextLayoutFormat</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">this</span><span class="ActionScriptBracket/Brace">)</span>;
                
                <span class="ActionScriptDefault_Text">hostFormatChanged</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">false</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">isNaN</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">ascent</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">||</span> <span class="ActionScriptDefault_Text">isNaN</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">descent</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptComment">// If the CSS styles for this component specify an embedded font,
</span>                <span class="ActionScriptComment">// embeddedFontContext will be set to the module factory that
</span>                <span class="ActionScriptComment">// should create TextLines (since they must be created in the
</span>                <span class="ActionScriptComment">// SWF where the embedded font is.)
</span>                <span class="ActionScriptComment">// Otherwise, this will be null.
</span>                <span class="ActionScriptDefault_Text">embeddedFontContext</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">getEmbeddedFontContext</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
                
                <span class="ActionScriptDefault_Text">_textContainerManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">swfContext</span> <span class="ActionScriptOperator">=</span>
                    <span class="ActionScriptDefault_Text">ISWFContext</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">embeddedFontContext</span><span class="ActionScriptBracket/Brace">)</span>;                       
                
                <span class="ActionScriptComment">// Note: CSSTextLayoutFormat has special processing
</span>                <span class="ActionScriptComment">// for the fontLookup style. If it is "auto",
</span>                <span class="ActionScriptComment">// the fontLookup format is set to either
</span>                <span class="ActionScriptComment">// "device" or "embedded" depending on whether
</span>                <span class="ActionScriptComment">// embeddedFontContext is null or non-null.
</span>                
                <span class="ActionScriptComment">// Recalcuate the ascent and descent.
</span>                <span class="ActionScriptDefault_Text">calculateFontMetrics</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;    
            <span class="ActionScriptBracket/Brace">}</span>
            
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">selectionFormatsChanged</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">_textContainerManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">invalidateSelectionFormats</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
                
                <span class="ActionScriptDefault_Text">selectionFormatsChanged</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">false</span>;
            <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptASDoc">/**
         *  @private
         *  Uses the component's CSS styles to determine the module factory
         *  that should creates its TextLines.
         */</span>
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">getEmbeddedFontContext</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">IFlexModuleFactory</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">fontContext</span>:<span class="ActionScriptDefault_Text">IFlexModuleFactory</span>;
            
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">fontLookup</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">getStyle</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"fontLookup"</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">fontLookup</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptDefault_Text">FontLookup</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">DEVICE</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">font</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">getStyle</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"fontFamily"</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">bold</span>:<span class="ActionScriptDefault_Text">Boolean</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">getStyle</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"fontWeight"</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptString">"bold"</span>;
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">italic</span>:<span class="ActionScriptDefault_Text">Boolean</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">getStyle</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"fontStyle"</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptString">"italic"</span>;
                
                <span class="ActionScriptDefault_Text">fontContext</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">getFontContext</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">font</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">bold</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">italic</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptReserved">true</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            
            <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">fontContext</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptASDoc">/**
         *  @private
         *  Return true if there is a width and height to use for the measure.
         */</span>
        <span class="ActionScriptDefault_Text">mx_internal</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">isMeasureFixed</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">Boolean</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptComment">// This can be called from RET EditManager when hostFormat is null 
</span>            <span class="ActionScriptComment">// because a style changed and commitProperties hasn't run yet.
</span>            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptOperator">!</span><span class="ActionScriptDefault_Text">_textContainerManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">hostFormat</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptDefault_Text">updateStylesIfChanged</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;            
            
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">_textContainerManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">hostFormat</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">blockProgression</span> <span class="ActionScriptOperator">!=</span> 
                <span class="ActionScriptDefault_Text">BlockProgression</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">TB</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptReserved">return</span> <span class="ActionScriptReserved">true</span>;
            <span class="ActionScriptBracket/Brace">}</span>

            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">typicalText</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptReserved">null</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptReserved">return</span> <span class="ActionScriptReserved">true</span>;
            
            <span class="ActionScriptComment">// Is there some sort of width and some sort of height?
</span>            <span class="ActionScriptReserved">return</span>  <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptOperator">!</span><span class="ActionScriptDefault_Text">isNaN</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">explicitWidth</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">||</span> <span class="ActionScriptOperator">!</span><span class="ActionScriptDefault_Text">isNaN</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">_widthInChars</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">||</span>
                <span class="ActionScriptOperator">!</span><span class="ActionScriptDefault_Text">isNaN</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">widthConstraint</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">&amp;&amp;</span>
                    <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptOperator">!</span><span class="ActionScriptDefault_Text">isNaN</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">explicitHeight</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">||</span> <span class="ActionScriptOperator">!</span><span class="ActionScriptDefault_Text">isNaN</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">_heightInLines</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">||</span>
                        <span class="ActionScriptOperator">!</span><span class="ActionScriptDefault_Text">isNaN</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">heightConstraint</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptASDoc">/**
         *  @private
         *  Returns the bounds of the measured text.  The initial composeWidth may
         *  be adjusted for minWidth or maxWidth.  The value used for the compose
         *  is in _textContainerManager.compositionWidth.
         */</span>
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">measureTextSize</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">composeWidth</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptOperator">,</span> 
                                         <span class="ActionScriptDefault_Text">composeHeight</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">NaN</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">Rectangle</span>
        <span class="ActionScriptBracket/Brace">{</span>   
            <span class="ActionScriptComment">// Adjust for explicit min/maxWidth so the measurement is accurate.
</span>            <span class="ActionScriptComment">// If no explicitWidth or widthInChars
</span>            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">isNaN</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">explicitWidth</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">&amp;&amp;</span> <span class="ActionScriptDefault_Text">isNaN</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">widthInChars</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptComment">// then if there is an explicit minWidth and
</span>                <span class="ActionScriptComment">// a specified composeWidth and the composeWidth
</span>                <span class="ActionScriptComment">// is less than the minWidth, use the minWidth
</span>                <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptOperator">!</span><span class="ActionScriptDefault_Text">isNaN</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">explicitMinWidth</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">&amp;&amp;</span>
                    <span class="ActionScriptOperator">!</span><span class="ActionScriptDefault_Text">isNaN</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">composeWidth</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">&amp;&amp;</span> <span class="ActionScriptDefault_Text">composeWidth</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">minWidth</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptDefault_Text">composeWidth</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">minWidth</span>;
                <span class="ActionScriptBracket/Brace">}</span>
                <span class="ActionScriptComment">// if composeWidth is NaN, just compose and see what happens
</span>                <span class="ActionScriptComment">// and fix up the measurements afterwards.  See final check
</span>                <span class="ActionScriptComment">// at the end of the method
</span>                
                <span class="ActionScriptComment">// On the other hand, if there is an explicit maxWidth and
</span>                <span class="ActionScriptComment">// no specified composeWidth then use maxWidth, 
</span>                <span class="ActionScriptComment">// or if there is a a specified composeWidth 
</span>                <span class="ActionScriptComment">// and the composeWidth is greater than maxWidth, use the maxWidth.
</span>                <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptOperator">!</span><span class="ActionScriptDefault_Text">isNaN</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">explicitMaxWidth</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">&amp;&amp;</span>
                    <span class="ActionScriptDefault_Text">isNaN</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">composeWidth</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">||</span> 
                    <span class="ActionScriptDefault_Text">composeWidth</span> <span class="ActionScriptOperator">&gt;</span> <span class="ActionScriptDefault_Text">maxWidth</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptDefault_Text">composeWidth</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">maxWidth</span>;
                <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptBracket/Brace">}</span>
            
            <span class="ActionScriptComment">// If the width is NaN it can grow up to TextLine.MAX_LINE_WIDTH wide.
</span>            <span class="ActionScriptComment">// If the height is NaN it can grow to allow all the text to fit.
</span>            <span class="ActionScriptDefault_Text">_textContainerManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">compositionWidth</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">composeWidth</span>;
            <span class="ActionScriptDefault_Text">_textContainerManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">compositionHeight</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">composeHeight</span>;
            
            <span class="ActionScriptComment">// If scrolling, always compose with the composer so we get consistent
</span>            <span class="ActionScriptComment">// measurements.  The factory and the composer produce slightly 
</span>            <span class="ActionScriptComment">// different results which can confuse the scroller.  If there isn't a 
</span>            <span class="ActionScriptComment">// composer, this calls updateContainer so do it here now that the 
</span>            <span class="ActionScriptComment">// composition sizes are set so the results can be used.
</span>            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">clipAndEnableScrolling</span> <span class="ActionScriptOperator">&amp;&amp;</span> 
                <span class="ActionScriptDefault_Text">_textContainerManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">composeState</span> <span class="ActionScriptOperator">!=</span> 
                <span class="ActionScriptDefault_Text">TextContainerManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">COMPOSE_COMPOSER</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">_textContainerManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">convertToTextFlowWithComposer</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>
                        
            <span class="ActionScriptComment">// Compose only.  The display should not be updated.
</span>            <span class="ActionScriptDefault_Text">_textContainerManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">compose</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptComment">// Adjust width and height for text alignment.
</span>            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">bounds</span>:<span class="ActionScriptDefault_Text">Rectangle</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">_textContainerManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">getContentBounds</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptComment">// If it's an empty text flow, there is one line with one
</span>            <span class="ActionScriptComment">// character so the height is good for the line but we
</span>            <span class="ActionScriptComment">// need to give it some width other than optional padding.
</span>            
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">_textContainerManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">getText</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">length</span> <span class="ActionScriptOperator">==</span> 0<span class="ActionScriptBracket/Brace">)</span> 
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptComment">// Empty text flow.  One Em wide so there
</span>                <span class="ActionScriptComment">// is a place to put the insertion cursor.
</span>                <span class="ActionScriptDefault_Text">bounds</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">width</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">bounds</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">width</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">getStyle</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"fontSize"</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            
            <span class="ActionScriptComment">//trace("measureTextSize", composeWidth, "-&gt;", bounds.width, composeHeight, "-&gt;", bounds.height);
</span>            
            <span class="ActionScriptComment">// one final check:  If there is no explicitWidth...
</span>            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">isNaN</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">explicitWidth</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">&amp;&amp;</span> <span class="ActionScriptDefault_Text">isNaN</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">widthInChars</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptComment">// but there is a minWidth, and no specified composeWidth
</span>                <span class="ActionScriptComment">// and we measure out to be less than the minWidth
</span>                <span class="ActionScriptComment">// report the minWidth anyway.
</span>                <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptOperator">!</span><span class="ActionScriptDefault_Text">isNaN</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">explicitMinWidth</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">&amp;&amp;</span>
                    <span class="ActionScriptDefault_Text">isNaN</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">composeWidth</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">&amp;&amp;</span>
                    <span class="ActionScriptDefault_Text">bounds</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">width</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">minWidth</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptDefault_Text">bounds</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">width</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">minWidth</span>;
                <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">bounds</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        
        <span class="ActionScriptASDoc">/**
         *  @private
         *  If auto-sizing text, it may need to be remeasured if it is 
         *  constrained in one dimension by the layout manager.  If it is
         *  constrained in both dimensions there is no need to remeasure.  
         *  Changing one dimension may change the size of the measured text 
         *  and the layout manager needs to know this.
         */</span>
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">remeasureText</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">width</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">height</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">Boolean</span>
        <span class="ActionScriptBracket/Brace">{</span>   
            <span class="ActionScriptComment">// Neither dimensions changed.  If auto-sizing we're still auto-sizing.
</span>            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">width</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptDefault_Text">measuredWidth</span> <span class="ActionScriptOperator">&amp;&amp;</span> <span class="ActionScriptDefault_Text">height</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptDefault_Text">measuredHeight</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptReserved">return</span> <span class="ActionScriptReserved">false</span>;
            
            <span class="ActionScriptComment">// Either constraints are preventing auto-sizing or we need to
</span>            <span class="ActionScriptComment">// remeasure which will reset autoSize.
</span>            <span class="ActionScriptDefault_Text">autoSize</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">false</span>;
            
            <span class="ActionScriptComment">// If no width or height, there is nothing to remeasure since 
</span>            <span class="ActionScriptComment">// there is no room for text.
</span>            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">width</span> <span class="ActionScriptOperator">==</span> 0 <span class="ActionScriptOperator">||</span> <span class="ActionScriptDefault_Text">height</span> <span class="ActionScriptOperator">==</span> 0<span class="ActionScriptBracket/Brace">)</span> 
                <span class="ActionScriptReserved">return</span> <span class="ActionScriptReserved">false</span>;
            
            <span class="ActionScriptComment">// If we're using typical text, no need to remeasure.
</span>            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">typicalText</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptReserved">null</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptReserved">return</span> <span class="ActionScriptReserved">false</span>;
            
            <span class="ActionScriptComment">// No reflow for explicit lineBreak
</span>            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">_textContainerManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">hostFormat</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">lineBreak</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptString">"explicit"</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptReserved">return</span> <span class="ActionScriptReserved">false</span>;
            
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptOperator">!</span><span class="ActionScriptDefault_Text">isNaN</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">widthConstraint</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptComment">// Do we have a constrained width and an explicit height?
</span>                <span class="ActionScriptComment">// If so, the sizes are set so no need to remeasure now.
</span>                <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptOperator">!</span><span class="ActionScriptDefault_Text">isNaN</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">explicitHeight</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">||</span> <span class="ActionScriptOperator">!</span><span class="ActionScriptDefault_Text">isNaN</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">_heightInLines</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">||</span>
                    <span class="ActionScriptOperator">!</span><span class="ActionScriptDefault_Text">isNaN</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">heightConstraint</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptReserved">return</span> <span class="ActionScriptReserved">false</span>;
                <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptBracket/Brace">}</span> 
            
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptOperator">!</span><span class="ActionScriptDefault_Text">isNaN</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">heightConstraint</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>        
                <span class="ActionScriptComment">// Do we have a constrained height and an explicit width?
</span>                <span class="ActionScriptComment">// If so, the sizes are set so no need to remeasure now.
</span>                <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptOperator">!</span><span class="ActionScriptDefault_Text">isNaN</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">explicitWidth</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">||</span> <span class="ActionScriptOperator">!</span><span class="ActionScriptDefault_Text">isNaN</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">_widthInChars</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>
                    <span class="ActionScriptReserved">return</span> <span class="ActionScriptReserved">false</span>;
            <span class="ActionScriptBracket/Brace">}</span>                       
            
            <span class="ActionScriptComment">// Width or height is different than what was measured.  Since we're
</span>            <span class="ActionScriptComment">// auto-sizing, need to remeasure, so the layout manager leaves the
</span>            <span class="ActionScriptComment">// correct amount of space for the component.
</span>            <span class="ActionScriptDefault_Text">invalidateSize</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptComment">// Need to make sure the container is updated after the text is re-composed 
</span>            <span class="ActionScriptComment">// to measure it.
</span>            <span class="ActionScriptDefault_Text">remeasuringText</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">true</span>;
            
            <span class="ActionScriptReserved">return</span> <span class="ActionScriptReserved">true</span>;            
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptASDoc">/**
         *  @private
         *  This method is called when anything affecting the
         *  default font, size, weight, etc. changes.
         *  It calculates the 'ascent', 'descent', and
         *  instance variables, which are used in measure().
         */</span>
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">calculateFontMetrics</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">fontDescription</span>:<span class="ActionScriptDefault_Text">FontDescription</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">FontDescription</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">s</span>:<span class="ActionScriptDefault_Text">String</span>;
            
            <span class="ActionScriptDefault_Text">s</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">getStyle</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"cffHinting"</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">s</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptReserved">null</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptDefault_Text">fontDescription</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">cffHinting</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">s</span>;
            
            <span class="ActionScriptDefault_Text">s</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">getStyle</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"fontFamily"</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">s</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptReserved">null</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptDefault_Text">fontDescription</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">fontName</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">s</span>;
            
            <span class="ActionScriptDefault_Text">s</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">getStyle</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"fontLookup"</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">s</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptReserved">null</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptComment">// FTE understands only "device" and "embeddedCFF"
</span>                <span class="ActionScriptComment">// for fontLookup. But Flex allows this style to be
</span>                <span class="ActionScriptComment">// set to "auto", in which case we automatically
</span>                <span class="ActionScriptComment">// determine it based on whether the CSS styles
</span>                <span class="ActionScriptComment">// specify an embedded font.
</span>                <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">s</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptString">"device"</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptDefault_Text">s</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">TextUtil</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">resolveFontLookup</span><span class="ActionScriptBracket/Brace">(</span>
                        <span class="ActionScriptDefault_Text">_textContainerManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">swfContext</span><span class="ActionScriptOperator">,</span> 
                        <span class="ActionScriptDefault_Text">_textContainerManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">hostFormat</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptBracket/Brace">}</span>
                <span class="ActionScriptDefault_Text">fontDescription</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">fontLookup</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">s</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            
            <span class="ActionScriptDefault_Text">s</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">getStyle</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"fontStyle"</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">s</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptReserved">null</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptDefault_Text">fontDescription</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">fontPosture</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">s</span>;
            
            <span class="ActionScriptDefault_Text">s</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">getStyle</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"fontWeight"</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">s</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptReserved">null</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptDefault_Text">fontDescription</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">fontWeight</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">s</span>;
            
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">elementFormat</span>:<span class="ActionScriptDefault_Text">ElementFormat</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">ElementFormat</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">elementFormat</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">fontDescription</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">fontDescription</span>;
            <span class="ActionScriptDefault_Text">elementFormat</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">fontSize</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">getStyle</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"fontSize"</span><span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">textElement</span>:<span class="ActionScriptDefault_Text">TextElement</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">TextElement</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">textElement</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">elementFormat</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">elementFormat</span>;
            <span class="ActionScriptDefault_Text">textElement</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">text</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptString">"M"</span>;
            
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">textBlock</span>:<span class="ActionScriptDefault_Text">TextBlock</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">TextBlock</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">textBlock</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">content</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">textElement</span>;
            
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">swfContext</span>:<span class="ActionScriptDefault_Text">ISWFContext</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">ISWFContext</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">embeddedFontContext</span><span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">textLine</span>:<span class="ActionScriptDefault_Text">TextLine</span>;
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">swfContext</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">textLine</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">swfContext</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">callInContext</span><span class="ActionScriptBracket/Brace">(</span>
                    <span class="ActionScriptDefault_Text">textBlock</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">createTextLine</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">textBlock</span><span class="ActionScriptOperator">,</span>
                    <span class="ActionScriptBracket/Brace">[</span> <span class="ActionScriptReserved">null</span><span class="ActionScriptOperator">,</span> 1000 <span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptReserved">else</span>
                <span class="ActionScriptDefault_Text">textLine</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">textBlock</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">createTextLine</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">null</span><span class="ActionScriptOperator">,</span> 1000<span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptDefault_Text">ascent</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">textLine</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">ascent</span>;
            <span class="ActionScriptDefault_Text">descent</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">textLine</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">descent</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptASDoc">/**
         *  @private
         */</span>
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">calculateWidthInChars</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">Number</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">em</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">getStyle</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"fontSize"</span><span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">effectiveWidthInChars</span>:<span class="ActionScriptDefault_Text">int</span>;
            
            <span class="ActionScriptComment">// If both height and width are NaN use 10 chars.  Otherwise if only 
</span>            <span class="ActionScriptComment">// width is NaN, use 1.                
</span>            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">isNaN</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">_widthInChars</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptDefault_Text">effectiveWidthInChars</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">isNaN</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">_heightInLines</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">?</span> 10 : 1;
            <span class="ActionScriptReserved">else</span>
                <span class="ActionScriptDefault_Text">effectiveWidthInChars</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">_widthInChars</span>;
            
            <span class="ActionScriptComment">// Without the explicit casts, if padding values are non-zero, the
</span>            <span class="ActionScriptComment">// returned width is a very large number.
</span>            <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">getStyle</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"paddingLeft"</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">+</span>
                <span class="ActionScriptDefault_Text">effectiveWidthInChars</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">em</span> <span class="ActionScriptOperator">+</span>
                <span class="ActionScriptDefault_Text">getStyle</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"paddingRight"</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptASDoc">/**
         *  @private
         *  Calculates the height needed for heightInLines lines using the default
         *  font.
         */</span>
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">calculateHeightInLines</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">Number</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">height</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">getStyle</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"paddingTop"</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">getStyle</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"paddingBottom"</span><span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">_heightInLines</span> <span class="ActionScriptOperator">==</span> 0<span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">height</span>;
            
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">effectiveHeightInLines</span>:<span class="ActionScriptDefault_Text">int</span>;
            
            <span class="ActionScriptComment">// If both height and width are NaN use 10 lines.  Otherwise if 
</span>            <span class="ActionScriptComment">// only height is NaN, use 1.
</span>            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">isNaN</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">_heightInLines</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptDefault_Text">effectiveHeightInLines</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">isNaN</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">_widthInChars</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">?</span> 10 : 1;   
            <span class="ActionScriptReserved">else</span>
                <span class="ActionScriptDefault_Text">effectiveHeightInLines</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">_heightInLines</span>;
            
            <span class="ActionScriptComment">// Position of the baseline of first line in the container.
</span>            <span class="ActionScriptDefault_Text">value</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">getStyle</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"firstBaselineOffset"</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">value</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptDefault_Text">lineHeight</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptDefault_Text">height</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">lineHeight</span>;
            <span class="ActionScriptReserved">else</span> <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">value</span> <span class="ActionScriptReserved">is</span> <span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptDefault_Text">height</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">value</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptReserved">else</span>
                <span class="ActionScriptDefault_Text">height</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">ascent</span>;
            
            <span class="ActionScriptComment">// Distance from baseline to baseline.  Can be +/- number or 
</span>            <span class="ActionScriptComment">// or +/- percent (in form "120%") or "undefined".  
</span>            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">effectiveHeightInLines</span> <span class="ActionScriptOperator">&gt;</span> 1<span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">value</span>:<span class="ActionScriptDefault_Text">Object</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">getStyle</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"lineHeight"</span><span class="ActionScriptBracket/Brace">)</span>;     
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">lineHeight</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span>
                    <span class="ActionScriptDefault_Text">RichEditableText</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">getNumberOrPercentOf</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">value</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">getStyle</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"fontSize"</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>;
                
                <span class="ActionScriptComment">// Default is 120%
</span>                <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">isNaN</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">lineHeight</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>
                    <span class="ActionScriptDefault_Text">lineHeight</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">getStyle</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"fontSize"</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">*</span> 1.2;
                
                <span class="ActionScriptDefault_Text">height</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">effectiveHeightInLines</span> <span class="ActionScriptOperator">-</span> 1<span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">lineHeight</span>;
            <span class="ActionScriptBracket/Brace">}</span>            
            
            <span class="ActionScriptComment">// Add in descent of last line.
</span>            <span class="ActionScriptDefault_Text">height</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">descent</span>;              
            
            <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">height</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptASDoc">/**
         *  @private
         */</span>
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">createTextFlowFromContent</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">content</span>:<span class="ActionScriptDefault_Text">Object</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">TextFlow</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">textFlow</span>:<span class="ActionScriptDefault_Text">TextFlow</span> ;
            
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">content</span> <span class="ActionScriptReserved">is</span> <span class="ActionScriptDefault_Text">TextFlow</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">textFlow</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">content</span> <span class="ActionScriptReserved">as</span> <span class="ActionScriptDefault_Text">TextFlow</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptReserved">else</span> <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">content</span> <span class="ActionScriptReserved">is</span> <span class="ActionScriptDefault_Text">Array</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">textFlow</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">TextFlow</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">textFlow</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">whiteSpaceCollapse</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">getStyle</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"whiteSpaceCollapse"</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">textFlow</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">mxmlChildren</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">content</span> <span class="ActionScriptReserved">as</span> <span class="ActionScriptDefault_Text">Array</span>;
                <span class="ActionScriptDefault_Text">textFlow</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">whiteSpaceCollapse</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">undefined</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptReserved">else</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">textFlow</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">TextFlow</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">textFlow</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">whiteSpaceCollapse</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">getStyle</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"whiteSpaceCollapse"</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">textFlow</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">mxmlChildren</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">[</span> <span class="ActionScriptDefault_Text">content</span> <span class="ActionScriptBracket/Brace">]</span>;
                <span class="ActionScriptDefault_Text">textFlow</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">whiteSpaceCollapse</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">undefined</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            
            <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">textFlow</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptASDoc">/**
         *  @private
         */</span>
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">updateEditingMode</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">newEditingMode</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">EditingMode</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">READ_ONLY</span>;
            
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">enabled</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">_editable</span><span class="ActionScriptBracket/Brace">)</span>
                    <span class="ActionScriptDefault_Text">newEditingMode</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">EditingMode</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">READ_WRITE</span>;
                <span class="ActionScriptReserved">else</span> <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">_selectable</span><span class="ActionScriptBracket/Brace">)</span>
                    <span class="ActionScriptDefault_Text">newEditingMode</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">EditingMode</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">READ_SELECT</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            
            <span class="ActionScriptDefault_Text">editingMode</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">newEditingMode</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptASDoc">/**
         *  @private
         * 
         *  This is used when text is either inserted or appended via the API.
         */</span>
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">handleInsertText</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">newText</span>:<span class="ActionScriptDefault_Text">String</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">isAppend</span>:<span class="ActionScriptDefault_Text">Boolean</span><span class="ActionScriptOperator">=</span><span class="ActionScriptReserved">false</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptComment">// Make sure all properties are committed.  The damage handler for the 
</span>            <span class="ActionScriptComment">// insert will cause the remeasure and display update.
</span>            <span class="ActionScriptDefault_Text">validateProperties</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">isAppend</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptComment">// Set insertion pt to the end of the current text.
</span>                <span class="ActionScriptDefault_Text">_selectionAnchorPosition</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">text</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">length</span>;
                <span class="ActionScriptDefault_Text">_selectionActivePosition</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">_selectionAnchorPosition</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptReserved">else</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptComment">// Insert requires a selection, or it is a noop.
</span>                <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">_selectionAnchorPosition</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptOperator">-</span>1 <span class="ActionScriptOperator">||</span> <span class="ActionScriptDefault_Text">_selectionActivePosition</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptOperator">-</span>1<span class="ActionScriptBracket/Brace">)</span>
                    <span class="ActionScriptReserved">return</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            
            <span class="ActionScriptComment">// This will update the selection after the operation is done.
</span>            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">success</span>:<span class="ActionScriptDefault_Text">Boolean</span> <span class="ActionScriptOperator">=</span>
                <span class="ActionScriptDefault_Text">_textContainerManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">insertTextOperation</span><span class="ActionScriptBracket/Brace">(</span>
                    <span class="ActionScriptDefault_Text">newText</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">_selectionAnchorPosition</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">_selectionActivePosition</span><span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">success</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptDefault_Text">dispatchEvent</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">FlexEvent</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">FlexEvent</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">VALUE_COMMIT</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>;                                   
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptASDoc">/**
         *  @private
         */</span>
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">handlePasteOperation</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">op</span>:<span class="ActionScriptDefault_Text">PasteOperation</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">hasConstraints</span>:<span class="ActionScriptDefault_Text">Boolean</span> <span class="ActionScriptOperator">=</span> 
                <span class="ActionScriptDefault_Text">restrict</span> <span class="ActionScriptOperator">||</span> <span class="ActionScriptDefault_Text">maxChars</span> <span class="ActionScriptOperator">||</span> <span class="ActionScriptDefault_Text">displayAsPassword</span>;
            
            <span class="ActionScriptComment">// If there are no constraints and multiline text is allowed
</span>            <span class="ActionScriptComment">// there is nothing that needs to be done.
</span>            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptOperator">!</span><span class="ActionScriptDefault_Text">hasConstraints</span> <span class="ActionScriptOperator">&amp;&amp;</span> <span class="ActionScriptDefault_Text">multiline</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptReserved">return</span>;
            
            <span class="ActionScriptComment">// Make sure the clipboard has something to paste.
</span>            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">op</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">textScrap</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptReserved">null</span> <span class="ActionScriptOperator">||</span> <span class="ActionScriptDefault_Text">op</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">textScrap</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">textFlow</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptReserved">null</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptReserved">return</span>;
            
            <span class="ActionScriptComment">// If copied/cut from displayAsPassword field the pastedText
</span>            <span class="ActionScriptComment">// is '*' characters but this is correct.
</span>            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">pastedText</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">staticPlainTextExporter</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">export</span><span class="ActionScriptBracket/Brace">(</span>
                <span class="ActionScriptDefault_Text">op</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">textScrap</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">textFlow</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">ConversionType</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">STRING_TYPE</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptReserved">as</span> <span class="ActionScriptDefault_Text">String</span>;
            
            <span class="ActionScriptComment">// If there are no constraints and no newlines there is nothing
</span>            <span class="ActionScriptComment">// more to do.
</span>            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptOperator">!</span><span class="ActionScriptDefault_Text">hasConstraints</span> <span class="ActionScriptOperator">&amp;&amp;</span> <span class="ActionScriptDefault_Text">pastedText</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">indexOf</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"\n"</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptOperator">-</span>1<span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptReserved">return</span>;
            
            <span class="ActionScriptComment">// Save this in case we modify the pasted text.  We need to know
</span>            <span class="ActionScriptComment">// how much text to delete.
</span>            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">textLength</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">pastedText</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">length</span>;
            
            <span class="ActionScriptComment">// Keep _text in sync with the text flow.  If there was a selection
</span>            <span class="ActionScriptComment">// for the paste, delete that text, then insert the pasted
</span>            <span class="ActionScriptComment">// text.
</span>            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">_displayAsPassword</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">_text</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">splice</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">_text</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">op</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">absoluteStart</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">op</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">absoluteEnd</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptString">""</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">_text</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">splice</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">_text</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">op</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">absoluteStart</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">op</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">absoluteStart</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">pastedText</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            
            <span class="ActionScriptComment">// If multiline is false, strip newlines out of pasted text
</span>            <span class="ActionScriptComment">// This will not strip newlines out of displayAsPassword fields
</span>            <span class="ActionScriptComment">// since the text is the passwordChar and newline won't be found.
</span>            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptOperator">!</span><span class="ActionScriptDefault_Text">multiline</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptDefault_Text">pastedText</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">pastedText</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">replace</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">ALL_NEWLINES_REGEXP</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptString">""</span><span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptComment">// We know it's an EditManager or we wouldn't have gotten here.
</span>            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">editManager</span>:<span class="ActionScriptDefault_Text">IEditManager</span> <span class="ActionScriptOperator">=</span> 
                <span class="ActionScriptDefault_Text">EditManager</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">_textContainerManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">beginInteraction</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptComment">// Generate a CHANGING event for the PasteOperation but not for the
</span>            <span class="ActionScriptComment">// DeleteTextOperation or the InsertTextOperation which are also part
</span>            <span class="ActionScriptComment">// of the paste.
</span>            <span class="ActionScriptDefault_Text">dispatchChangeAndChangingEvents</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">false</span>;
            
            <span class="ActionScriptComment">// Replace the same text, the same place where the paste was done.
</span>            <span class="ActionScriptComment">// This will go thru the InsertPasteOperation and do the right
</span>            <span class="ActionScriptComment">// things with restrict, maxChars, displayAsPassword and _text.
</span>            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">selectionState</span>:<span class="ActionScriptDefault_Text">SelectionState</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">SelectionState</span><span class="ActionScriptBracket/Brace">(</span>
                  <span class="ActionScriptDefault_Text">op</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">textFlow</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">op</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">absoluteStart</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">op</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">absoluteStart</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">textLength</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">editManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">insertText</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">pastedText</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">selectionState</span><span class="ActionScriptBracket/Brace">)</span>;        
            
            <span class="ActionScriptComment">// All done with the edit manager.
</span>            <span class="ActionScriptDefault_Text">_textContainerManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">endInteraction</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptDefault_Text">dispatchChangeAndChangingEvents</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">true</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptComment">//--------------------------------------------------------------------------
</span>        <span class="ActionScriptComment">//
</span>        <span class="ActionScriptComment">//  Event handlers
</span>        <span class="ActionScriptComment">//
</span>        <span class="ActionScriptComment">//--------------------------------------------------------------------------
</span>        
        <span class="ActionScriptASDoc">/**
         *  @private
         *  find the right time to listen to the focusmanager
         */</span>
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">addedToStageHandler</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">event</span>:<span class="ActionScriptDefault_Text">Event</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">event</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">target</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptReserved">this</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">removeEventListener</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">Event</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">ADDED_TO_STAGE</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">addedToStageHandler</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">callLater</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">addActivateHandlers</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>    
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptASDoc">/**
         *  @private
         *  add listeners to focusManager
         */</span>
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">addActivateHandlers</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptOperator">!</span><span class="ActionScriptDefault_Text">focusManager</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptReserved">return</span>;
            
            <span class="ActionScriptDefault_Text">focusManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">addEventListener</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">FlexEvent</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">FLEX_WINDOW_ACTIVATE</span><span class="ActionScriptOperator">,</span> 
                <span class="ActionScriptDefault_Text">_textContainerManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">activateHandler</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptReserved">false</span><span class="ActionScriptOperator">,</span> 0<span class="ActionScriptOperator">,</span> <span class="ActionScriptReserved">true</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptDefault_Text">focusManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">addEventListener</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">FlexEvent</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">FLEX_WINDOW_DEACTIVATE</span><span class="ActionScriptOperator">,</span> 
                <span class="ActionScriptDefault_Text">_textContainerManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">deactivateHandler</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptReserved">false</span><span class="ActionScriptOperator">,</span> 0<span class="ActionScriptOperator">,</span> <span class="ActionScriptReserved">true</span><span class="ActionScriptBracket/Brace">)</span>
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptASDoc">/**
         *  @private
         *  Called when a FocusManager is added to an IFocusManagerContainer.
         *  We need to check that it belongs
         *  to us before listening to it.
         *  Because we listen to sandboxroot, you cannot assume the type of
         *  the event.
         */</span>
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">addFocusManagerHandler</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">event</span>:<span class="ActionScriptDefault_Text">Event</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">focusManager</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptDefault_Text">event</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">target</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptString">"focusManager"</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">systemManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">getSandboxRoot</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">removeEventListener</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">FlexEvent</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">ADD_FOCUS_MANAGER</span><span class="ActionScriptOperator">,</span> 
                    <span class="ActionScriptDefault_Text">addFocusManagerHandler</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptReserved">true</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptDefault_Text">addActivateHandlers</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptASDoc">/**
         *  @private
         *  RichEditableTextContainerManager overrides focusInHandler and calls
         *  this before executing its own focusInHandler.
         */</span>
        <span class="ActionScriptDefault_Text">mx_internal</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">focusInHandler</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">event</span>:<span class="ActionScriptDefault_Text">FocusEvent</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptComment">// When TCM is simulating a focusIn event, event will be null.
</span>            <span class="ActionScriptComment">// Ignore these and wait for the actual focus in event.
</span>            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">event</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptReserved">null</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptReserved">return</span>;
            
            <span class="ActionScriptComment">//trace("focusIn handler");
</span>            
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">fm</span>:<span class="ActionScriptDefault_Text">IFocusManager</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">focusManager</span>;
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">fm</span> <span class="ActionScriptOperator">&amp;&amp;</span> <span class="ActionScriptDefault_Text">editingMode</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptDefault_Text">EditingMode</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">READ_WRITE</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptDefault_Text">fm</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">showFocusIndicator</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">true</span>;
            
            <span class="ActionScriptComment">// showFocusIndicator must be set before this is called.
</span>            <span class="ActionScriptReserved">super</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">focusInHandler</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">event</span><span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">editingMode</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptDefault_Text">EditingMode</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">READ_WRITE</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptComment">// If the focusIn was because of a mouseDown event, let TLF
</span>                <span class="ActionScriptComment">// handle the selection.  Otherwise it was because we tabbed in
</span>                <span class="ActionScriptComment">// or we programatically set the focus.
</span>                <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptOperator">!</span><span class="ActionScriptDefault_Text">mouseDown</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">selectionManager</span>:<span class="ActionScriptDefault_Text">ISelectionManager</span> <span class="ActionScriptOperator">=</span> 
                        <span class="ActionScriptDefault_Text">_textContainerManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">beginInteraction</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;       
                    
                    <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">multiline</span><span class="ActionScriptBracket/Brace">)</span>
                    <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptOperator">!</span><span class="ActionScriptDefault_Text">selectionManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">hasSelection</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>
                            <span class="ActionScriptDefault_Text">selectionManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">selectRange</span><span class="ActionScriptBracket/Brace">(</span>0<span class="ActionScriptOperator">,</span> 0<span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptBracket/Brace">}</span> 
                    <span class="ActionScriptReserved">else</span> <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptOperator">!</span><span class="ActionScriptDefault_Text">hasProgrammaticSelectionRange</span><span class="ActionScriptBracket/Brace">)</span>
                    <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptDefault_Text">selectionManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">selectAll</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptBracket/Brace">}</span>
                    
                    <span class="ActionScriptDefault_Text">selectionManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">refreshSelection</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
                    
                    <span class="ActionScriptDefault_Text">_textContainerManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">endInteraction</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;       
                <span class="ActionScriptBracket/Brace">}</span>
                
                <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">_imeMode</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptReserved">null</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptComment">// When IME.conversionMode is unknown it cannot be
</span>                    <span class="ActionScriptComment">// set to anything other than unknown(English)      
</span>                    <span class="ActionScriptReserved">try</span>
                    <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">IME</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">conversionMode</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptDefault_Text">IMEConversionMode</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">UNKNOWN</span><span class="ActionScriptBracket/Brace">)</span>
                        <span class="ActionScriptBracket/Brace">{</span>
                            <span class="ActionScriptDefault_Text">IME</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">conversionMode</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">_imeMode</span>;
                        <span class="ActionScriptBracket/Brace">}</span>
                    <span class="ActionScriptBracket/Brace">}</span>
                    <span class="ActionScriptReserved">catch</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">e</span>:<span class="ActionScriptDefault_Text">Error</span><span class="ActionScriptBracket/Brace">)</span>
                    <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptComment">// on Windows, setting a Japanese IME mode when in
</span>                        <span class="ActionScriptComment">// english throws an error (on Mac it doesn't)
</span>                        <span class="ActionScriptComment">// so ignore errors we get.
</span>                    <span class="ActionScriptBracket/Brace">}</span>
                <span class="ActionScriptBracket/Brace">}</span>            
            <span class="ActionScriptBracket/Brace">}</span>
            
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">focusManager</span> <span class="ActionScriptOperator">&amp;&amp;</span> <span class="ActionScriptDefault_Text">multiline</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptDefault_Text">focusManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">defaultButtonEnabled</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">false</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptASDoc">/**
         *  @private
         *  RichEditableTextContainerManager overrides focusOutHandler and calls
         *  this before executing its own focusOutHandler.
         */</span>
        <span class="ActionScriptDefault_Text">mx_internal</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">focusOutHandler</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">event</span>:<span class="ActionScriptDefault_Text">FocusEvent</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptComment">//trace("focusOut handler");
</span>            
            <span class="ActionScriptReserved">super</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">focusOutHandler</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">event</span><span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptComment">// By default, we clear the undo history when a RichEditableText loses 
</span>            <span class="ActionScriptComment">// focus.
</span>            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">clearUndoOnFocusOut</span> <span class="ActionScriptOperator">&amp;&amp;</span> <span class="ActionScriptDefault_Text">undoManager</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptDefault_Text">undoManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">clearAll</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">focusManager</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptDefault_Text">focusManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">defaultButtonEnabled</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">true</span>;
            
            
            <span class="ActionScriptDefault_Text">dispatchEvent</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">FlexEvent</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">FlexEvent</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">VALUE_COMMIT</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>;                           
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptASDoc">/**
         *  @private
         *  RichEditableTextContainerManager overrides keyDownHandler and calls
         *  this before executing its own keyDownHandler.
         */</span> 
        <span class="ActionScriptDefault_Text">mx_internal</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">keyDownHandler</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">event</span>:<span class="ActionScriptDefault_Text">KeyboardEvent</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">editingMode</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptDefault_Text">EditingMode</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">READ_WRITE</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptReserved">return</span>;
            
            <span class="ActionScriptComment">// Handle the ENTER key here, if multiline text is not allowed or
</span>            <span class="ActionScriptComment">// if there isn't enough room for more characters to be added.
</span>            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">event</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">keyCode</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptDefault_Text">Keyboard</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">ENTER</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>        
                <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptOperator">!</span><span class="ActionScriptDefault_Text">multiline</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptDefault_Text">dispatchEvent</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">FlexEvent</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">FlexEvent</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">ENTER</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptDefault_Text">event</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">preventDefault</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptReserved">return</span>;
                <span class="ActionScriptBracket/Brace">}</span>
                
                <span class="ActionScriptComment">// Multiline.  Make sure there is room before acting on it.
</span>                <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">_maxChars</span> <span class="ActionScriptOperator">!=</span> 0 <span class="ActionScriptOperator">&amp;&amp;</span> <span class="ActionScriptDefault_Text">text</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">length</span> <span class="ActionScriptOperator">&gt;=</span> <span class="ActionScriptDefault_Text">_maxChars</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptDefault_Text">event</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">preventDefault</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptReserved">return</span>;
                <span class="ActionScriptBracket/Brace">}</span>                

                <span class="ActionScriptComment">// Let the TLF EditManager handle the ENTER key.  If editing
</span>                <span class="ActionScriptComment">// a list, depending on the position, it will either add a new
</span>                <span class="ActionScriptComment">// list item or close off the list.  Otherwise it will split
</span>                <span class="ActionScriptComment">// the paragraph.
</span>            <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptASDoc">/**
         *  @private
         */</span>
        <span class="ActionScriptDefault_Text">mx_internal</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">mouseDownHandler</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">event</span>:<span class="ActionScriptDefault_Text">MouseEvent</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">mouseDown</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">true</span>;
            
            <span class="ActionScriptComment">// Need to get called even if mouse events are dispatched
</span>            <span class="ActionScriptComment">// outside of this component.  For example, when the user does
</span>            <span class="ActionScriptComment">// a mouse down in RET, drags the mouse outside of the 
</span>            <span class="ActionScriptComment">/// component, and then releases the mouse.
</span>            <span class="ActionScriptDefault_Text">systemManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">getSandboxRoot</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">addEventListener</span><span class="ActionScriptBracket/Brace">(</span>
                <span class="ActionScriptDefault_Text">MouseEvent</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">MOUSE_UP</span><span class="ActionScriptOperator">,</span> 
                <span class="ActionScriptDefault_Text">systemManager_mouseUpHandler</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptReserved">true</span> <span class="ActionScriptComment">/*useCapture*/</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptASDoc">/**
         *  @private
         */</span>
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">systemManager_mouseUpHandler</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">event</span>:<span class="ActionScriptDefault_Text">MouseEvent</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">mouseDown</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">false</span>;
            
            <span class="ActionScriptDefault_Text">systemManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">getSandboxRoot</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">removeEventListener</span><span class="ActionScriptBracket/Brace">(</span>
                <span class="ActionScriptDefault_Text">MouseEvent</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">MOUSE_UP</span><span class="ActionScriptOperator">,</span> 
                         <span class="ActionScriptDefault_Text">systemManager_mouseUpHandler</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptReserved">true</span> <span class="ActionScriptComment">/*useCapture*/</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptASDoc">/**
         *  @private
         *  call a TLF method so we don't leak
         */</span>
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">removedFromStageHandler</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">event</span>:<span class="ActionScriptDefault_Text">Event</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">event</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">target</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptReserved">this</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">TextContainerManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">releaseReferences</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>    
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptASDoc">/**
         *  @private
         *  If the textFlow hasn't changed the generation remains the same.
         *  Changing the composition width and/or height does not change the
         *  generation.  The bounds can change as a result of different
         *  composition dimensions or as a result of more of the text flow
         *  being composed.  Only as much of the text flow as is displayed is
         *  composed.  If not all of the text flow is composed, its content height
         *  is estimated.  Until the entire text flow is composed its content
         *  height can increase or decrease while scrolling thru the flow.  
         *
         *  If the following conditions are met with the contentWidth and the
         *  contentHeight reported to the scroller, the scroller can avoid the 
         *  situation we've seen where it tries to add a scroll bar which causes the 
         *  text to reflow, which changes the content bounds, which causes the 
         *  scroller to react, and potentially loop indefinately.
         * 
         *       if width is reduced the height should grow or stay the same
         *       if height is reduced the width should grow or stay the same
         *       if width and height are reduced then either the width or height
         *           should grow or stay the same.
         *
         *  toFit
         *      width       height
         *      
         *      smaller     smaller     height pinned to old height
         *      smaller     larger      ok
         *      larger      larger      ok
         *      larger      smaller     ok
         *       
         *  explicit
         *      width       height
         *      smaller     smaller     width pinned to old width
         *      smaller     larger      width pinned to old width
         *      larger      larger      ok
         *      larger      smaller     ok
         */</span>
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">adjustContentBoundsForScroller</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">bounds</span>:<span class="ActionScriptDefault_Text">Rectangle</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>   
            <span class="ActionScriptComment">// Already reported bounds at least once for this generation of
</span>            <span class="ActionScriptComment">// the text flow so we have to be careful to mantain consistency
</span>            <span class="ActionScriptComment">// for the scroller.
</span>            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">_textFlow</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">generation</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptDefault_Text">lastContentBoundsGeneration</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>          
                <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">bounds</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">width</span> <span class="ActionScriptOperator">&lt;=</span> <span class="ActionScriptDefault_Text">_contentWidth</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">_textContainerManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">hostFormat</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">lineBreak</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptString">"toFit"</span><span class="ActionScriptBracket/Brace">)</span>
                    <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">bounds</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">height</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">_contentHeight</span><span class="ActionScriptBracket/Brace">)</span>
                            <span class="ActionScriptDefault_Text">bounds</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">height</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">_contentHeight</span>;
                    <span class="ActionScriptBracket/Brace">}</span>
                    <span class="ActionScriptReserved">else</span>
                    <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptComment">// The width may get smaller if the compose height is 
</span>                        <span class="ActionScriptComment">// reduced and fewer lines are composed.  Use the old 
</span>                        <span class="ActionScriptComment">// content width which is more accurate.
</span>                        <span class="ActionScriptDefault_Text">bounds</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">width</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">_contentWidth</span>;
                    <span class="ActionScriptBracket/Brace">}</span>
                <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptBracket/Brace">}</span>
            
            <span class="ActionScriptDefault_Text">lastContentBoundsGeneration</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">_textFlow</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">generation</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptASDoc">/**
         *  @private
         *  Called when the TextContainerManager dispatches a 'compositionComplete'
         *  event when it has recomposed the text into TextLines.
         */</span>
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">textContainerManager_compositionCompleteHandler</span><span class="ActionScriptBracket/Brace">(</span>
            <span class="ActionScriptDefault_Text">event</span>:<span class="ActionScriptDefault_Text">CompositionCompleteEvent</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptComment">//trace("compositionComplete");
</span>            
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">oldContentWidth</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">_contentWidth</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">oldContentHeight</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">_contentHeight</span>;
            
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">newContentBounds</span>:<span class="ActionScriptDefault_Text">Rectangle</span> <span class="ActionScriptOperator">=</span> 
                <span class="ActionScriptDefault_Text">_textContainerManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">getContentBounds</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptComment">// If x and/or y are not 0, adjust for what is visible.  For example, if there is an 
</span>            <span class="ActionScriptComment">// image which is wider than the composeWidth and float="right", x will be negative
</span>            <span class="ActionScriptComment">// and the part of the image between x and 0 will not be visible so it should
</span>            <span class="ActionScriptComment">// not be included in the reported width.  This will avoid a scrollbar that does
</span>            <span class="ActionScriptComment">// nothing.
</span>            <span class="ActionScriptDefault_Text">newContentBounds</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">width</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">newContentBounds</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span>;
            <span class="ActionScriptDefault_Text">newContentBounds</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">height</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">newContentBounds</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span>;
            
            <span class="ActionScriptComment">// Try to prevent the scroller from getting into a loop while
</span>            <span class="ActionScriptComment">// adding/removing scroll bars.
</span>            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">_textFlow</span> <span class="ActionScriptOperator">&amp;&amp;</span> <span class="ActionScriptDefault_Text">clipAndEnableScrolling</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptDefault_Text">adjustContentBoundsForScroller</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">newContentBounds</span><span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">newContentWidth</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">newContentBounds</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">width</span>;        
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">newContentHeight</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">newContentBounds</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">height</span>;
            
            <span class="ActionScriptComment">// TODO:(cframpto) handle blockProgression == RL
</span>            
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">newContentWidth</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptDefault_Text">oldContentWidth</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">_contentWidth</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">newContentWidth</span>;
                
                <span class="ActionScriptComment">//trace("composeWidth", _textContainerManager.compositionWidth, "contentWidth", oldContentWidth, newContentWidth);
</span>                
                <span class="ActionScriptComment">// If there is a scroller, this triggers the scroller layout.
</span>                <span class="ActionScriptDefault_Text">dispatchPropertyChangeEvent</span><span class="ActionScriptBracket/Brace">(</span>
                    <span class="ActionScriptString">"contentWidth"</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">oldContentWidth</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">newContentWidth</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">newContentHeight</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptDefault_Text">oldContentHeight</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">_contentHeight</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">newContentHeight</span>;
                
                <span class="ActionScriptComment">//trace("composeHeight", _textContainerManager.compositionHeight, "contentHeight", oldContentHeight, newContentHeight);
</span>                
                <span class="ActionScriptComment">// If there is a scroller, this triggers the scroller layout.
</span>                <span class="ActionScriptDefault_Text">dispatchPropertyChangeEvent</span><span class="ActionScriptBracket/Brace">(</span>
                    <span class="ActionScriptString">"contentHeight"</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">oldContentHeight</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">newContentHeight</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span> 
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptASDoc">/**
         *  @private
         *  Called when the TextContainerManager dispatches a 'damage' event.
         *  The TextFlow could have been modified interactively or programatically.
         */</span>
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">textContainerManager_damageHandler</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">event</span>:<span class="ActionScriptDefault_Text">DamageEvent</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">event</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">damageLength</span> <span class="ActionScriptOperator">==</span> 0<span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptReserved">return</span>;
            
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">inUpdateDLMethod</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptReserved">return</span>;
            
            <span class="ActionScriptComment">// Text that is being measured is damaged so update the display.
</span>            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">inMeasureMethod</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">invalidateDisplayList</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptReserved">return</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            
            <span class="ActionScriptComment">//trace("damageHandler", "generation", _textFlow ? _textFlow.generation : -1, "lastGeneration", lastGeneration);
</span>            
            <span class="ActionScriptComment">// The following textContainerManager functions can trigger a damage
</span>            <span class="ActionScriptComment">// event:
</span>            <span class="ActionScriptComment">//    setText/setTextFlow
</span>            <span class="ActionScriptComment">//    set hostFormat
</span>            <span class="ActionScriptComment">//    set compositionWidth/compositionHeight
</span>            <span class="ActionScriptComment">//    set horizontalScrollPosition/veriticalScrollPosition
</span>            <span class="ActionScriptComment">//    set swfContext
</span>            <span class="ActionScriptComment">//    updateContainer or compose: always if TextFlowFactory, sometimes 
</span>            <span class="ActionScriptComment">//        if flowComposer
</span>            <span class="ActionScriptComment">// or the textFlow can be modified directly.
</span>            
            <span class="ActionScriptComment">// If no changes, don't recompose/update.  The TextFlowFactory 
</span>            <span class="ActionScriptComment">// createTextLines dispatches damage events every time the textFlow
</span>            <span class="ActionScriptComment">// is composed, even if there are no changes. 
</span>            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">_textFlow</span> <span class="ActionScriptOperator">&amp;&amp;</span> <span class="ActionScriptDefault_Text">_textFlow</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">generation</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptDefault_Text">lastGeneration</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptReserved">return</span>;
            
            <span class="ActionScriptComment">// If there are pending changes, don't wipe them out.  We have
</span>            <span class="ActionScriptComment">// not gotten to commitProperties() yet.
</span>            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">textChanged</span> <span class="ActionScriptOperator">||</span> <span class="ActionScriptDefault_Text">textFlowChanged</span> <span class="ActionScriptOperator">||</span> <span class="ActionScriptDefault_Text">contentChanged</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptReserved">return</span>;
            
            <span class="ActionScriptComment">// In this case we always maintain _text with the underlying text and
</span>            <span class="ActionScriptComment">// display the appropriate number of passwordChars.  If there are any
</span>            <span class="ActionScriptComment">// interactive editing operations _text is updated during the operation.
</span>            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptOperator">!</span><span class="ActionScriptDefault_Text">displayAsPassword</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptDefault_Text">_text</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">null</span>;
            
            <span class="ActionScriptDefault_Text">_content</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">null</span>;        
            <span class="ActionScriptDefault_Text">_textFlow</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">_textContainerManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">getTextFlow</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
                        
            <span class="ActionScriptDefault_Text">lastGeneration</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">_textFlow</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">generation</span>;
            
            <span class="ActionScriptComment">// We don't need to call invalidateProperties()
</span>            <span class="ActionScriptComment">// because the hostFormat and the _textFlow are still valid.
</span>            
            <span class="ActionScriptComment">// If the textFlow content is modified directly or if there is a style 
</span>            <span class="ActionScriptComment">// change by changing the textFlow directly the size could change.
</span>            <span class="ActionScriptDefault_Text">invalidateSize</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptDefault_Text">invalidateDisplayList</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptASDoc">/**
         *  @private
         *  Called when the TextContainerManager dispatches a 'scroll' event
         *  as it autoscrolls.
         */</span>
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">textContainerManager_scrollHandler</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">event</span>:<span class="ActionScriptDefault_Text">Event</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">oldHorizontalScrollPosition</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">_horizontalScrollPosition</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">newHorizontalScrollPosition</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span>
                <span class="ActionScriptDefault_Text">_textContainerManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">horizontalScrollPosition</span>;
            
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">newHorizontalScrollPosition</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptDefault_Text">oldHorizontalScrollPosition</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptComment">//trace("hsp scroll", oldHorizontalScrollPosition, "-&gt;", newHorizontalScrollPosition);
</span>                
                <span class="ActionScriptDefault_Text">_horizontalScrollPosition</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">newHorizontalScrollPosition</span>;
                
                <span class="ActionScriptDefault_Text">dispatchPropertyChangeEvent</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"horizontalScrollPosition"</span><span class="ActionScriptOperator">,</span>
                    <span class="ActionScriptDefault_Text">oldHorizontalScrollPosition</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">newHorizontalScrollPosition</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">oldVerticalScrollPosition</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">_verticalScrollPosition</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">newVerticalScrollPosition</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span>
                <span class="ActionScriptDefault_Text">_textContainerManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">verticalScrollPosition</span>;
            
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">newVerticalScrollPosition</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptDefault_Text">oldVerticalScrollPosition</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptComment">//trace("vsp scroll", oldVerticalScrollPosition, "-&gt;", newVerticalScrollPosition);
</span>                
                <span class="ActionScriptDefault_Text">_verticalScrollPosition</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">newVerticalScrollPosition</span>;
                
                <span class="ActionScriptDefault_Text">dispatchPropertyChangeEvent</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"verticalScrollPosition"</span><span class="ActionScriptOperator">,</span>
                    <span class="ActionScriptDefault_Text">oldVerticalScrollPosition</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">newVerticalScrollPosition</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptASDoc">/**
         *  @private
         *  Called when the TextContainerManager dispatches a 'selectionChange' event.
         */</span>
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">textContainerManager_selectionChangeHandler</span><span class="ActionScriptBracket/Brace">(</span>
            <span class="ActionScriptDefault_Text">event</span>:<span class="ActionScriptDefault_Text">SelectionEvent</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">oldAnchor</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">_selectionAnchorPosition</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">oldActive</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">_selectionActivePosition</span>;
            
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">selectionState</span>:<span class="ActionScriptDefault_Text">SelectionState</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">event</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">selectionState</span>;
            
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">selectionState</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">_selectionAnchorPosition</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">selectionState</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">anchorPosition</span>;
                <span class="ActionScriptDefault_Text">_selectionActivePosition</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">selectionState</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">activePosition</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptReserved">else</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">_selectionAnchorPosition</span> <span class="ActionScriptOperator">=</span> -1;
                <span class="ActionScriptDefault_Text">_selectionActivePosition</span> <span class="ActionScriptOperator">=</span> -1;
            <span class="ActionScriptBracket/Brace">}</span>
            
            <span class="ActionScriptComment">// Selection changed so reset.
</span>            <span class="ActionScriptDefault_Text">hasProgrammaticSelectionRange</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">false</span>;
            
            <span class="ActionScriptComment">// Only dispatch the event if the selection has really changed.
</span>            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">changed</span>:<span class="ActionScriptDefault_Text">Boolean</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">oldAnchor</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptDefault_Text">_selectionAnchorPosition</span> <span class="ActionScriptOperator">||</span>
                <span class="ActionScriptDefault_Text">oldActive</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptDefault_Text">_selectionActivePosition</span>;
            
            
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">changed</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>    
                <span class="ActionScriptComment">//trace("selectionChangeHandler", _selectionAnchorPosition, _selectionActivePosition);
</span>                <span class="ActionScriptDefault_Text">dispatchEvent</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">FlexEvent</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">FlexEvent</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">SELECTION_CHANGE</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptASDoc">/**
         *  @private
         *  Called when the TextContainerManager dispatches an 'operationBegin'
         *  event before an editing operation.
         */</span>     
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">textContainerManager_flowOperationBeginHandler</span><span class="ActionScriptBracket/Brace">(</span>
            <span class="ActionScriptDefault_Text">event</span>:<span class="ActionScriptDefault_Text">FlowOperationEvent</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptComment">//trace("flowOperationBegin", "level", event.level);
</span>            
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">op</span>:<span class="ActionScriptDefault_Text">FlowOperation</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">event</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">operation</span>;
            
            <span class="ActionScriptComment">// The text flow's generation will be incremented if the text flow
</span>            <span class="ActionScriptComment">// is modified in any way by this operation.
</span>            
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">op</span> <span class="ActionScriptReserved">is</span> <span class="ActionScriptDefault_Text">InsertTextOperation</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">insertTextOperation</span>:<span class="ActionScriptDefault_Text">InsertTextOperation</span> <span class="ActionScriptOperator">=</span>
                    <span class="ActionScriptDefault_Text">InsertTextOperation</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">op</span><span class="ActionScriptBracket/Brace">)</span>;
                
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">textToInsert</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">insertTextOperation</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">text</span>;
                
                <span class="ActionScriptComment">// Note: Must process restrict first, then maxChars,
</span>                <span class="ActionScriptComment">// then displayAsPassword last.
</span>                
                <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">_restrict</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptReserved">null</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptDefault_Text">textToInsert</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">StringUtil</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">restrict</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">textToInsert</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">restrict</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">textToInsert</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">length</span> <span class="ActionScriptOperator">==</span> 0<span class="ActionScriptBracket/Brace">)</span>
                    <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptDefault_Text">event</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">preventDefault</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
                        <span class="ActionScriptReserved">return</span>;
                    <span class="ActionScriptBracket/Brace">}</span>
                <span class="ActionScriptBracket/Brace">}</span>
                
                <span class="ActionScriptComment">// The text deleted by this operation.  If we're doing our
</span>                <span class="ActionScriptComment">// own manipulation of the textFlow we have to take the deleted
</span>                <span class="ActionScriptComment">// text into account as well as the inserted text.
</span>                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">delSelOp</span>:<span class="ActionScriptDefault_Text">SelectionState</span> <span class="ActionScriptOperator">=</span> 
                    <span class="ActionScriptDefault_Text">insertTextOperation</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">deleteSelectionState</span>;
                
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">delLen</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">delSelOp</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptReserved">null</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">?</span> 0 :
                    <span class="ActionScriptDefault_Text">delSelOp</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">absoluteEnd</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">delSelOp</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">absoluteStart</span>;
                
                <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">maxChars</span> <span class="ActionScriptOperator">!=</span> 0<span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">length1</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">text</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">length</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">delLen</span>;
                    <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">length2</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">textToInsert</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">length</span>;
                    <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">length1</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">length2</span> <span class="ActionScriptOperator">&gt;</span> <span class="ActionScriptDefault_Text">maxChars</span><span class="ActionScriptBracket/Brace">)</span>
                        <span class="ActionScriptDefault_Text">textToInsert</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">textToInsert</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">substr</span><span class="ActionScriptBracket/Brace">(</span>0<span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">maxChars</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">length1</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptBracket/Brace">}</span>
                
                <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">_displayAsPassword</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptComment">// Remove deleted text.
</span>                    <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">delLen</span> <span class="ActionScriptOperator">&gt;</span> 0<span class="ActionScriptBracket/Brace">)</span>
                    <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptDefault_Text">_text</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">splice</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">_text</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">delSelOp</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">absoluteStart</span><span class="ActionScriptOperator">,</span> 
                                       <span class="ActionScriptDefault_Text">delSelOp</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">absoluteEnd</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptString">""</span><span class="ActionScriptBracket/Brace">)</span>;                                    
                    <span class="ActionScriptBracket/Brace">}</span>
                    
                    <span class="ActionScriptComment">// Add in the inserted text.
</span>                    <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">textToInsert</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">length</span> <span class="ActionScriptOperator">&gt;</span> 0<span class="ActionScriptBracket/Brace">)</span>
                    <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptDefault_Text">_text</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">splice</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">_text</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">insertTextOperation</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">absoluteStart</span><span class="ActionScriptOperator">,</span>
                            <span class="ActionScriptDefault_Text">insertTextOperation</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">absoluteStart</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">textToInsert</span><span class="ActionScriptBracket/Brace">)</span>;
                        
                        <span class="ActionScriptComment">// Display the passwordChar rather than the actual text.
</span>                        <span class="ActionScriptDefault_Text">textToInsert</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">StringUtil</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">repeat</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">passwordChar</span><span class="ActionScriptOperator">,</span>
                            <span class="ActionScriptDefault_Text">textToInsert</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">length</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptBracket/Brace">}</span>
                <span class="ActionScriptBracket/Brace">}</span>
                
                <span class="ActionScriptDefault_Text">insertTextOperation</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">text</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">textToInsert</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptReserved">else</span> <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">op</span> <span class="ActionScriptReserved">is</span> <span class="ActionScriptDefault_Text">CopyOperation</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">_displayAsPassword</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptComment">// For security, don't allow passwords to be copied.
</span>                    <span class="ActionScriptDefault_Text">event</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">preventDefault</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptReserved">return</span>;
                <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptReserved">else</span> <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">op</span> <span class="ActionScriptReserved">is</span> <span class="ActionScriptDefault_Text">PasteOperation</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptComment">// Paste is implemented in operationEnd.  The basic idea is to allow 
</span>                <span class="ActionScriptComment">// the paste to go through unchanged, but group it together with a 
</span>                <span class="ActionScriptComment">// second operation that modifies text as part of the same 
</span>                <span class="ActionScriptComment">// transaction. This is vastly simpler for TLF to manage. 
</span>            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptReserved">else</span> <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">op</span> <span class="ActionScriptReserved">is</span> <span class="ActionScriptDefault_Text">DeleteTextOperation</span> <span class="ActionScriptOperator">||</span> <span class="ActionScriptDefault_Text">op</span> <span class="ActionScriptReserved">is</span> <span class="ActionScriptDefault_Text">CutOperation</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">flowTextOperation</span>:<span class="ActionScriptDefault_Text">FlowTextOperation</span> <span class="ActionScriptOperator">=</span>
                    <span class="ActionScriptDefault_Text">FlowTextOperation</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">op</span><span class="ActionScriptBracket/Brace">)</span>;
                
                <span class="ActionScriptComment">// Eat 0-length deletion.  This can happen when insertion point is 
</span>                <span class="ActionScriptComment">// at start of container when a backspace is entered
</span>                <span class="ActionScriptComment">// or when the insertion point is at the end of the
</span>                <span class="ActionScriptComment">// container and a delete key is entered.
</span>                <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">flowTextOperation</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">absoluteStart</span> <span class="ActionScriptOperator">==</span> 
                    <span class="ActionScriptDefault_Text">flowTextOperation</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">absoluteEnd</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptDefault_Text">event</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">preventDefault</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptReserved">return</span>;
                <span class="ActionScriptBracket/Brace">}</span>           
                
                <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">_displayAsPassword</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">op</span> <span class="ActionScriptReserved">is</span> <span class="ActionScriptDefault_Text">DeleteTextOperation</span><span class="ActionScriptBracket/Brace">)</span>
                    <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptDefault_Text">_text</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">splice</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">_text</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">flowTextOperation</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">absoluteStart</span><span class="ActionScriptOperator">,</span>
                            <span class="ActionScriptDefault_Text">flowTextOperation</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">absoluteEnd</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptString">""</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptBracket/Brace">}</span>
                    <span class="ActionScriptReserved">else</span>
                    <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptComment">// For security, don't allow passwords to be cut.
</span>                        <span class="ActionScriptDefault_Text">event</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">preventDefault</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
                        <span class="ActionScriptReserved">return</span>;
                    <span class="ActionScriptBracket/Brace">}</span>
                <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptBracket/Brace">}</span>
            
            <span class="ActionScriptComment">// Dispatch a 'changing' event from the RichEditableText
</span>            <span class="ActionScriptComment">// as notification that an editing operation is about to occur.
</span>            <span class="ActionScriptComment">// The level will be 0 for single operations, and at the start
</span>            <span class="ActionScriptComment">// of a composite operation.
</span>            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">dispatchChangeAndChangingEvents</span> <span class="ActionScriptOperator">&amp;&amp;</span> <span class="ActionScriptDefault_Text">event</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">level</span> <span class="ActionScriptOperator">==</span> 0<span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">newEvent</span>:<span class="ActionScriptDefault_Text">TextOperationEvent</span> <span class="ActionScriptOperator">=</span>
                    <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">TextOperationEvent</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">TextOperationEvent</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">CHANGING</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">newEvent</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">operation</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">op</span>;
                <span class="ActionScriptDefault_Text">dispatchEvent</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">newEvent</span><span class="ActionScriptBracket/Brace">)</span>;
                
                <span class="ActionScriptComment">// If the event dispatched from this RichEditableText is canceled,
</span>                <span class="ActionScriptComment">// cancel the one from the EditManager, which will prevent
</span>                <span class="ActionScriptComment">// the editing operation from being processed.
</span>                <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">newEvent</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">isDefaultPrevented</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>
                    <span class="ActionScriptDefault_Text">event</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">preventDefault</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptASDoc">/**
         *  @private
         *  Called when the TextContainerManager dispatches an 'operationEnd' event
         *  after an editing operation.
         */</span>
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">textContainerManager_flowOperationEndHandler</span><span class="ActionScriptBracket/Brace">(</span>
            <span class="ActionScriptDefault_Text">event</span>:<span class="ActionScriptDefault_Text">FlowOperationEvent</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptComment">//trace("flowOperationEnd", "level", event.level);
</span>            
            <span class="ActionScriptComment">// Paste is a special case.  Any mods have to be made to the text
</span>            <span class="ActionScriptComment">// which includes what was pasted.
</span>            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">event</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">operation</span> <span class="ActionScriptReserved">is</span> <span class="ActionScriptDefault_Text">PasteOperation</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptDefault_Text">handlePasteOperation</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">PasteOperation</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">event</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">operation</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptASDoc">/**
         *  @private
         *  Called when the TextContainerManager dispatches an 'operationComplete' 
         *  event after an editing operation.
         */</span>
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">textContainerManager_flowOperationCompleteHandler</span><span class="ActionScriptBracket/Brace">(</span>
            <span class="ActionScriptDefault_Text">event</span>:<span class="ActionScriptDefault_Text">FlowOperationEvent</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptComment">//trace("flowOperationComplete", "level", event.level);
</span>            
            <span class="ActionScriptComment">// Dispatch a 'change' event from the RichEditableText
</span>            <span class="ActionScriptComment">// as notification that an editing operation has occurred.
</span>            <span class="ActionScriptComment">// The flow is now in a state that it can be manipulated.
</span>            <span class="ActionScriptComment">// The level will be 0 for single operations, and at the end
</span>            <span class="ActionScriptComment">// of a composite operation.
</span>            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">dispatchChangeAndChangingEvents</span> <span class="ActionScriptOperator">&amp;&amp;</span> <span class="ActionScriptDefault_Text">event</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">level</span> <span class="ActionScriptOperator">==</span> 0<span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">newEvent</span>:<span class="ActionScriptDefault_Text">TextOperationEvent</span> <span class="ActionScriptOperator">=</span>
                    <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">TextOperationEvent</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">TextOperationEvent</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">CHANGE</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">newEvent</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">operation</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">event</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">operation</span>;
                <span class="ActionScriptDefault_Text">dispatchEvent</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">newEvent</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptASDoc">/**
         *  @private
         *  Called when an InlineGraphicElement is asynchronously loaded.
         *  The event status could be "sizePending", "loaded" or "error". 
         *  Must call updateAllContainers() to cause transition to the next
         *  graphic status.
         */</span>
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">textContainerManager_inlineGraphicStatusChangeHandler</span> <span class="ActionScriptBracket/Brace">(</span>
            <span class="ActionScriptDefault_Text">event</span>:<span class="ActionScriptDefault_Text">StatusChangeEvent</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>            
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">event</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">status</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptDefault_Text">InlineGraphicElementStatus</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">READY</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptComment">// Now that the actual size of the graphic is available need to
</span>                <span class="ActionScriptComment">// optionally remeasure and updateContainer.
</span>                <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">autoSize</span><span class="ActionScriptBracket/Brace">)</span>
                    <span class="ActionScriptDefault_Text">invalidateSize</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;                
            <span class="ActionScriptBracket/Brace">}</span>

            <span class="ActionScriptComment">// Call updateAllContainers().
</span>            <span class="ActionScriptDefault_Text">invalidateDisplayList</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>    
        
        <span class="ActionScriptASDoc">/**
         *  @private
         *  release the textline as it is temporary.
         */</span>
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">tossTextLine</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">textLine</span>:<span class="ActionScriptDefault_Text">DisplayObject</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">TextUtil</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">recycleTextLine</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">textLine</span> <span class="ActionScriptReserved">as</span> <span class="ActionScriptDefault_Text">TextLine</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>
    <span class="ActionScriptBracket/Brace">}</span>

<span class="ActionScriptBracket/Brace">}</span>
</pre></body>
</html>
